<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#fff">





  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-center-circle.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.2.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.2.0" color="#fff">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="有梦为马, 游历天涯!">
<meta property="og:type" content="website">
<meta property="og:title" content="Angusの博客">
<meta property="og:url" content="https://qijianguo.com/index.html">
<meta property="og:site_name" content="Angusの博客">
<meta property="og:description" content="有梦为马, 游历天涯!">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Angusの博客">
<meta name="twitter:description" content="有梦为马, 游历天涯!">



  <link rel="alternate" href="/atom.xml" title="Angusの博客" type="application/atom+xml" />




  <link rel="canonical" href="https://qijianguo.com/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Angusの博客</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>


  <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>


<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
	

    
	<a href="https://github.com/qijianguo"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>



    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Angusの博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>




<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Startseite</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archiv<span class="badge">50</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />Kategorien<span class="badge">17</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />Tags<span class="badge">22</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-top">
    <a href="/top/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-signal"></i> <br />top</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-futbol-o"></i> <br />Über</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Android/2019/04/17/EditText监听事件.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Android/2019/04/17/EditText监听事件.html" itemprop="url">
                  EditText监听事件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:44:55" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  /**</span><br><span class="line">    * Adds a TextWatcher to the list of those whose methods are called</span><br><span class="line">    * whenever this TextView&apos;s text changes.</span><br><span class="line">    * &lt;p&gt;</span><br><span class="line">    * In 1.0, the &#123;@link TextWatcher#afterTextChanged&#125; method was erroneously</span><br><span class="line">    * not called after &#123;@link #setText&#125; calls.  Now, doing &#123;@link #setText&#125;</span><br><span class="line">    * if there are any text changed listeners forces the buffer type to</span><br><span class="line">    * Editable if it would not otherwise be and does call this method.</span><br><span class="line">    */</span><br><span class="line">public void addTextChangedListener(TextWatcher watcher) &#123;</span><br><span class="line">     if (mListeners == null) &#123;</span><br><span class="line">          mListeners = new ArrayList&lt;TextWatcher&gt;();</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     mListeners.add(watcher);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例: </p>
</li>
</ul>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> EditText editText;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">void</span> <span class="title">initView</span><span class="params">()</span></span>&#123;</span><br><span class="line">	editText = (editText)findViewById(R.id.edit_text);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">void</span> <span class="title">initEvents</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	editText.addTextChangedListener(<span class="keyword">new</span> TextWatcher() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">beforeTextChanged</span><span class="params">(CharSequence s, <span class="keyword">int</span> start, <span class="keyword">int</span> count, <span class="keyword">int</span> after)</span> </span>&#123;</span><br><span class="line">                Log.i(TAG, <span class="string">"beforeTextChanged: 输入过程中执行该方法"</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onTextChanged</span><span class="params">(CharSequence s, <span class="keyword">int</span> start, <span class="keyword">int</span> before, <span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">                Log.i(TAG, <span class="string">"onTextChanged: 输入前确认执行该方法"</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">afterTextChanged</span><span class="params">(Editable s)</span> </span>&#123;</span><br><span class="line">		Log.i(TAG, <span class="string">"afterTextChanged: 输入结束执行该方法"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Linux/2019/04/17/Linux中部署Maven项目, 自定义setting.xml文件.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/2019/04/17/Linux中部署Maven项目, 自定义setting.xml文件.html" itemprop="url">
                  Linux中部署Maven项目, 自定义setting.xml文件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:46:09" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>查看Linux中maven地址<blockquote>
<p>[root@iZbp1cj4z3w66bw25x346qZ Portal]# mvn -v<br>Apache Maven 3.3.1 (cab6659f9874fa96462afef40fcf6bc033d58c1c; 2015-03-14T04:10:27+08:00)<br>Maven home: <strong><em>/usr/local/maven</em></strong><br>Java version: 1.8.0_131, vendor: Oracle Corporation<br>Java home: /usr/java/jdk1.8.0_131/jre<br>Default locale: en_US, platform encoding: UTF-8<br>OS name: “linux”, version: “2.6.32-642.13.1.el6.x86_64”, arch: “amd64”, family: “unix”</p>
<p>[root@iZbp1cj4z3w66bw25x346qZ Portal]# cd  /usr/local/maven<br>drwxr-xr-x 2 root root  4096 Apr 26  2017 logging<br>-rw-r–r– 1 root root 16404 Jul 26 16:52 settings_custom.xml<br>-rw-r–r– 1 root root 16177 Apr 26  2017 settings.xml</p>
</blockquote>
</li>
</ul>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/maven/conf/settings.<span class="keyword">xml</span>      <span class="title">-- 默认的setting</span>文件</span><br><span class="line"></span><br><span class="line">/usr/local/maven/conf/settings_custom.<span class="keyword">xml</span>    <span class="title">-- 自定义的setting</span>文件</span><br></pre></td></tr></table></figure>
<ul>
<li>启动项目, 在脚本中指定自己的setting.xml文件<blockquote>
<p>settings /usr/local/maven/conf/settings_custom.xml</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mvn clean compile <span class="string">exec:</span>java --settings <span class="regexp">/usr/</span>local<span class="regexp">/maven/</span>conf/</span><br><span class="line">settings_custom.xml -Plocal-config &gt; <span class="regexp">/dev/</span><span class="literal">null</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span> &amp;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Java/2019/04/17/SpringBoot定时任务Schedule使用.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Java/2019/04/17/SpringBoot定时任务Schedule使用.html" itemprop="url">
                  SpringBoot定时任务Schedule使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:47:01" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在开发中很多时候会用到定时任务, 以前用自定义类继承<strong><em>TimerTask</em></strong></p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomTask</span> <span class="keyword"><span class="keyword">extends</span> <span class="type">TimerTask</span></span></span>&#123;</span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> void run() &#123;</span><br><span class="line">		<span class="comment">// 执行业务代码</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> void main(<span class="keyword">String</span>[] args) &#123;</span><br><span class="line">		<span class="comment">// 调用</span></span><br><span class="line">		Timer timer= <span class="keyword">new</span> <span class="type">Timer</span>();</span><br><span class="line">		Calendar calendar= Calendar.getInstance(); <span class="comment">// 设置定时时间, 当然还有其他方式</span></span><br><span class="line">		calendar.<span class="keyword">set</span>(Calendar.MINUTE, <span class="number">0</span>);</span><br><span class="line">		calendar.<span class="keyword">set</span>(Calendar.SECOND, <span class="number">0</span>);</span><br><span class="line">		calendar.<span class="keyword">set</span>(Calendar.MILLISECOND, <span class="number">0</span>);</span><br><span class="line">		calendar.scheduleAtFixedRate(<span class="keyword">new</span> <span class="type">CustomTask</span>(),</span><br><span class="line">		timer.getTime(), <span class="number">1000</span> * <span class="number">60</span> * <span class="number">10</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://blog.csdn.net/xieyuooo/article/details/8607220" target="_blank" rel="noopener">Timer和TimerTask详解:https://blog.csdn.net/xieyuooo/article/details/8607220</a></p>
<p>下面进入正题, SpringBoot中优雅使用定时任务</p>
<ul>
<li><p>添加支持<br>在SpringBoot的启动类①中添加注解 <strong><em>@EnableScheduling</em></strong></p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@SpringBootApplication</span></span><br><span class="line"><span class="variable">@EnableScheduling</span>  <span class="comment">// ①</span></span><br><span class="line">public class Application &#123;</span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">static</span> <span class="selector-tag">void</span> <span class="selector-tag">main</span>(String[] args) &#123;</span><br><span class="line">        <span class="selector-tag">SpringApplication</span><span class="selector-class">.run</span>(Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用定时任务</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查小时均值报警</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> @Scheduled(cron = <span class="string">"0 1 * * * *"</span>)</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">overproofAlert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	 <span class="built_in">log</span>.info(<span class="string">"-----开始执行定时任务-----"</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>通过上面这一个注解   <strong><em>@Scheduled(cron = “0 1 </em> <em> </em> <em>“)</em></strong> 这样就可以开启定时任务了, 惊不惊喜！</p>
<p>Cron表达式说明 <a href="https://www.cnblogs.com/liuyitian/p/4108391.html" target="_blank" rel="noopener">详细说明</a></p>
<blockquote>
<p>Cron是字符串表达式, 并由’域’和空格组成。</p>
</blockquote>
<p>模版: <em>Seconds</em> <em>Minutes</em> <em>Hours</em> <em>DayOfMonth</em> <em>Month</em> <em>DayOfWeek</em> <em>Year</em></p>
<blockquote>
<p>Year可选<br>各<br>Sencods</p>
</blockquote>
<hr>
<p>这样创建的定时任务是同步的，即顺序执行。 这会遇到一个问题，当某个任务中断后会阻塞掉后面的任务， 导致其他任务‘失效’。所以配置异步是非常有必要的, 步骤如下:</p>
<ul>
<li><p>添加Config</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAsync</span> <span class="comment">// ① 添加注解</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Executor <span class="title">taskExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ThreadPoolTaskExecutor executor = <span class="keyword">new</span> ThreadPoolTaskExecutor();</span><br><span class="line">        executor.setCorePoolSize(<span class="number">10</span>);  </span><br><span class="line">        executor.setMaxPoolSize(<span class="number">200</span>);</span><br><span class="line">        executor.setQueueCapacity(<span class="number">10</span>);</span><br><span class="line">        executor.initialize();</span><br><span class="line">        <span class="keyword">return</span> executor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在定时方法上添加 <strong><em>@Async</em></strong> 注解</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@Scheduled</span>(cron = <span class="string">"0 0/1 * * * *"</span>)</span><br><span class="line"><span class="variable">@Async</span>   <span class="comment">// ② </span></span><br><span class="line">public void oneMinuteTask() &#123;</span><br><span class="line">	<span class="selector-tag">log</span><span class="selector-class">.info</span>(<span class="string">"-----开始执行定时任务-----"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="大功告成"><a href="#大功告成" class="headerlink" title="大功告成 !"></a>大功告成 !</h4>
          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Android/2019/04/17/Cordova生成安卓源码无法运行.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Android/2019/04/17/Cordova生成安卓源码无法运行.html" itemprop="url">
                  Cordova生成安卓源码无法运行
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:44:51" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>说明: cordova编译生成的android源码在Android Studio中运行, 无法找到<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Gradle <span class="string">'android'</span> project refresh failed</span><br><span class="line"><span class="symbol">Error:</span>No <span class="keyword">installed </span><span class="keyword">build </span>tools found. <span class="keyword">Install </span>the <span class="keyword">Android </span><span class="keyword">build </span>tools version <span class="number">19</span>.<span class="number">1</span>.<span class="number">0</span> <span class="keyword">or </span>higher.</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>解决方式一:</p>
<ol>
<li>全局搜索  availableBuildToolsVersions = getAvailableBuildTools()<br><img src="https://img-blog.csdn.net/20180921102547408?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="修改前的照片"><br>修改为<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">availableBuildToolsVersions  = ['<span class="number">21.0</span><span class="number">.0</span>','<span class="number">20.0</span><span class="number">.0</span>','<span class="number">19.1</span><span class="number">.0</span>','<span class="number">19.0</span><span class="number">.3</span>'] as String[]</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="https://img-blog.csdn.net/20180921102905659?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="修改后的源码截图"><br>分析:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">String doFindLatestInstalledBuildTools(String minBuildToolsVersion) &#123;</span><br><span class="line">    <span class="keyword">def</span> availableBuildToolsVersions</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">    	<span class="comment">// <span class="doctag">TODO:</span> 获得可用的 build-tools</span></span><br><span class="line">        availableBuildToolsVersions  = getAvailableBuildTools()</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">println</span> <span class="string">"An exception occurred while trying to find the Android build tools."</span></span><br><span class="line">        <span class="keyword">throw</span> e</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (availableBuildToolsVersions.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">def</span> highestBuildToolsVersion = availableBuildToolsVersions[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> (compareVersions(highestBuildToolsVersion, minBuildToolsVersion) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(</span><br><span class="line">                <span class="string">"No usable Android build tools found. Highest installed version is "</span> +</span><br><span class="line">                highestBuildToolsVersion + <span class="string">"; minimum version required is "</span> +</span><br><span class="line">                minBuildToolsVersion + <span class="string">"."</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        highestBuildToolsVersion</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    	<span class="comment">// TODO 上面报错正是这抛出的异常, 为什么会走这呢, 因为没找到build-tools的版本</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(</span><br><span class="line">            <span class="string">"No installed build tools found. Install the Android build tools version "</span> +</span><br><span class="line">            minBuildToolsVersion + <span class="string">" or higher."</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取可用的build-tool</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">String[] getAvailableBuildTools() &#123;</span><br><span class="line">    <span class="keyword">def</span> buildToolsDir = <span class="keyword">new</span> <span class="keyword">File</span>(getAndroidSdkDir(), <span class="string">"build-tools"</span>)</span><br><span class="line">    buildToolsDir.list()</span><br><span class="line">        .<span class="keyword">findAll</span> &#123; it ==~ <span class="regexp">/[0-9.]+/</span> &#125; </span><br><span class="line">        .<span class="keyword">sort</span> &#123; a, b -&gt; compareVersions(b, a) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取SDK位置</span></span><br><span class="line"><span class="comment"> * @return</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">String getAndroidSdkDir() &#123;</span><br><span class="line">    <span class="keyword">def</span> rootDir = <span class="keyword">project</span>.rootDir</span><br><span class="line">    <span class="keyword">def</span> androidSdkDir = <span class="keyword">null</span></span><br><span class="line">    String envVar = System.getenv(<span class="string">"ANDROID_HOME"</span>)</span><br><span class="line">    <span class="keyword">def</span> localProperties = <span class="keyword">new</span> <span class="keyword">File</span>(rootDir, <span class="string">'local.properties'</span>)</span><br><span class="line">    String systemProperty = System.getProperty(<span class="string">"android.home"</span>)</span><br><span class="line">    <span class="keyword">if</span> (envVar != <span class="keyword">null</span>) &#123;</span><br><span class="line">        androidSdkDir = envVar</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (localProperties.exists()) &#123;</span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties()</span><br><span class="line">        localProperties.withInputStream &#123; instr -&gt;</span><br><span class="line">            properties.load(instr)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">def</span> sdkDirProp = properties.getProperty(<span class="string">'sdk.dir'</span>)</span><br><span class="line">        <span class="keyword">if</span> (sdkDirProp != <span class="keyword">null</span>) &#123;</span><br><span class="line">            androidSdkDir = sdkDirProp</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            sdkDirProp = properties.getProperty(<span class="string">'android.dir'</span>)</span><br><span class="line">            <span class="keyword">if</span> (sdkDirProp != <span class="keyword">null</span>) &#123;</span><br><span class="line">                androidSdkDir = (<span class="keyword">new</span> <span class="keyword">File</span>(rootDir, sdkDirProp)).getAbsolutePath()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (androidSdkDir == <span class="keyword">null</span> &amp;&amp; systemProperty != <span class="keyword">null</span>) &#123;</span><br><span class="line">        androidSdkDir = systemProperty</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (androidSdkDir == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(</span><br><span class="line">            <span class="string">"Unable to determine Android SDK directory."</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    androidSdkDir</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Java/2019/04/17/数字格式化工具类     持续更新.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Java/2019/04/17/数字格式化工具类     持续更新.html" itemprop="url">
                  数字格式化工具类     持续更新
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:33:53" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数字格式化工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NumberUtils</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 格式化为指定位小数的数字,返回未使用科学计数法表示的具有指定位数的字符串。</span></span><br><span class="line"><span class="comment">	 * 该方法舍入模式：向“最接近的”数字舍入，如果与两个相邻数字的距离相等，则为向上舍入的舍入模式。</span></span><br><span class="line"><span class="comment">	 * &lt;pre&gt;</span></span><br><span class="line"><span class="comment">	 * 	"3.1415926", 1			--&gt; 3.1</span></span><br><span class="line"><span class="comment">	 * 	"3.1415926", 3			--&gt; 3.142</span></span><br><span class="line"><span class="comment">	 * 	"3.1415926", 4			--&gt; 3.1416</span></span><br><span class="line"><span class="comment">	 * 	"3.1415926", 6			--&gt; 3.141593</span></span><br><span class="line"><span class="comment">	 * 	"1234567891234567.1415926", 3	--&gt; 1234567891234567.142</span></span><br><span class="line"><span class="comment">	 * &lt;/pre&gt;</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> //String类型的数字对象</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> precision  小数精确度总位数,如2表示两位小数</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> 返回数字格式化后的字符串表示形式(注意返回的字符串未使用科学计数法)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String keepPrecision(String number, <span class="keyword">int</span> precision) &#123;</span><br><span class="line">		BigDecimal bg = <span class="keyword">new</span> BigDecimal(number);</span><br><span class="line">		<span class="keyword">return</span> bg.setScale(precision, BigDecimal.ROUND_HALF_UP).toPlainString();</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 格式化为指定位小数的数字,返回未使用科学计数法表示的具有指定位数的字符串。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * 该方法舍入模式：向“最接近的”数字舍入，如果与两个相邻数字的距离相等，则为向上舍入的舍入模式。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * 如果给定的数字没有小数，则转换之后将以0填充；例如：int 123  1 --&gt; 123.0&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * &lt;b&gt;注意：&lt;/b&gt;如果精度要求比较精确请使用 keepPrecision(String number, int precision)方法</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> //String类型的数字对象</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> precision  小数精确度总位数,如2表示两位小数</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> 返回数字格式化后的字符串表示形式(注意返回的字符串未使用科学计数法)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String keepPrecision(Number number, <span class="keyword">int</span> precision) &#123;</span><br><span class="line">		<span class="keyword">return</span> keepPrecision(String.valueOf(number), precision);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 对double类型的数值保留指定位数的小数。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * 该方法舍入模式：向“最接近的”数字舍入，如果与两个相邻数字的距离相等，则为向上舍入的舍入模式。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * &lt;b&gt;注意：&lt;/b&gt;如果精度要求比较精确请使用 keepPrecision(String number, int precision)方法</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> number  要保留小数的数字</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> precision 小数位数</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> double 如果数值较大，则使用科学计数法表示</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> keepPrecision(<span class="keyword">double</span> number, <span class="keyword">int</span> precision) &#123;</span><br><span class="line">		BigDecimal bg = <span class="keyword">new</span> BigDecimal(number);</span><br><span class="line">		<span class="keyword">return</span> bg.setScale(precision, BigDecimal.ROUND_HALF_UP).doubleValue();</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 对float类型的数值保留指定位数的小数。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * 该方法舍入模式：向“最接近的”数字舍入，如果与两个相邻数字的距离相等，则为向上舍入的舍入模式。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * &lt;b&gt;注意：&lt;/b&gt;如果精度要求比较精确请使用 keepPrecision(String number, int precision)方法</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> number  要保留小数的数字</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> precision 小数位数</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> float 如果数值较大，则使用科学计数法表示</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">float</span> keepPrecision(<span class="keyword">float</span> number, <span class="keyword">int</span> precision) &#123;</span><br><span class="line">		BigDecimal bg = <span class="keyword">new</span> BigDecimal(number);</span><br><span class="line">		<span class="keyword">return</span> bg.setScale(precision, BigDecimal.ROUND_HALF_UP).floatValue();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获取 ±number 的随机数。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> number  要保留小数的数字</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> float 如果数值较大，则使用科学计数法表示</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">float</span> getRandomNum(<span class="keyword">int</span> number) &#123;</span><br><span class="line">		Random random = <span class="keyword">new</span> Random();</span><br><span class="line">		<span class="comment">//return num /2 + random.nextFloat() * num * -1;</span></span><br><span class="line">		<span class="keyword">int</span> randomNum = (random.nextInt(number)) * (random.nextInt(<span class="number">2</span>) == <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">1</span>);</span><br><span class="line">		String rd = randomNum + <span class="string">"."</span> + random.nextInt(<span class="number">10</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">Float</span>.parseFloat(rd);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 去掉小数点后多余的0。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * 例如: 1.0 则返回 1。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> number  要处理的数字</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> double </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> rvZeroAndDot(<span class="keyword">double</span> number)&#123;</span><br><span class="line">		String s = String.valueOf(number);</span><br><span class="line">		<span class="keyword">if</span> (s.isEmpty()) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(s.indexOf(<span class="string">"."</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">			s = s.replaceAll(<span class="string">"0+?$"</span>, <span class="string">""</span>);<span class="comment">//去掉多余的0</span></span><br><span class="line">			s = s.replaceAll(<span class="string">"[.]$"</span>, <span class="string">""</span>);<span class="comment">//如最后一位是.则去掉</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">Double</span>.parseDouble(s);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 数字格式化工具类</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NumberUtils</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 格式化为指定位小数的数字,返回未使用科学计数法表示的具有指定位数的字符串。</span></span><br><span class="line"><span class="comment">	 * 该方法舍入模式：向“最接近的”数字舍入，如果与两个相邻数字的距离相等，则为向上舍入的舍入模式。</span></span><br><span class="line"><span class="comment">	 * &lt;pre&gt;</span></span><br><span class="line"><span class="comment">	 * 	"3.1415926", 1			--&gt; 3.1</span></span><br><span class="line"><span class="comment">	 * 	"3.1415926", 3			--&gt; 3.142</span></span><br><span class="line"><span class="comment">	 * 	"3.1415926", 4			--&gt; 3.1416</span></span><br><span class="line"><span class="comment">	 * 	"3.1415926", 6			--&gt; 3.141593</span></span><br><span class="line"><span class="comment">	 * 	"1234567891234567.1415926", 3	--&gt; 1234567891234567.142</span></span><br><span class="line"><span class="comment">	 * &lt;/pre&gt;</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> //String类型的数字对象</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> precision  小数精确度总位数,如2表示两位小数</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> 返回数字格式化后的字符串表示形式(注意返回的字符串未使用科学计数法)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String keepPrecision(String number, <span class="keyword">int</span> precision) &#123;</span><br><span class="line">		BigDecimal bg = <span class="keyword">new</span> BigDecimal(number);</span><br><span class="line">		<span class="keyword">return</span> bg.setScale(precision, BigDecimal.ROUND_HALF_UP).toPlainString();</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 格式化为指定位小数的数字,返回未使用科学计数法表示的具有指定位数的字符串。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * 该方法舍入模式：向“最接近的”数字舍入，如果与两个相邻数字的距离相等，则为向上舍入的舍入模式。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * 如果给定的数字没有小数，则转换之后将以0填充；例如：int 123  1 --&gt; 123.0&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * &lt;b&gt;注意：&lt;/b&gt;如果精度要求比较精确请使用 keepPrecision(String number, int precision)方法</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> //String类型的数字对象</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> precision  小数精确度总位数,如2表示两位小数</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> 返回数字格式化后的字符串表示形式(注意返回的字符串未使用科学计数法)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String keepPrecision(Number number, <span class="keyword">int</span> precision) &#123;</span><br><span class="line">		<span class="keyword">return</span> keepPrecision(String.valueOf(number), precision);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 对double类型的数值保留指定位数的小数。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * 该方法舍入模式：向“最接近的”数字舍入，如果与两个相邻数字的距离相等，则为向上舍入的舍入模式。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * &lt;b&gt;注意：&lt;/b&gt;如果精度要求比较精确请使用 keepPrecision(String number, int precision)方法</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> number  要保留小数的数字</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> precision 小数位数</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> double 如果数值较大，则使用科学计数法表示</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> keepPrecision(<span class="keyword">double</span> number, <span class="keyword">int</span> precision) &#123;</span><br><span class="line">		BigDecimal bg = <span class="keyword">new</span> BigDecimal(number);</span><br><span class="line">		<span class="keyword">return</span> bg.setScale(precision, BigDecimal.ROUND_HALF_UP).doubleValue();</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 对float类型的数值保留指定位数的小数。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * 该方法舍入模式：向“最接近的”数字舍入，如果与两个相邻数字的距离相等，则为向上舍入的舍入模式。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * &lt;b&gt;注意：&lt;/b&gt;如果精度要求比较精确请使用 keepPrecision(String number, int precision)方法</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> number  要保留小数的数字</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> precision 小数位数</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> float 如果数值较大，则使用科学计数法表示</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">float</span> keepPrecision(<span class="keyword">float</span> number, <span class="keyword">int</span> precision) &#123;</span><br><span class="line">		BigDecimal bg = <span class="keyword">new</span> BigDecimal(number);</span><br><span class="line">		<span class="keyword">return</span> bg.setScale(precision, BigDecimal.ROUND_HALF_UP).floatValue();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获取 ±number 的随机数。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> number  要保留小数的数字</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> float 如果数值较大，则使用科学计数法表示</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">float</span> getRandomNum(<span class="keyword">int</span> number) &#123;</span><br><span class="line">		Random random = <span class="keyword">new</span> Random();</span><br><span class="line">		<span class="comment">//return num /2 + random.nextFloat() * num * -1;</span></span><br><span class="line">		<span class="keyword">int</span> randomNum = (random.nextInt(number)) * (random.nextInt(<span class="number">2</span>) == <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">1</span>);</span><br><span class="line">		String rd = randomNum + <span class="string">"."</span> + random.nextInt(<span class="number">10</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">Float</span>.parseFloat(rd);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 去掉小数点后多余的0。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * 例如: 1.0 则返回 1。&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> number  要处理的数字</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> double </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> rvZeroAndDot(<span class="keyword">double</span> number)&#123;</span><br><span class="line">		String s = String.valueOf(number);</span><br><span class="line">		<span class="keyword">if</span> (s.isEmpty()) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(s.indexOf(<span class="string">"."</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">			s = s.replaceAll(<span class="string">"0+?$"</span>, <span class="string">""</span>);<span class="comment">//去掉多余的0</span></span><br><span class="line">			s = s.replaceAll(<span class="string">"[.]$"</span>, <span class="string">""</span>);<span class="comment">//如最后一位是.则去掉</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">Double</span>.parseDouble(s);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">float</span> generateRandomValue(<span class="keyword">float</span> min, <span class="keyword">float</span> max) &#123;</span><br><span class="line">        <span class="keyword">int</span> mins= (<span class="keyword">int</span>) (min*<span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">int</span> maxs= (<span class="keyword">int</span>) (max*<span class="number">1000</span>);</span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">float</span> s = (random.nextInt(maxs)%(maxs-mins+<span class="number">1</span>) + mins) / <span class="number">1000</span>f;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Linux/2019/04/17/Linux命令[系统管理与维护命令].html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/2019/04/17/Linux命令[系统管理与维护命令].html" itemprop="url">
                  Linux命令[系统管理与维护命令]
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:46:02" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>ls: 列出工作目录所含的文件及子目录,  可以用dir代替ls<br>语法:   <strong><em>ls [选项] [路径或文件]</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">-- 注释: 列出mnt目录下的文件及其子目录--</span><br><span class="line">&gt; ls /mnt</span><br><span class="line">apk-update-service  git-repo-for-redmine  license_capture  lost+found  mysql  newprojects  test</span><br><span class="line"></span><br><span class="line">-- 注释: 列出/mnt目录下文件及其子目录的详细信息--</span><br><span class="line">&gt; ls  -l  /mnt</span><br><span class="line">total 40</span><br><span class="line">drwxrwxrwx  2 root root  4096 Jul 22 09:56 apk-update-service</span><br><span class="line">drwxr-xr-x  5 root root  4096 Jun 27  2017 git-repo-for-redmine</span><br><span class="line">drwxr-xr-x  3 root root  4096 Jul 31  2017 license_capture</span><br><span class="line">drwx------  2 root root 16384 Jun  6  2017 lost+found</span><br><span class="line">drwxr-xr-x  3 root root  4096 Jun 10  2017 mysql</span><br><span class="line">drwxr-xr-x  6 root root  4096 Oct 10  2017 newprojects</span><br><span class="line">drwxr-xr-x 10 root root  4096 Nov  6  2017 test</span><br><span class="line"></span><br><span class="line">-- 注释: 显示mnt目录下的所有文件及其目录的详细信息, 并显示文件类型标记--</span><br><span class="line">&gt; ls -alF /mnt</span><br><span class="line"> ls -alF /mnt </span><br><span class="line">total 48</span><br><span class="line">drwxr-xr-x   9 root root  4096 Jul 31  2017 ./</span><br><span class="line">dr-xr-xr-x. 25 root root  4096 Jun  8 15:30 ../</span><br><span class="line">drwxrwxrwx   2 root root  4096 Jul 22 09:56 apk-update-service/</span><br><span class="line">drwxr-xr-x   5 root root  4096 Jun 27  2017 git-repo-for-redmine/</span><br><span class="line">drwxr-xr-x   3 root root  4096 Jul 31  2017 license_capture/</span><br><span class="line">drwx------   2 root root 16384 Jun  6  2017 lost+found/</span><br><span class="line">drwxr-xr-x   3 root root  4096 Jun 10  2017 mysql/</span><br><span class="line">drwxr-xr-x   6 root root  4096 Oct 10  2017 newprojects/</span><br><span class="line">drwxr-xr-x  10 root root  4096 Nov  6  2017 test/</span><br></pre></td></tr></table></figure>
</li>
<li><p>pwd: 显示当前的工作目录, 即当前所在的工作目录的绝对路径名称<br>语法: <strong><em>pwd</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; pwd</span><br><span class="line">/root</span><br></pre></td></tr></table></figure>
</li>
<li><p>cd: 改变当前的工作目录<br>语法: cd  [目录名]</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; cd  /mnt</span><br><span class="line">&gt; pwd</span><br><span class="line">/mnt</span><br></pre></td></tr></table></figure>
<p>语法: <strong>cd</strong> 返回根目录中<br>语法: <strong>cd - </strong>返回上次调整的目录中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; pwd    -- 当前目录</span><br><span class="line">/mnt       </span><br><span class="line">&gt; cd       -- 跳到根目录</span><br><span class="line">/root</span><br><span class="line">&gt; cd -     -- 跳到最近一次跳转的目录中</span><br><span class="line">/mnt</span><br></pre></td></tr></table></figure>
<ul>
<li>date: 显示或修改系统时间和日期(只有超级用户才能使用date命令修改时间, 一般用户只能用date命令显示时间)<br>语法: <strong><em>date [选项] ‘+时间格式’</em></strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; date &apos;+%y-%m-%d&apos;         </span><br><span class="line">18-10-08</span><br></pre></td></tr></table></figure>
<p>语法: <strong><em>date ‘%x’ 或  ‘%X’</em></strong> 显示日期/时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; date &apos;+today is %x %X&apos;</span><br><span class="line">today is 10/08/2018 02:21:41 PM</span><br></pre></td></tr></table></figure>
<p>语法: <strong><em>date -s yyyyMMdd HH:mm:ss</em></strong>或 <strong><em>date -s yyyyMMdd</em></strong> 或 <strong><em>date  -s HH:mm:ss</em></strong> 设置系统时间</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; date -s &quot;20180715 17:25&quot;</span><br><span class="line">Tue Jul 15 17:25:00 CST 2018</span><br></pre></td></tr></table></figure>
<p>语法: <strong><em>date -d “num years/months/days ago” %y-%m-%d</em></strong>当前时间的前年/月/日的时间<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; date +%y-%m-%d                 </span><br><span class="line">18-10-08</span><br><span class="line">&gt; date -d &quot;10 days ago&quot; +%y-%m-%d</span><br><span class="line">18-09-28</span><br></pre></td></tr></table></figure></p>
<ul>
<li>clear : 清除屏幕信息<br>语法: clear</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; clear</span><br></pre></td></tr></table></figure>
<ul>
<li><p>man:  显示命令的帮助信息<br>语法: <strong><em>man [命令名称]</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; man  clear</span><br><span class="line"></span><br><span class="line">clear(1)                                                              clear(1)</span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">       clear - clear the terminal screen</span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">       clear</span><br><span class="line"></span><br><span class="line">DESCRIPTION</span><br><span class="line">       clear clears your screen if this is possible.  It looks in the environment for the terminal type and then in the terminfo database to figure out how to clear the screen.</span><br><span class="line"></span><br><span class="line">       clear ignores any command-line parameters that may be present.</span><br><span class="line"></span><br><span class="line">SEE ALSO</span><br><span class="line">       tput(1), terminfo(5)</span><br><span class="line"></span><br><span class="line">       This describes ncurses version 5.7 (patch 20090207).</span><br><span class="line"></span><br><span class="line">                                                                      clear(1)</span><br><span class="line">(END)</span><br></pre></td></tr></table></figure>
</li>
<li><p>who: 显示当前登录到系统的用户<br>语法: who</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; who</span><br><span class="line">root     pts/0        2018-10-08 13:26 (203.110.178.83)</span><br><span class="line">-- 注释: 输出格式为</span><br><span class="line">名称 [状态] 终端 时间 [活动] [进程标识]（主机名）</span><br><span class="line">    * 名称：用户的登录名。</span><br><span class="line">    * 状态：表明终端是否对用户都是可写的。</span><br><span class="line">    * 终端：类似于pts/1、pts/2等，此终端标识在/dev目录中可找到。</span><br><span class="line">    * 时间：用户登录系统的时间。</span><br><span class="line">    * 活动：某个用户在自己的终端上最后一次活动发生以来到现在的时间，如果此项是个“.”，就表示一分钟内的终端活动；如果终端保持静止已经超过24小时或自从系统启动以来还没有被使用过，那么此项标记为“old”。</span><br><span class="line">    * 进程标识：用户登录shell的进程id。</span><br><span class="line">    * 主机名：登录到Linux系统上的客户端机器标识。</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">-- 注释: 查看运行级别-- </span><br><span class="line">&gt; who -r  </span><br><span class="line">         run-level 3  2017-07-15 15:26</span><br><span class="line">&gt; who  -w</span><br><span class="line">root     + pts/0        2018-10-08 13:26 (203.110.178.83)</span><br><span class="line"></span><br><span class="line">&gt;  who -buT</span><br><span class="line">           system boot  2017-07-15 15:26</span><br><span class="line">root     + pts/0        2018-10-08 13:26   .          2887 (203.110.178.83)</span><br></pre></td></tr></table></figure>
<ul>
<li>free: 显示内存状态(系统物理内存、虚拟内存、共享内存和系统缓存)<br>语法: free [选项] [-s (间隔秒数)]<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; free</span><br><span class="line">             total       used       free     shared    buffers     cached</span><br><span class="line">Mem:      <span class="number"> 8061108 </span>  <span class="number"> 7875964 </span>   <span class="number"> 185144 </span>   <span class="number"> 146236 </span>   <span class="number"> 201324 </span>    558792</span><br><span class="line">-/+ buffers/cache:   <span class="number"> 7115848 </span>    945260</span><br><span class="line">Swap:           <span class="number"> 0 </span>        <span class="number"> 0 </span>         0</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20181008150804369?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="free参数说明"></p>
<ul>
<li>ps: 系统进程瞬间的运行状态, 非常常用, 可通过组合选项(-ef、aux)准确定位系统运行的状态<br>语法: <strong><em>ps [选项]</em></strong><br><img src="https://img-blog.csdn.net/20181008151130846?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="ps参数"></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; ps</span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line"> 2887 pts/0    00:00:00 zsh</span><br><span class="line">24884 pts/0    00:00:00 ps</span><br><span class="line"></span><br><span class="line">-- 注释: (输出说明)</span><br><span class="line">pid: 进程的标识符</span><br><span class="line">tty: 进程所属的终端控制台</span><br><span class="line">time: 进程所使用的总的cpu时间</span><br><span class="line">cmd: 列出正在执行的命令行</span><br><span class="line">-- </span><br><span class="line"></span><br><span class="line">&gt; ps -aux </span><br><span class="line">&gt; ps -ef</span><br></pre></td></tr></table></figure>
<ul>
<li>top: 类型windows中的任务管理器, 能够实时显示进程的资源占用情况, 可以按照cpu使用情况或内存占用情况进行排序<br><img src="https://img-blog.csdn.net/20181008152506209?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="top参数"></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&gt; top</span><br><span class="line">top - 15:31:25 up 450 days, 4 min,  1 user,  load average: 0.00, 0.00, 0.00</span><br><span class="line">Tasks: 403 total,   1 running, 402 sleeping,   0 stopped,   0 zombie</span><br><span class="line">Cpu(s):  0.9%us,  0.4%sy,  0.0%ni, 98.7%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st</span><br><span class="line">Mem:   8061108k total,  7873600k used,   187508k free,   201444k buffers</span><br><span class="line">Swap:        0k total,        0k used,        0k free,   538576k cached</span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                                                                                           </span><br><span class="line"> 3687 git       20   0 1460m 760m  11m S  1.0  9.7 509:44.69 bundle                                                                                                                                                             </span><br><span class="line">15635 gitlab-r  20   0  241m  12m  912 S  1.0  0.2 366:27.19 redis-server </span><br><span class="line"></span><br><span class="line">-- 注释: </span><br><span class="line">&gt; 第一行:  </span><br><span class="line">15:31:25 当前系统的时间；</span><br><span class="line">up 450 days 表示系统已启动450天4分钟；</span><br><span class="line">1 user当前在线的用户数为1人；</span><br><span class="line">load average:0.00,0.00,0.00表示系统平均负载,3个数分别为1分钟/5分钟/15分钟前到现在的系统平均负载.</span><br><span class="line"></span><br><span class="line">&gt; 第二、三行</span><br><span class="line">Tasks：403 total总共有403个进程；</span><br><span class="line">1 running： 1个运行</span><br><span class="line">402 sleeping：402个处于休眠状态</span><br><span class="line">0 stopped：0个停止</span><br><span class="line">0 zombie：0个僵死</span><br><span class="line">Cpu(s)：0.9% us：表示用戶進程占用CPU的百分比。</span><br><span class="line">0.1% sy：系统进程占用CPU的百分比。</span><br><span class="line">0.0% ni：用户进程空间內改变过优先级的进程占用CPU的百分比。</span><br><span class="line">99.3% id：空闲CPU占用的百分比。</span><br><span class="line">0.2% wa：等待输入、输出的进程占用CPU的百分比。</span><br><span class="line"></span><br><span class="line">&gt; 最后两行</span><br><span class="line">Mem：4059952k total：系統的物理內存大小。</span><br><span class="line">4009540k used：已經使用的物理內存大小。</span><br><span class="line">50412k free：目前空余內存大小。</span><br><span class="line">468964k buffers：用作內核緩沖區的內存大小。</span><br><span class="line">Swap：8193108k total：交換分區內存大小。</span><br><span class="line">0k used：已經使用的交換分區大小。</span><br><span class="line">8193108k free：空閑的交換分區大小。</span><br><span class="line">2320396k cached：緩存大小。</span><br><span class="line"></span><br><span class="line">&gt; 进程信息区</span><br><span class="line">進程信息區</span><br><span class="line"></span><br><span class="line">進程信息區顯示了每個進程的運行狀態，我們先來看一下每列輸出的含義。</span><br><span class="line"></span><br><span class="line">PID：进程的id。</span><br><span class="line">USER：进程所有者的用户名。</span><br><span class="line">pr：进程优先级。</span><br><span class="line">NI：nice值。负值表示高优先级，正值表示低优先级。</span><br><span class="line">VIRT：进程使用的虚拟内存总量，单位KB。VIRT=SWAP+RES。</span><br><span class="line">RES：进程使用的、未被换出的物理內存大小，单位KB。RES=CODE+DATA，其中，CODE为执行代码占用的物理內存大小，DATA为数据占用的內存大小。</span><br><span class="line">SHR：共享內存大小，单位KB。</span><br><span class="line">S：进程状态，D表示不可中断的睡眠状态，R表示运行状态，S表示睡眠状态，T表示跟踪/停止，Z表示僵死进程。</span><br><span class="line">%CPU：上次更新到现在的CPU时间占用百分比。</span><br><span class="line">%MEM：进程占用的物理內存百分比。</span><br><span class="line">TIME+：进程總計使用的CPU时间，单位为1/100秒。</span><br><span class="line">COMMAND：正在运行进程的命令名或者命令路经。</span><br><span class="line">--</span><br></pre></td></tr></table></figure>
<ul>
<li>find: 查找文件<br>语法: find [路径]  </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-- 注释: 查找大于100M的文件, 但是这样无法看文件的大小/属性等 --</span><br><span class="line">&gt; find . -type f -size +100M</span><br><span class="line">./Downloads/root@cq.hbjk.com.cn</span><br><span class="line">./Downloads/jdk-8u131-linux-x64.rpm</span><br><span class="line"></span><br><span class="line">-- 注释: 查找大于100M的文件, 可以看到文件的大小/属性 --</span><br><span class="line">&gt;  find . -type f -size +100M -print0 | xargs -0 ls -l</span><br><span class="line">-rw-r--r-- 1 root root 169983496 Mar 16  2017 ./Downloads/jdk-8u131-linux-x64.rpm</span><br><span class="line">-rw-r--r-- 1 root root 169983496 Oct 18  2017 ./Downloads/root@cq.hbjk.com.cn</span><br><span class="line"></span><br><span class="line">-- 注释: 查找大于100M的文件, 只看大小 --</span><br><span class="line">&gt; find . -type f -size +100M  -print0 | xargs -0 du -h</span><br><span class="line">163M	./Downloads/root@cq.hbjk.com.cn</span><br><span class="line">163M	./Downloads/jdk-8u131-linux-x64.rpm</span><br><span class="line"></span><br><span class="line">-- 注释: 查找大于100M的文件, 只看大小,  并排序 --</span><br><span class="line">&gt; find . -type f -size +100M -print0 | xargs -0 du -h | sort -nr</span><br><span class="line">163M	./Downloads/root@cq.hbjk.com.cn</span><br><span class="line">163M	./Downloads/jdk-8u131-linux-x64.rpm</span><br></pre></td></tr></table></figure>
<ul>
<li>du: 查看当前指定文件或目录(会递归显示子目录)占用磁盘空间大小</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">-- 注释: 查询depth为1的所有文件, 并显示文件大小--</span><br><span class="line">&gt; du -h --max-depth=1</span><br><span class="line">69M	./.m2</span><br><span class="line">60K	./.cache</span><br><span class="line">1.4G	./Downloads</span><br><span class="line">12K	./.oracle_jre_usage</span><br><span class="line">8.0K	./.pki</span><br><span class="line">170M	./.nvm</span><br><span class="line">208M	./.npm</span><br><span class="line">3.6M	./.gem</span><br><span class="line">8.0K	./.pip</span><br><span class="line">112K	./tmp</span><br><span class="line">28M	./.bundle</span><br><span class="line">56K	./.java</span><br><span class="line">276K	./.ssh</span><br><span class="line">4.9M	./.oh-my-zsh</span><br><span class="line">296K	./.vue-templates</span><br><span class="line">1.9G	.</span><br><span class="line"></span><br><span class="line">-- 注释: 查询depth为1的所有文件, 并将文件大小单位用M, 并排序 --</span><br><span class="line">&gt; du -hm --max-depth=1 | sort -n</span><br><span class="line">1	./.cache</span><br><span class="line">1	./.java</span><br><span class="line">1	./.oracle_jre_usage</span><br><span class="line">1	./.pip</span><br><span class="line">1	./.pki</span><br><span class="line">1	./.ssh</span><br><span class="line">1	./tmp</span><br><span class="line">1	./.vue-templates</span><br><span class="line">4	./.gem</span><br><span class="line">5	./.oh-my-zsh</span><br><span class="line">28	./.bundle</span><br><span class="line">69	./.m2</span><br><span class="line">170	./.nvm</span><br><span class="line">208	./.npm</span><br><span class="line">1400	./Downloads</span><br><span class="line">1883	.</span><br><span class="line"></span><br><span class="line">-- 注释: 查询depth为1的所有文件, 并将文件大小单位用M, 排序, 取前12个--</span><br><span class="line">&gt;du -hm --max-depth=2 | sort -nr | head -12</span><br><span class="line">1883	.</span><br><span class="line">1400	./Downloads</span><br><span class="line">383	./Downloads/ruby-2.3.3</span><br><span class="line">377	./Downloads/ruby-2.4.1</span><br><span class="line">208	./.npm</span><br><span class="line">170	./.nvm</span><br><span class="line">167	./.nvm/versions</span><br><span class="line">73	./Downloads/redis-4.0.1</span><br><span class="line">69	./.m2/repository</span><br><span class="line">69	./.m2</span><br><span class="line">47	./Downloads/zookeeper-3.4.9</span><br><span class="line">45	./Downloads/kafka_2.11-0.11.0.0</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Java/2019/04/17/Arrays.asList()返回ArrayList调用remove()或add()出现 java.lang.UnsupportedOperationException异常.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Java/2019/04/17/Arrays.asList()返回ArrayList调用remove()或add()出现 java.lang.UnsupportedOperationException异常.html" itemprop="url">
                  Arrays.asList()返回ArrayList调用remove()或add()出现 java.lang.UnsupportedOperationException异常
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:44:48" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>Iterator和ListIterator可以对集合遍历同时可以做remove操作, 但在调用Arrays.asList()转化为ArrayList的过程中并不能调用remove()<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class Test &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args) &#123;</span><br><span class="line">        List&lt;<span class="keyword">String</span>&gt; list = test();</span><br><span class="line">        Iterator&lt;<span class="keyword">String</span>&gt; it = list.iterator();</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">            <span class="keyword">String</span> <span class="built_in">str</span> = it.next();</span><br><span class="line">            System.out.<span class="built_in">println</span>(<span class="built_in">str</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">str</span>.equals(<span class="string">"a"</span>)) &#123;</span><br><span class="line">                it.remove();     <span class="comment">// <span class="doctag">TODO:</span> 在这出错了!!! java.lang.UnsupportedOperationException</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;<span class="keyword">String</span>&gt; test() &#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> 返回的是java.util.Arrays$ArrayList</span></span><br><span class="line">        List&lt;<span class="keyword">String</span>&gt; list = Arrays.asList(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>);  </span><br><span class="line">        list.<span class="built_in">sort</span>( (e1, e2 ) -&gt; e1.compareTo(e2) );</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>异常:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"main"</span> java<span class="selector-class">.lang</span><span class="selector-class">.UnsupportedOperationException</span></span><br><span class="line">	at java<span class="selector-class">.util</span><span class="selector-class">.AbstractList</span><span class="selector-class">.remove</span>(AbstractList<span class="selector-class">.java</span>:<span class="number">161</span>)</span><br><span class="line">	at java<span class="selector-class">.util</span><span class="selector-class">.AbstractList</span><span class="variable">$Itr</span>.remove(AbstractList<span class="selector-class">.java</span>:<span class="number">374</span>)</span><br><span class="line">	at lambda.main(lambda<span class="selector-class">.java</span>:<span class="number">18</span>)</span><br></pre></td></tr></table></figure></p>
<p>解决方式:</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">private</span> static <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; test() &#123;</span><br><span class="line">       <span class="comment">// <span class="doctag">TODO:</span> 转化成java.util.ArrayList</span></span><br><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; <span class="built_in">list</span> = <span class="literal">new</span> ArrayList(Arrays.asList(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>));</span><br><span class="line">       <span class="built_in">list</span>.sort( (e1, e2 ) -&gt; e1.compareTo(e2) );</span><br><span class="line">       <span class="keyword">return</span> <span class="built_in">list</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>什么原因呢? Arrays.asList()返回的是ArrayList没错, 但是返回的ArrayList是Array的一个内部类（java.util.Arrays$ArrayList）, 源码贴到下面了， 观察一下, 根本没有java.util.ArrayList类中的add()、remove()方法, 调用remove()方法当然出错啦！</p>
<figure class="highlight plain"><figcaption><span>源码]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">    public static &lt;T&gt; List&lt;T&gt; asList(T... a) &#123;</span><br><span class="line">        return new ArrayList&lt;&gt;(a);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt;</span><br><span class="line">        implements RandomAccess, java.io.Serializable</span><br><span class="line">    &#123;</span><br><span class="line">        private static final long serialVersionUID = -2764017481108945198L;</span><br><span class="line">        private final E[] a;</span><br><span class="line"></span><br><span class="line">        ArrayList(E[] array) &#123;</span><br><span class="line">            a = Objects.requireNonNull(array);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public int size() &#123;</span><br><span class="line">            return a.length;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public Object[] toArray() &#123;</span><br><span class="line">            return a.clone();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        @SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="line">        public &lt;T&gt; T[] toArray(T[] a) &#123;</span><br><span class="line">            int size = size();</span><br><span class="line">            if (a.length &lt; size)</span><br><span class="line">                return Arrays.copyOf(this.a, size,</span><br><span class="line">                                     (Class&lt;? extends T[]&gt;) a.getClass());</span><br><span class="line">            System.arraycopy(this.a, 0, a, 0, size);</span><br><span class="line">            if (a.length &gt; size)</span><br><span class="line">                a[size] = null;</span><br><span class="line">            return a;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public E get(int index) &#123;</span><br><span class="line">            return a[index];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public E set(int index, E element) &#123;</span><br><span class="line">            E oldValue = a[index];</span><br><span class="line">            a[index] = element;</span><br><span class="line">            return oldValue;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public int indexOf(Object o) &#123;</span><br><span class="line">            E[] a = this.a;</span><br><span class="line">            if (o == null) &#123;</span><br><span class="line">                for (int i = 0; i &lt; a.length; i++)</span><br><span class="line">                    if (a[i] == null)</span><br><span class="line">                        return i;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                for (int i = 0; i &lt; a.length; i++)</span><br><span class="line">                    if (o.equals(a[i]))</span><br><span class="line">                        return i;</span><br><span class="line">            &#125;</span><br><span class="line">            return -1;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public boolean contains(Object o) &#123;</span><br><span class="line">            return indexOf(o) != -1;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public Spliterator&lt;E&gt; spliterator() &#123;</span><br><span class="line">            return Spliterators.spliterator(a, Spliterator.ORDERED);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void forEach(Consumer&lt;? super E&gt; action) &#123;</span><br><span class="line">            Objects.requireNonNull(action);</span><br><span class="line">            for (E e : a) &#123;</span><br><span class="line">                action.accept(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void replaceAll(UnaryOperator&lt;E&gt; operator) &#123;</span><br><span class="line">            Objects.requireNonNull(operator);</span><br><span class="line">            E[] a = this.a;</span><br><span class="line">            for (int i = 0; i &lt; a.length; i++) &#123;</span><br><span class="line">                a[i] = operator.apply(a[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void sort(Comparator&lt;? super E&gt; c) &#123;</span><br><span class="line">            Arrays.sort(a, c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Linux/2019/04/17/Another app is currently holding the yum lock; waiting for it to exit....html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/2019/04/17/Another app is currently holding the yum lock; waiting for it to exit....html" itemprop="url">
                  Another app is currently holding the yum lock; waiting for it to exit...
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:44:41" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>yum 安装时出现如下错误:</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost gitrepo]<span class="comment">#  yum install gitlab-ce</span></span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Existing lock /var/<span class="built_in">run</span>/yum.pid: another <span class="keyword">copy</span> <span class="keyword">is</span> <span class="built_in">running</span> <span class="keyword">as</span> pid <span class="number">6807.</span></span><br><span class="line">Another app <span class="keyword">is</span> currently holding <span class="keyword">the</span> yum lock; waiting <span class="keyword">for</span> <span class="keyword">it</span> <span class="keyword">to</span> <span class="keyword">exit</span>...</span><br><span class="line">  The other <span class="built_in">application</span> <span class="keyword">is</span>: PackageKit</span><br><span class="line">    Memory : <span class="number">120</span> M RSS (<span class="number">532</span> MB VSZ)</span><br><span class="line">    Started: Tue Oct  <span class="number">9</span> <span class="number">18</span>:<span class="number">18</span>:<span class="number">18</span> <span class="number">2018</span> - <span class="number">18</span>:<span class="number">17</span> ago</span><br><span class="line">    State  : Sleeping, pid: <span class="number">6807</span></span><br><span class="line">Another app <span class="keyword">is</span> currently holding <span class="keyword">the</span> yum lock; waiting <span class="keyword">for</span> <span class="keyword">it</span> <span class="keyword">to</span> <span class="keyword">exit</span>...</span><br><span class="line">  The other <span class="built_in">application</span> <span class="keyword">is</span>: PackageKit</span><br><span class="line">    Memory : <span class="number">120</span> M RSS (<span class="number">532</span> MB VSZ)</span><br><span class="line">    Started: Tue Oct  <span class="number">9</span> <span class="number">18</span>:<span class="number">18</span>:<span class="number">18</span> <span class="number">2018</span> - <span class="number">18</span>:<span class="number">19</span> ago</span><br><span class="line">    State  : Sleeping, pid: <span class="number">6807</span></span><br><span class="line">Another app <span class="keyword">is</span> currently holding <span class="keyword">the</span> yum lock; waiting <span class="keyword">for</span> <span class="keyword">it</span> <span class="keyword">to</span> <span class="keyword">exit</span>...</span><br><span class="line">  The other <span class="built_in">application</span> <span class="keyword">is</span>: PackageKit</span><br><span class="line">    Memory : <span class="number">120</span> M RSS (<span class="number">532</span> MB VSZ)</span><br><span class="line">    Started: Tue Oct  <span class="number">9</span> <span class="number">18</span>:<span class="number">18</span>:<span class="number">18</span> <span class="number">2018</span> - <span class="number">18</span>:<span class="number">21</span> ago</span><br><span class="line">    State  : Sleeping, pid: <span class="number">6807</span></span><br></pre></td></tr></table></figure>
<ul>
<li>原因: yum只能支持一个例程运行，所以如果有一个例程已经在运行，其他的必须等待该进程退出释放lock。出现这种情况时，可以用以下命令来恢复：</li>
</ul>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">rm</span> -f /<span class="keyword">var</span>/<span class="keyword">run</span>/yum.pid</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Java/2019/04/17/poi-tl生成Word.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Java/2019/04/17/poi-tl生成Word.html" itemprop="url">
                  poi-tl生成Word
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:46:47" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>文档: <a href="http://deepoove.com/poi-tl/" target="_blank" rel="noopener">http://deepoove.com/poi-tl/</a></p>
</li>
<li><p>添加依赖</p>
</li>
</ul>
<ol>
<li>poi 版本必须大于3.14(我用的是3.17)</li>
<li>ooxml 版本必须大于1.2(我用的是1.3)<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 模版引擎用到的jar包 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.deepoove<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-tl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-scratchpad<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ooxml-schemas<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>注意: 你可能遇到以下几个问题</p>
<ul>
<li>poi版本过低：使用 poi 3.14 以上 <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"main"</span> java<span class="selector-class">.lang</span><span class="selector-class">.NoClassDefFoundError</span>: org/apache/poi/POIXMLTypeLoader</span><br><span class="line">	at org<span class="selector-class">.openxmlformats</span><span class="selector-class">.schemas</span><span class="selector-class">.wordprocessingml</span><span class="selector-class">.x2006</span><span class="selector-class">.main</span><span class="selector-class">.DocumentDocument</span><span class="variable">$Factory</span>.parse(Unknown Source)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.poi</span><span class="selector-class">.xwpf</span><span class="selector-class">.usermodel</span><span class="selector-class">.XWPFDocument</span><span class="selector-class">.onDocumentRead</span>(XWPFDocument<span class="selector-class">.java</span>:<span class="number">136</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.poi</span><span class="selector-class">.POIXMLDocument</span><span class="selector-class">.load</span>(POIXMLDocument<span class="selector-class">.java</span>:<span class="number">166</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.poi</span><span class="selector-class">.xwpf</span><span class="selector-class">.usermodel</span><span class="selector-class">.XWPFDocument</span>.&lt;init&gt;(XWPFDocument<span class="selector-class">.java</span>:<span class="number">125</span>)</span><br><span class="line">	at com<span class="selector-class">.deepoove</span><span class="selector-class">.poi</span><span class="selector-class">.NiceXWPFDocument</span>.&lt;init&gt;(NiceXWPFDocument<span class="selector-class">.java</span>:<span class="number">85</span>)</span><br><span class="line">	at com<span class="selector-class">.deepoove</span><span class="selector-class">.poi</span><span class="selector-class">.XWPFTemplate</span><span class="selector-class">.compile</span>(XWPFTemplate<span class="selector-class">.java</span>:<span class="number">129</span>)</span><br><span class="line">	at com<span class="selector-class">.deepoove</span><span class="selector-class">.poi</span><span class="selector-class">.XWPFTemplate</span><span class="selector-class">.compile</span>(XWPFTemplate<span class="selector-class">.java</span>:<span class="number">110</span>)</span><br><span class="line">	at com<span class="selector-class">.deepoove</span><span class="selector-class">.poi</span><span class="selector-class">.XWPFTemplate</span><span class="selector-class">.compile</span>(XWPFTemplate<span class="selector-class">.java</span>:<span class="number">78</span>)</span><br><span class="line">	at com<span class="selector-class">.deepoove</span><span class="selector-class">.poi</span><span class="selector-class">.XWPFTemplate</span><span class="selector-class">.compile</span>(XWPFTemplate<span class="selector-class">.java</span>:<span class="number">74</span>)</span><br><span class="line">	at core<span class="selector-class">.JingzhouDayReportDaemon</span><span class="selector-class">.saveData2Word</span>(JingzhouDayReportDaemon<span class="selector-class">.java</span>:<span class="number">187</span>)</span><br><span class="line">	at core<span class="selector-class">.JingzhouDayReportDaemon</span><span class="selector-class">.run</span>(JingzhouDayReportDaemon<span class="selector-class">.java</span>:<span class="number">45</span>)</span><br><span class="line">	at core<span class="selector-class">.JingzhouDayReportDaemon</span><span class="selector-class">.main</span>(JingzhouDayReportDaemon<span class="selector-class">.java</span>:<span class="number">289</span>)</span><br><span class="line">Caused by: java<span class="selector-class">.lang</span><span class="selector-class">.ClassNotFoundException</span>: org<span class="selector-class">.apache</span><span class="selector-class">.poi</span><span class="selector-class">.POIXMLTypeLoader</span></span><br><span class="line">	at java<span class="selector-class">.net</span><span class="selector-class">.URLClassLoader</span><span class="selector-class">.findClass</span>(URLClassLoader<span class="selector-class">.java</span>:<span class="number">381</span>)</span><br><span class="line">	at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.loadClass</span>(ClassLoader<span class="selector-class">.java</span>:<span class="number">424</span>)</span><br><span class="line">	at sun<span class="selector-class">.misc</span><span class="selector-class">.Launcher</span><span class="variable">$AppClassLoader</span>.loadClass(Launcher<span class="selector-class">.java</span>:<span class="number">331</span>)</span><br><span class="line">	at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.loadClass</span>(ClassLoader<span class="selector-class">.java</span>:<span class="number">357</span>)</span><br><span class="line">	... <span class="number">12</span> more</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">/-- Encapsulated exception ------------\</span><br><span class="line">java<span class="selector-class">.lang</span><span class="selector-class">.NoClassDefFoundError</span>: org/apache/poi/UnsupportedFileFormatException</span><br><span class="line">	at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.defineClass1</span>(Native Method)</span><br><span class="line">	at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.defineClass</span>(ClassLoader<span class="selector-class">.java</span>:<span class="number">763</span>)</span><br><span class="line">	at java<span class="selector-class">.security</span><span class="selector-class">.SecureClassLoader</span><span class="selector-class">.defineClass</span>(SecureClassLoader<span class="selector-class">.java</span>:<span class="number">142</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.loader</span><span class="selector-class">.WebappClassLoaderBase</span><span class="selector-class">.findClassInternal</span>(WebappClassLoaderBase<span class="selector-class">.java</span>:<span class="number">3205</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.loader</span><span class="selector-class">.WebappClassLoaderBase</span><span class="selector-class">.findClass</span>(WebappClassLoaderBase<span class="selector-class">.java</span>:<span class="number">1373</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.loader</span><span class="selector-class">.WebappClassLoaderBase</span><span class="selector-class">.loadClass</span>(WebappClassLoaderBase<span class="selector-class">.java</span>:<span class="number">1861</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.loader</span><span class="selector-class">.WebappClassLoaderBase</span><span class="selector-class">.loadClass</span>(WebappClassLoaderBase<span class="selector-class">.java</span>:<span class="number">1735</span>)</span><br><span class="line">	at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.defineClass1</span>(Native Method)</span><br><span class="line">	at java<span class="selector-class">.lang</span><span class="selector-class">.ClassLoader</span><span class="selector-class">.defineClass</span>(ClassLoader<span class="selector-class">.java</span>:<span class="number">763</span>)</span><br><span class="line">	at java<span class="selector-class">.security</span><span class="selector-class">.SecureClassLoader</span><span class="selector-class">.defineClass</span>(SecureClassLoader<span class="selector-class">.java</span>:<span class="number">142</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.loader</span><span class="selector-class">.WebappClassLoaderBase</span><span class="selector-class">.findClassInternal</span>(WebappClassLoaderBase<span class="selector-class">.java</span>:<span class="number">3205</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.loader</span><span class="selector-class">.WebappClassLoaderBase</span><span class="selector-class">.findClass</span>(WebappClassLoaderBase<span class="selector-class">.java</span>:<span class="number">1373</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.loader</span><span class="selector-class">.WebappClassLoaderBase</span><span class="selector-class">.loadClass</span>(WebappClassLoaderBase<span class="selector-class">.java</span>:<span class="number">1861</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.loader</span><span class="selector-class">.WebappClassLoaderBase</span><span class="selector-class">.loadClass</span>(WebappClassLoaderBase<span class="selector-class">.java</span>:<span class="number">1735</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.poi</span><span class="selector-class">.openxml4j</span><span class="selector-class">.opc</span><span class="selector-class">.OPCPackage</span><span class="selector-class">.open</span>(OPCPackage<span class="selector-class">.java</span>:<span class="number">324</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.poi</span><span class="selector-class">.util</span><span class="selector-class">.PackageHelper</span><span class="selector-class">.open</span>(PackageHelper<span class="selector-class">.java</span>:<span class="number">37</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.poi</span><span class="selector-class">.xwpf</span><span class="selector-class">.usermodel</span><span class="selector-class">.XWPFDocument</span>.&lt;init&gt;(XWPFDocument<span class="selector-class">.java</span>:<span class="number">116</span>)</span><br><span class="line">	at com<span class="selector-class">.deepoove</span><span class="selector-class">.poi</span><span class="selector-class">.NiceXWPFDocument</span>.&lt;init&gt;(NiceXWPFDocument<span class="selector-class">.java</span>:<span class="number">85</span>)</span><br><span class="line">	at com<span class="selector-class">.deepoove</span><span class="selector-class">.poi</span><span class="selector-class">.XWPFTemplate</span><span class="selector-class">.compile</span>(XWPFTemplate<span class="selector-class">.java</span>:<span class="number">129</span>)</span><br><span class="line">	at com<span class="selector-class">.deepoove</span><span class="selector-class">.poi</span><span class="selector-class">.XWPFTemplate</span><span class="selector-class">.compile</span>(XWPFTemplate<span class="selector-class">.java</span>:<span class="number">110</span>)</span><br><span class="line">	at com<span class="selector-class">.deepoove</span><span class="selector-class">.poi</span><span class="selector-class">.XWPFTemplate</span><span class="selector-class">.compile</span>(XWPFTemplate<span class="selector-class">.java</span>:<span class="number">78</span>)</span><br><span class="line">	at com<span class="selector-class">.deepoove</span><span class="selector-class">.poi</span><span class="selector-class">.XWPFTemplate</span><span class="selector-class">.compile</span>(XWPFTemplate<span class="selector-class">.java</span>:<span class="number">74</span>)</span><br><span class="line">	at dao<span class="selector-class">.analysis</span><span class="selector-class">.daytimeReport</span><span class="selector-class">.DaytimeReportDAO</span><span class="selector-class">.saveData2Word</span>(DaytimeReportDAO<span class="selector-class">.java</span>:<span class="number">702</span>)</span><br><span class="line">	at action<span class="selector-class">.v3</span><span class="selector-class">.Analysis</span><span class="selector-class">.DayTimeReportAction</span><span class="selector-class">.queryDayReport</span>(DayTimeReportAction<span class="selector-class">.java</span>:<span class="number">369</span>)</span><br><span class="line">	at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span><span class="selector-class">.invoke0</span>(Native Method)</span><br><span class="line">	at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span><span class="selector-class">.invoke</span>(NativeMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line">	at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingMethodAccessorImpl</span><span class="selector-class">.invoke</span>(DelegatingMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">43</span>)</span><br><span class="line">	at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Method</span><span class="selector-class">.invoke</span>(Method<span class="selector-class">.java</span>:<span class="number">498</span>)</span><br><span class="line">	at ognl<span class="selector-class">.OgnlRuntime</span><span class="selector-class">.invokeMethod</span>(OgnlRuntime<span class="selector-class">.java</span>:<span class="number">871</span>)</span><br><span class="line">	at ognl<span class="selector-class">.OgnlRuntime</span><span class="selector-class">.callAppropriateMethod</span>(OgnlRuntime<span class="selector-class">.java</span>:<span class="number">1294</span>)</span><br><span class="line">	at ognl<span class="selector-class">.ObjectMethodAccessor</span><span class="selector-class">.callMethod</span>(ObjectMethodAccessor<span class="selector-class">.java</span>:<span class="number">68</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.ognl</span><span class="selector-class">.accessor</span><span class="selector-class">.XWorkMethodAccessor</span><span class="selector-class">.callMethodWithDebugInfo</span>(XWorkMethodAccessor<span class="selector-class">.java</span>:<span class="number">117</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.ognl</span><span class="selector-class">.accessor</span><span class="selector-class">.XWorkMethodAccessor</span><span class="selector-class">.callMethod</span>(XWorkMethodAccessor<span class="selector-class">.java</span>:<span class="number">108</span>)</span><br><span class="line">	at ognl<span class="selector-class">.OgnlRuntime</span><span class="selector-class">.callMethod</span>(OgnlRuntime<span class="selector-class">.java</span>:<span class="number">1370</span>)</span><br><span class="line">	at ognl<span class="selector-class">.ASTMethod</span><span class="selector-class">.getValueBody</span>(ASTMethod<span class="selector-class">.java</span>:<span class="number">91</span>)</span><br><span class="line">	at ognl<span class="selector-class">.SimpleNode</span><span class="selector-class">.evaluateGetValueBody</span>(SimpleNode<span class="selector-class">.java</span>:<span class="number">212</span>)</span><br><span class="line">	at ognl<span class="selector-class">.SimpleNode</span><span class="selector-class">.getValue</span>(SimpleNode<span class="selector-class">.java</span>:<span class="number">258</span>)</span><br><span class="line">	at ognl<span class="selector-class">.Ognl</span><span class="selector-class">.getValue</span>(Ognl<span class="selector-class">.java</span>:<span class="number">467</span>)</span><br><span class="line">	at ognl<span class="selector-class">.Ognl</span><span class="selector-class">.getValue</span>(Ognl<span class="selector-class">.java</span>:<span class="number">431</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.ognl</span><span class="selector-class">.OgnlUtil</span>$<span class="number">3</span>.execute(OgnlUtil<span class="selector-class">.java</span>:<span class="number">352</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.ognl</span><span class="selector-class">.OgnlUtil</span><span class="selector-class">.compileAndExecuteMethod</span>(OgnlUtil<span class="selector-class">.java</span>:<span class="number">404</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.ognl</span><span class="selector-class">.OgnlUtil</span><span class="selector-class">.callMethod</span>(OgnlUtil<span class="selector-class">.java</span>:<span class="number">350</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invokeAction</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">430</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invokeActionOnly</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">290</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">251</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.interceptor</span><span class="selector-class">.DeprecationInterceptor</span><span class="selector-class">.intercept</span>(DeprecationInterceptor<span class="selector-class">.java</span>:<span class="number">41</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.interceptor</span><span class="selector-class">.debugging</span><span class="selector-class">.DebuggingInterceptor</span><span class="selector-class">.intercept</span>(DebuggingInterceptor<span class="selector-class">.java</span>:<span class="number">256</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.DefaultWorkflowInterceptor</span><span class="selector-class">.doIntercept</span>(DefaultWorkflowInterceptor<span class="selector-class">.java</span>:<span class="number">168</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.MethodFilterInterceptor</span><span class="selector-class">.intercept</span>(MethodFilterInterceptor<span class="selector-class">.java</span>:<span class="number">98</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.validator</span><span class="selector-class">.ValidationInterceptor</span><span class="selector-class">.doIntercept</span>(ValidationInterceptor<span class="selector-class">.java</span>:<span class="number">265</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.interceptor</span><span class="selector-class">.validation</span><span class="selector-class">.AnnotationValidationInterceptor</span><span class="selector-class">.doIntercept</span>(AnnotationValidationInterceptor<span class="selector-class">.java</span>:<span class="number">76</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.MethodFilterInterceptor</span><span class="selector-class">.intercept</span>(MethodFilterInterceptor<span class="selector-class">.java</span>:<span class="number">98</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.ConversionErrorInterceptor</span><span class="selector-class">.intercept</span>(ConversionErrorInterceptor<span class="selector-class">.java</span>:<span class="number">138</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.ParametersInterceptor</span><span class="selector-class">.doIntercept</span>(ParametersInterceptor<span class="selector-class">.java</span>:<span class="number">229</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.MethodFilterInterceptor</span><span class="selector-class">.intercept</span>(MethodFilterInterceptor<span class="selector-class">.java</span>:<span class="number">98</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.ParametersInterceptor</span><span class="selector-class">.doIntercept</span>(ParametersInterceptor<span class="selector-class">.java</span>:<span class="number">229</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.MethodFilterInterceptor</span><span class="selector-class">.intercept</span>(MethodFilterInterceptor<span class="selector-class">.java</span>:<span class="number">98</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.StaticParametersInterceptor</span><span class="selector-class">.intercept</span>(StaticParametersInterceptor<span class="selector-class">.java</span>:<span class="number">191</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.interceptor</span><span class="selector-class">.MultiselectInterceptor</span><span class="selector-class">.intercept</span>(MultiselectInterceptor<span class="selector-class">.java</span>:<span class="number">73</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.interceptor</span><span class="selector-class">.DateTextFieldInterceptor</span><span class="selector-class">.intercept</span>(DateTextFieldInterceptor<span class="selector-class">.java</span>:<span class="number">125</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.interceptor</span><span class="selector-class">.CheckboxInterceptor</span><span class="selector-class">.intercept</span>(CheckboxInterceptor<span class="selector-class">.java</span>:<span class="number">91</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.interceptor</span><span class="selector-class">.FileUploadInterceptor</span><span class="selector-class">.intercept</span>(FileUploadInterceptor<span class="selector-class">.java</span>:<span class="number">253</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.ModelDrivenInterceptor</span><span class="selector-class">.intercept</span>(ModelDrivenInterceptor<span class="selector-class">.java</span>:<span class="number">100</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.ScopedModelDrivenInterceptor</span><span class="selector-class">.intercept</span>(ScopedModelDrivenInterceptor<span class="selector-class">.java</span>:<span class="number">141</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.ChainingInterceptor</span><span class="selector-class">.intercept</span>(ChainingInterceptor<span class="selector-class">.java</span>:<span class="number">145</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.PrepareInterceptor</span><span class="selector-class">.doIntercept</span>(PrepareInterceptor<span class="selector-class">.java</span>:<span class="number">171</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.MethodFilterInterceptor</span><span class="selector-class">.intercept</span>(MethodFilterInterceptor<span class="selector-class">.java</span>:<span class="number">98</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.I18nInterceptor</span><span class="selector-class">.intercept</span>(I18nInterceptor<span class="selector-class">.java</span>:<span class="number">140</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.interceptor</span><span class="selector-class">.ServletConfigInterceptor</span><span class="selector-class">.intercept</span>(ServletConfigInterceptor<span class="selector-class">.java</span>:<span class="number">164</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.AliasInterceptor</span><span class="selector-class">.intercept</span>(AliasInterceptor<span class="selector-class">.java</span>:<span class="number">193</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.interceptor</span><span class="selector-class">.ExceptionMappingInterceptor</span><span class="selector-class">.intercept</span>(ExceptionMappingInterceptor<span class="selector-class">.java</span>:<span class="number">189</span>)</span><br><span class="line">	at com<span class="selector-class">.opensymphony</span><span class="selector-class">.xwork2</span><span class="selector-class">.DefaultActionInvocation</span><span class="selector-class">.invoke</span>(DefaultActionInvocation<span class="selector-class">.java</span>:<span class="number">245</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.impl</span><span class="selector-class">.StrutsActionProxy</span><span class="selector-class">.execute</span>(StrutsActionProxy<span class="selector-class">.java</span>:<span class="number">54</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.dispatcher</span><span class="selector-class">.Dispatcher</span><span class="selector-class">.serviceAction</span>(Dispatcher<span class="selector-class">.java</span>:<span class="number">575</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.dispatcher</span><span class="selector-class">.ng</span><span class="selector-class">.ExecuteOperations</span><span class="selector-class">.executeAction</span>(ExecuteOperations<span class="selector-class">.java</span>:<span class="number">81</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.struts2</span><span class="selector-class">.dispatcher</span><span class="selector-class">.ng</span><span class="selector-class">.filter</span><span class="selector-class">.StrutsPrepareAndExecuteFilter</span><span class="selector-class">.doFilter</span>(StrutsPrepareAndExecuteFilter<span class="selector-class">.java</span>:<span class="number">99</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.ApplicationFilterChain</span><span class="selector-class">.internalDoFilter</span>(ApplicationFilterChain<span class="selector-class">.java</span>:<span class="number">241</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.ApplicationFilterChain</span><span class="selector-class">.doFilter</span>(ApplicationFilterChain<span class="selector-class">.java</span>:<span class="number">208</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.StandardWrapperValve</span><span class="selector-class">.invoke</span>(StandardWrapperValve<span class="selector-class">.java</span>:<span class="number">218</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.StandardContextValve</span><span class="selector-class">.invoke</span>(StandardContextValve<span class="selector-class">.java</span>:<span class="number">110</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.authenticator</span><span class="selector-class">.AuthenticatorBase</span><span class="selector-class">.invoke</span>(AuthenticatorBase<span class="selector-class">.java</span>:<span class="number">506</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.StandardHostValve</span><span class="selector-class">.invoke</span>(StandardHostValve<span class="selector-class">.java</span>:<span class="number">169</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.valves</span><span class="selector-class">.ErrorReportValve</span><span class="selector-class">.invoke</span>(ErrorReportValve<span class="selector-class">.java</span>:<span class="number">103</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.valves</span><span class="selector-class">.AccessLogValve</span><span class="selector-class">.invoke</span>(AccessLogValve<span class="selector-class">.java</span>:<span class="number">962</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.core</span><span class="selector-class">.StandardEngineValve</span><span class="selector-class">.invoke</span>(StandardEngineValve<span class="selector-class">.java</span>:<span class="number">116</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.connector</span><span class="selector-class">.CoyoteAdapter</span><span class="selector-class">.service</span>(CoyoteAdapter<span class="selector-class">.java</span>:<span class="number">452</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.coyote</span><span class="selector-class">.http11</span><span class="selector-class">.AbstractHttp11Processor</span><span class="selector-class">.process</span>(AbstractHttp11Processor<span class="selector-class">.java</span>:<span class="number">1087</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.coyote</span><span class="selector-class">.AbstractProtocol</span><span class="variable">$AbstractConnectionHandler</span>.process(AbstractProtocol<span class="selector-class">.java</span>:<span class="number">637</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.tomcat</span><span class="selector-class">.util</span><span class="selector-class">.net</span><span class="selector-class">.AprEndpoint</span><span class="variable">$SocketProcessor</span>.doRun(AprEndpoint<span class="selector-class">.java</span>:<span class="number">2536</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.tomcat</span><span class="selector-class">.util</span><span class="selector-class">.net</span><span class="selector-class">.AprEndpoint</span><span class="variable">$SocketProcessor</span>.run(AprEndpoint<span class="selector-class">.java</span>:<span class="number">2525</span>)</span><br><span class="line">	at java<span class="selector-class">.util</span><span class="selector-class">.concurrent</span><span class="selector-class">.ThreadPoolExecutor</span><span class="selector-class">.runWorker</span>(ThreadPoolExecutor<span class="selector-class">.java</span>:<span class="number">1142</span>)</span><br><span class="line">	at java<span class="selector-class">.util</span><span class="selector-class">.concurrent</span><span class="selector-class">.ThreadPoolExecutor</span><span class="variable">$Worker</span>.run(ThreadPoolExecutor<span class="selector-class">.java</span>:<span class="number">617</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.tomcat</span><span class="selector-class">.util</span><span class="selector-class">.threads</span><span class="selector-class">.TaskThread</span><span class="variable">$WrappingRunnable</span>.run(TaskThread<span class="selector-class">.java</span>:<span class="number">61</span>)</span><br><span class="line">	at java<span class="selector-class">.lang</span><span class="selector-class">.Thread</span><span class="selector-class">.run</span>(Thread<span class="selector-class">.java</span>:<span class="number">745</span>)</span><br><span class="line">Caused by: java<span class="selector-class">.lang</span><span class="selector-class">.ClassNotFoundException</span>: org<span class="selector-class">.apache</span><span class="selector-class">.poi</span><span class="selector-class">.UnsupportedFileFormatException</span></span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.loader</span><span class="selector-class">.WebappClassLoaderBase</span><span class="selector-class">.loadClass</span>(WebappClassLoaderBase<span class="selector-class">.java</span>:<span class="number">1892</span>)</span><br><span class="line">	at org<span class="selector-class">.apache</span><span class="selector-class">.catalina</span><span class="selector-class">.loader</span><span class="selector-class">.WebappClassLoaderBase</span><span class="selector-class">.loadClass</span>(WebappClassLoaderBase<span class="selector-class">.java</span>:<span class="number">1735</span>)</span><br><span class="line">	... <span class="number">113</span> more</span><br></pre></td></tr></table></figure>
<ul>
<li>参考文档: <a href="https://blog.csdn.net/moshowgame/article/details/81702029" target="_blank" rel="noopener">https://blog.csdn.net/moshowgame/article/details/81702029</a></li>
</ul>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Netty/2019/04/17/netty自定义协议上传.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Netty/2019/04/17/netty自定义协议上传.html" itemprop="url">
                  Netty自定义协议上传
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:46:38" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Netty/" itemprop="url" rel="index"><span itemprop="name">Netty</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>客户端:<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.bootstrap.Bootstrap;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.channel.ChannelFuture;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.channel.EventLoopGroup;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.channel.nio.NioEventLoopGroup;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.channel.socket.nio.NioSocketChannel;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.handler.logging.LogLevel;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.handler.logging.LoggingHandler;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketClient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) throws InterruptedException &#123;</span><br><span class="line">        EventLoopGroup eventLoopGroup = <span class="keyword">new</span> NioEventLoopGroup();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Bootstrap bootstrap = <span class="keyword">new</span> Bootstrap();</span><br><span class="line">            bootstrap.group(eventLoopGroup)</span><br><span class="line">                    .channel(NioSocketChannel.class)</span><br><span class="line">                    .handler(<span class="keyword">new</span> LoggingHandler(LogLevel.INFO))</span><br><span class="line">                    .handler(<span class="keyword">new</span> SocketClientInitializer());</span><br><span class="line"></span><br><span class="line">            ChannelFuture channelFuture = bootstrap.connect(<span class="string">"localhost"</span>, <span class="number">8899</span>).sync();</span><br><span class="line">            channelFuture.channel().closeFuture().sync();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span> &#123;</span><br><span class="line">            eventLoopGroup.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.netty.<span class="built_in">buffer</span>.ByteBuf;</span><br><span class="line"><span class="keyword">import</span> io.netty.<span class="built_in">buffer</span>.UnpooledByteBufAllocator;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelHandlerContext;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelInboundHandlerAdapter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class SocketClientHandler extends ChannelInboundHandlerAdapter &#123;</span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> channelRead(ChannelHandlerContext ctx, Object msg) throws Exception &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> channelActive(ChannelHandlerContext ctx) throws Exception &#123;</span><br><span class="line">        UnpooledByteBufAllocator allocator = <span class="keyword">new</span> UnpooledByteBufAllocator(false);</span><br><span class="line">        ByteBuf <span class="built_in">buffer</span> = allocator.<span class="built_in">buffer</span>(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        String longMsgBody = "";</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">String</span> device = <span class="string">"T0001"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">String</span> imgStr = getBytes();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> length = imgStr.length();</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"总长度: "</span> + length + device.length() + <span class="number">8</span>);</span><br><span class="line">        <span class="built_in">buffer</span>.writeInt(length + device.length() + <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        buffer.writeBytes(new byte[]&#123;0x0a, 0x0d&#125;);</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">buffer</span>.writeInt(device.length());</span><br><span class="line">        <span class="built_in">buffer</span>.writeInt(imgStr.length());</span><br><span class="line">        <span class="built_in">buffer</span>.writeBytes(device.getBytes());</span><br><span class="line"></span><br><span class="line">        <span class="built_in">buffer</span>.writeBytes(imgStr.getBytes());</span><br><span class="line"></span><br><span class="line">        ctx.writeAndFlush(<span class="built_in">buffer</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">String</span> getBytes() &#123;</span><br><span class="line">        <span class="built_in">try</span> &#123;</span><br><span class="line">            StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">            FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"D:/mmmm.jpg"</span>);</span><br><span class="line">            BufferedInputStream bis = <span class="keyword">new</span> BufferedInputStream(fis);</span><br><span class="line">            java.io.ByteArrayOutputStream bos = <span class="keyword">new</span> java.io.ByteArrayOutputStream();</span><br><span class="line">            <span class="keyword">byte</span>[] buff = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">while</span> ((len = fis.<span class="built_in">read</span>(buff)) != <span class="number">-1</span>) &#123;</span><br><span class="line">                bos.<span class="built_in">write</span>(buff, <span class="number">0</span>, len);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 得到图片的字节数组</span></span><br><span class="line">            <span class="keyword">byte</span>[] result = bos.toByteArray();</span><br><span class="line">            System.out.<span class="built_in">println</span>(byte2HexStr(result));</span><br><span class="line">            <span class="comment">// 字节数组转成十六进制</span></span><br><span class="line">            <span class="keyword">String</span> str = byte2HexStr(result);</span><br><span class="line"><span class="comment">//            /*</span></span><br><span class="line"><span class="comment">//             * 将十六进制串保存到txt文件中</span></span><br><span class="line"><span class="comment">//                    */</span></span><br><span class="line"><span class="comment">//            PrintWriter pw = new PrintWriter(</span></span><br><span class="line"><span class="comment">//                    new FileWriter("D:/mmmm.txt"));</span></span><br><span class="line"><span class="comment">//            pw.println(str);</span></span><br><span class="line"><span class="comment">//            pw.close();</span></span><br><span class="line">            <span class="built_in">return</span> str;</span><br><span class="line">        &#125; <span class="built_in">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">return</span> <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 实现字节数组向十六进制的转换方法一</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> byte2HexStr(<span class="keyword">byte</span>[] b) &#123;</span><br><span class="line">        <span class="keyword">String</span> hs = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">String</span> stmp = <span class="string">""</span>;</span><br><span class="line">        <span class="built_in">for</span> (<span class="keyword">int</span> n = <span class="number">0</span>; n &lt; b.length; n++) &#123;</span><br><span class="line">            stmp = (Integer.toHexString(b[n] &amp; <span class="number">0XFF</span>));</span><br><span class="line">            <span class="built_in">if</span> (stmp.length() == <span class="number">1</span>)</span><br><span class="line">                hs = hs + <span class="string">"0"</span> + stmp;</span><br><span class="line">            <span class="built_in">else</span></span><br><span class="line">                hs = hs + stmp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">return</span> hs.toUpperCase();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">byte</span> uniteBytes(<span class="keyword">String</span> src0, <span class="keyword">String</span> src1) &#123;</span><br><span class="line">        <span class="keyword">byte</span> b0 = Byte.decode(<span class="string">"0x"</span> + src0).byteValue();</span><br><span class="line">        b0 = (<span class="keyword">byte</span>) (b0 &lt;&lt; <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">byte</span> b1 = Byte.decode(<span class="string">"0x"</span> + src1).byteValue();</span><br><span class="line">        <span class="keyword">byte</span> ret = (<span class="keyword">byte</span>) (b0 | b1);</span><br><span class="line">        <span class="built_in">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 实现字节数组向十六进制的转换的方法二</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> bytesToHexString(<span class="keyword">byte</span>[] src) &#123;</span><br><span class="line">        StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder(<span class="string">""</span>);</span><br><span class="line">        <span class="built_in">if</span> (src == null || src.length &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">return</span> null;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; src.length; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> v = src[i] &amp; <span class="number">0xFF</span>;</span><br><span class="line">            <span class="keyword">String</span> hv = Integer.toHexString(v);</span><br><span class="line">            <span class="built_in">if</span> (hv.length() &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                stringBuilder.append(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            stringBuilder.append(hv);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">return</span> stringBuilder.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.netty.channel.<span class="type">ChannelInitializer</span>;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.<span class="type">ChannelPipeline</span>;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.socket.<span class="type">SocketChannel</span>;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">SocketClientInitializer</span> <span class="keyword">extends</span> <span class="title">ChannelInitializer&lt;SocketChannel&gt;</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> void initChannel(<span class="type">SocketChannel</span> ch) <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</span><br><span class="line">        <span class="type">ChannelPipeline</span> pipeline = ch.pipeline();</span><br><span class="line">        pipeline.addLast(<span class="keyword">new</span> <span class="type">SocketClientHandler</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>服务端 </li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.bootstrap.ServerBootstrap;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.channel.ChannelFuture;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.channel.EventLoopGroup;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.channel.nio.NioEventLoopGroup;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.channel.socket.nio.NioServerSocketChannel;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.handler.logging.LogLevel;</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">import</span> io.netty.handler.logging.LoggingHandler;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketServer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) throws InterruptedException &#123;</span><br><span class="line">        EventLoopGroup parentGroup = <span class="keyword">new</span> NioEventLoopGroup();</span><br><span class="line">        EventLoopGroup childGroup = <span class="keyword">new</span> NioEventLoopGroup();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ServerBootstrap serverBootstrap = <span class="keyword">new</span> ServerBootstrap();</span><br><span class="line">            serverBootstrap.group(parentGroup, childGroup)</span><br><span class="line">                    .channel(NioServerSocketChannel.class)</span><br><span class="line">                    .handler(<span class="keyword">new</span> LoggingHandler(LogLevel.INFO))</span><br><span class="line">                    .childHandler(<span class="keyword">new</span> SocketServerInitializer());</span><br><span class="line"></span><br><span class="line">            ChannelFuture channelFuture = serverBootstrap.bind(<span class="number">8899</span>).sync();</span><br><span class="line">            channelFuture.channel().closeFuture().sync();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span> &#123;</span><br><span class="line">            parentGroup.shutdownGracefully();</span><br><span class="line">            childGroup.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.netty.<span class="built_in">buffer</span>.ByteBuf;</span><br><span class="line"><span class="keyword">import</span> io.netty.<span class="built_in">buffer</span>.ByteBufUtil;</span><br><span class="line"><span class="keyword">import</span> io.netty.<span class="built_in">buffer</span>.Unpooled;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelHandlerContext;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelInboundHandlerAdapter;</span><br><span class="line"><span class="keyword">import</span> util.Consts;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="built_in">File</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"><span class="keyword">import</span> java.nio.CharBuffer;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.Charset;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.CharsetDecoder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class BusinessServerHandler extends ChannelInboundHandlerAdapter &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> channelRead(ChannelHandlerContext ctx, Object msg) throws Exception &#123;</span><br><span class="line">        ByteBuf buf = (ByteBuf) msg;</span><br><span class="line"></span><br><span class="line">        Consts.logger.info(<span class="string">"BusinessServerHandler接收的二进制形式指令： "</span> + ByteBufUtil.hexDump(buf));</span><br><span class="line">        Consts.logger.info(<span class="string">"BusinessServerHandler接收的ASCII形式指令： "</span> + buf.toString(Charset.forName(<span class="string">"US-ASCII"</span>)));</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"BusinessServerHandler call count="</span> + ++count);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] req = <span class="keyword">new</span> <span class="keyword">byte</span>[buf.readableBytes()];</span><br><span class="line">        buf.<span class="built_in">readBytes</span>(req);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> total = ByteBuffer.wrap(req, <span class="number">0</span>, <span class="number">4</span>).getInt();</span><br><span class="line">        <span class="keyword">int</span> devLength = ByteBuffer.wrap(req, <span class="number">4</span>, <span class="number">4</span>).getInt();</span><br><span class="line">        <span class="keyword">int</span> imgLength = ByteBuffer.wrap(req, <span class="number">8</span>, <span class="number">4</span>).getInt();</span><br><span class="line">        <span class="keyword">String</span> dev = getString(ByteBuffer.wrap(req, <span class="number">12</span>, devLength));</span><br><span class="line">        <span class="keyword">String</span> img = getString(ByteBuffer.wrap(req, <span class="number">12</span> + devLength, total - <span class="number">12</span> - devLength));</span><br><span class="line"></span><br><span class="line">        Consts.logger.info(<span class="string">"设备号： "</span> + dev);</span><br><span class="line">        Consts.logger.info(<span class="string">"图片： "</span> + img);</span><br><span class="line">        saveToImgFile(img, <span class="string">"D:/nnnn.jpg"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ByteBuffer 转换 String</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param buffer</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getString(ByteBuffer <span class="built_in">buffer</span>) &#123;</span><br><span class="line">        Charset charset = null;</span><br><span class="line">        CharsetDecoder decoder = null;</span><br><span class="line">        CharBuffer charBuffer = null;</span><br><span class="line">        <span class="built_in">try</span> &#123;</span><br><span class="line">            charset = Charset.forName(<span class="string">"UTF-8"</span>);</span><br><span class="line">            decoder = charset.newDecoder();</span><br><span class="line">            <span class="comment">// charBuffer = decoder.decode(buffer);//用这个的话，只能输出来一次结果，第二次显示为空</span></span><br><span class="line">            charBuffer = decoder.decode(<span class="built_in">buffer</span>.asReadOnlyBuffer());</span><br><span class="line">            <span class="built_in">return</span> charBuffer.toString();</span><br><span class="line">        &#125; <span class="built_in">catch</span> (Exception ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">            <span class="built_in">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> saveToImgFile(<span class="keyword">String</span> src, <span class="keyword">String</span> output) &#123;</span><br><span class="line">        <span class="built_in">if</span> (src == null || src.length() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">try</span> &#123;</span><br><span class="line">            FileOutputStream out = <span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> <span class="built_in">File</span>(output));</span><br><span class="line">            <span class="keyword">byte</span>[] bytes = src.getBytes();</span><br><span class="line">            <span class="built_in">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bytes.length; i += <span class="number">2</span>) &#123;</span><br><span class="line">                out.<span class="built_in">write</span>(charToInt(bytes[i]) * <span class="number">16</span> + charToInt(bytes[i + <span class="number">1</span>]));</span><br><span class="line">            &#125;</span><br><span class="line">            out.<span class="built_in">close</span>();</span><br><span class="line">        &#125; <span class="built_in">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> charToInt(<span class="keyword">byte</span> ch) &#123;</span><br><span class="line">        <span class="keyword">int</span> val = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">if</span> (ch &gt;= <span class="number">0x30</span> &amp;&amp; ch &lt;= <span class="number">0x39</span>) &#123;</span><br><span class="line">            val = ch - <span class="number">0x30</span>;</span><br><span class="line">        &#125; <span class="built_in">else</span> <span class="built_in">if</span> (ch &gt;= <span class="number">0x41</span> &amp;&amp; ch &lt;= <span class="number">0x46</span>) &#123;</span><br><span class="line">            val = ch - <span class="number">0x41</span> + <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">return</span> val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">import io.netty.<span class="keyword">buffer.ByteBuf;</span></span><br><span class="line"><span class="keyword">import </span>io.netty.<span class="keyword">buffer.ByteBufUtil;</span></span><br><span class="line"><span class="keyword">import </span>io.netty.channel.ChannelHandlerContext<span class="comment">;</span></span><br><span class="line">import io.netty.handler.codec.<span class="keyword">ByteToMessageDecoder;</span></span><br><span class="line"><span class="keyword">import </span>util.Consts<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">import <span class="keyword">java.nio.ByteBuffer;</span></span><br><span class="line"><span class="keyword">import </span><span class="keyword">java.nio.charset.Charset;</span></span><br><span class="line"><span class="keyword">import </span><span class="keyword">java.util.List;</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">/**</span></span><br><span class="line"><span class="keyword"> </span>*     <span class="number">0</span>a0d  设备号长度<span class="number">4</span>   图片长度<span class="number">4</span>    图片</span><br><span class="line"> */</span><br><span class="line">public class SelfDefineEncodeHandler <span class="keyword">extends </span><span class="keyword">ByteToMessageDecoder </span>&#123;</span><br><span class="line"></span><br><span class="line">    private static int <span class="built_in">count</span> = <span class="number">0</span><span class="comment">;</span></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void decode(ChannelHandlerContext ctx, <span class="keyword">ByteBuf </span><span class="keyword">bufferIn, </span>List&lt;Object&gt; out) throws Exception &#123;</span><br><span class="line">        Consts.logger.info(<span class="string">"decode接收的二进制形式指令： "</span> + <span class="keyword">ByteBufUtil.hexDump(bufferIn));</span></span><br><span class="line"><span class="keyword"> </span>       Consts.logger.info(<span class="string">"decode接收的ASCII形式指令： "</span> + <span class="keyword">bufferIn.toString(Charset.forName("US-ASCII")));</span></span><br><span class="line"><span class="keyword"> </span>       if (<span class="keyword">bufferIn.readableBytes() </span>&lt; <span class="number">10</span>) &#123;</span><br><span class="line">            return<span class="comment">;</span></span><br><span class="line">        &#125;</span><br><span class="line">        int <span class="keyword">beginIndex </span>= <span class="keyword">bufferIn.readerIndex();</span></span><br><span class="line"><span class="keyword"> </span>       int length = <span class="keyword">bufferIn.readInt();</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword"> </span>       System.out.println(<span class="string">"decode call count="</span>+ ++<span class="built_in">count</span>)<span class="comment">;</span></span><br><span class="line">        System.out.println(<span class="string">"bufferIn.readableBytes()="</span>+<span class="keyword">bufferIn.readableBytes());</span></span><br><span class="line"><span class="keyword"> </span>       System.out.println(<span class="string">"beginIndex="</span>+<span class="keyword">beginIndex);</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword"> </span>       if (<span class="keyword">bufferIn.readableBytes() </span>&lt; length) &#123;</span><br><span class="line">            <span class="keyword">bufferIn.readerIndex(beginIndex);</span></span><br><span class="line"><span class="keyword"> </span>           return<span class="comment">;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">bufferIn.readerIndex(beginIndex </span>+ length - <span class="number">4</span>)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">ByteBuf </span>otherByteBufRef = <span class="keyword">bufferIn.slice(beginIndex, </span>length)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">        otherByteBufRef.retain()<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">        out.<span class="keyword">add(otherByteBufRef);</span></span><br><span class="line"><span class="keyword"> </span>   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.netty.channel.<span class="type">ChannelInitializer</span>;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.<span class="type">ChannelPipeline</span>;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.socket.<span class="type">SocketChannel</span>;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">SocketServerInitializer</span> <span class="keyword">extends</span> <span class="title">ChannelInitializer&lt;SocketChannel&gt;</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> void initChannel(<span class="type">SocketChannel</span> ch) <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</span><br><span class="line">        <span class="type">ChannelPipeline</span> pipeline = ch.pipeline();</span><br><span class="line">        pipeline.addLast(<span class="keyword">new</span> <span class="type">SelfDefineEncodeHandler</span>());</span><br><span class="line">        pipeline.addLast(<span class="keyword">new</span> <span class="type">BusinessServerHandler</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.gif"
                alt="Angus" />
            
              <p class="site-author-name" itemprop="name">Angus</p>
              <p class="site-description motion-element" itemprop="description">有梦为马, 游历天涯!</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">50</span>
                    <span class="site-state-item-name">Artikel</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">Kategorien</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">22</span>
                    <span class="site-state-item-name">Tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/qijianguo" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-globe"></i>
                神奇的链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://music.163.com/#/user/home?id=86590096" title="网易云音乐" target="_blank">网易云音乐</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://coldplay.com/" title="Coldplay Official Website" target="_blank">Coldplay Official Website</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://elonmusknews.org/" title="获取 Elon Musk 的新闻" target="_blank">获取 Elon Musk 的新闻</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.bilibili.com/video/av6211226/" title="尼古拉·特斯拉：发明了现代世界的人" target="_blank">尼古拉·特斯拉：发明了现代世界的人</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://reuixiy.github.io/about/" title="关于此博客" target="_blank">关于此博客</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          <div id="days"></div>
</script>
<script language="javascript">
function show_date_time(){
window.setTimeout("show_date_time()", 1000);
BirthDay=new Date("04/10/2018 15:00:00");
today=new Date();
timeold=(today.getTime()-BirthDay.getTime());
sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);
msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);
e_hrsold=(e_daysold-daysold)*24;
hrsold=setzero(Math.floor(e_hrsold));
e_minsold=(e_hrsold-hrsold)*60;
minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
seconds=setzero(Math.floor((e_minsold-minsold)*60));
document.getElementById('days').innerHTML="已运行"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";
}
function setzero(i){
if (i<10)
{i="0" + i};
return i;
}
show_date_time();
</script>
        </div>
      </section>

      

      
	  <div id="days"></div>
</script>
<script language="javascript">
function show_date_time(){
window.setTimeout("show_date_time()", 1000);
BirthDay=new Date("04/10/2018 15:00:00");
today=new Date();
timeold=(today.getTime()-BirthDay.getTime());
sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);
msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);
e_hrsold=(e_daysold-daysold)*24;
hrsold=setzero(Math.floor(e_hrsold));
e_minsold=(e_hrsold-hrsold)*60;
minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
seconds=setzero(Math.floor((e_minsold-minsold)*60));
document.getElementById('days').innerHTML="已运行"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";
}
function setzero(i){
if (i<10)
{i="0" + i};
return i;
}
show_date_time();
</script>
    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Angus</span>

  

  
</div>








<!-- 

-->

  <div class="footer-custom">有梦为马, 游历天涯</div>



<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共45.0k字</span>
</div>
        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  













  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="true"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.2.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.2.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.2.0"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":"wanko","bottom":-30,"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/"});</script></body>
</html>

<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
