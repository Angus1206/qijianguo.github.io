<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#fff">





  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-center-circle.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.2.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.2.0" color="#fff">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="有梦为马, 游历天涯!">
<meta property="og:type" content="website">
<meta property="og:title" content="Angusの博客">
<meta property="og:url" content="https://qijianguo.com/page/2/index.html">
<meta property="og:site_name" content="Angusの博客">
<meta property="og:description" content="有梦为马, 游历天涯!">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Angusの博客">
<meta name="twitter:description" content="有梦为马, 游历天涯!">



  <link rel="alternate" href="/atom.xml" title="Angusの博客" type="application/atom+xml" />




  <link rel="canonical" href="https://qijianguo.com/page/2/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Angusの博客</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>


  <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>


<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
	

    
	<a href="https://github.com/qijianguo"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>



    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Angusの博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>




<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Startseite</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archiv<span class="badge">50</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />Kategorien<span class="badge">17</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />Tags<span class="badge">22</span></a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-top">
    <a href="/top/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-signal"></i> <br />top</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-futbol-o"></i> <br />Über</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Java/2019/04/17/JAVA中使用openoffice将Excel转PDF再转图片功能实现.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Java/2019/04/17/JAVA中使用openoffice将Excel转PDF再转图片功能实现.html" itemprop="url">
                  JAVA中使用openoffice将Excel转PDF再转图片功能实现
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:45:42" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>需求<blockquote>
<p>公司一个小项目要结尾了, 有非常多的表格, 而且非常复杂, 例如</p>
</blockquote>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20181018170207617?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"><br>例如：（这表格, 有想死的心…）<br><img src="https://img-blog.csdn.net/20181018171047385?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"></p>
<blockquote>
<p>看到这样的表格，第一反应是n脸懵逼，这得做到啥时候啊，最后想到用一个方法，让客户自己玩！！<br>平台提供Excel模版下载，客户下载填写完再提交Excel，平台再将Excel转PDF，顺便将PDF转成图片，给前端展示，想法简单，方案可行，开工！</p>
</blockquote>
<ul>
<li>方案:</li>
</ul>
<ol>
<li>windows server下用 jacob, windows上可完美运行, 但是！！！Linux上不支持jacob！！！（非常重要！！）</li>
<li>poi + iText，貌似不错</li>
<li>openoffice，跨平台</li>
</ol>
<blockquote>
<p> 本文选用openoffice，各位看官可自选用iText + poi，自己判别！当然也可以用jacob，前提是你不需要在Linux中运行项目。</p>
</blockquote>
<ul>
<li>安装软件：<a href="http://www.openoffice.org/download/index.html" target="_blank" rel="noopener">下载传送门</a></li>
</ul>
<ol start="4">
<li>win：<br><img src="https://img-blog.csdn.net/2018101817373025?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="win版本"><br>下载完成后，一路next，最好默认路径安装，免得折腾<br>完成后 <strong><em>Win + R</em></strong> 填入 <strong><em>Dcomcnfg</em></strong>  打开组件服务<br><img src="https://img-blog.csdn.net/2018101817414451?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"><br>设置openoffice组件服务， 都设成SYSTEM<br><img src="https://img-blog.csdn.net/20181018174311265?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"><br>再设置标识为：交互式用户<br><img src="https://img-blog.csdn.net/20181018174529594?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"></li>
</ol>
<p>进入到安装目录，如果路径是默认的，则在 <strong><em>C:\Program Files (x86)\OpenOffice 4\program</em></strong> 下面，<br>进到这个路径下，按住 <strong><em>shift</em></strong>  再点击鼠标右键，<strong><em>在此处打开命令窗口</em></strong>，输入 <strong><em>soffice -headless-accept=”socket,host=127.0.0.1,port=8100;urp;”-nofirststartwizard</em></strong>， 查看是否启动成功， 黑窗口输入 <strong><em>netstat -ano</em></strong><br><img src="https://img-blog.csdn.net/20181018175507225?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdn.net/20181018175417121?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"><br>windows下安装完毕！</p>
<p>参考： <a href="https://blog.csdn.net/qq_30987095/article/details/78789103" target="_blank" rel="noopener">https://blog.csdn.net/qq_30987095/article/details/78789103</a></p>
<ol start="2">
<li>linux：<a href="http://www.openoffice.org/download/index.html" target="_blank" rel="noopener">下载传送门</a><br><img src="https://img-blog.csdn.net/20181018175750307?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="在这里插入图片描述"><br>根据自己的Linux系统选择RPM包或者DEB，如果是Ubuntu则选DEB，其他就选RPM包，查看当前操作系统是ubuntu还是centos</li>
</ol>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ2zeg3etf08f6snef3lgrZ ~]<span class="comment">#  lsb_release -a</span></span><br><span class="line">LSB Version:	:(略)</span><br><span class="line">Distributor ID:	CentOS</span><br><span class="line"><span class="section">Description:	CentOS Linux release (略)</span></span><br><span class="line"><span class="section">Release:	(略)</span></span><br><span class="line"><span class="section">Codename:	Core</span></span><br></pre></td></tr></table></figure>
<p>下载完毕后，利用ssh工具上传到服务器上！</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&gt;  tar -zxvf Apache_OpenOffice_4<span class="number">.1</span><span class="number">.3</span>_Linux_x86<span class="number">-64</span>_install-rpm_zh-CN.tar.gz</span><br><span class="line">(略)......</span><br><span class="line"></span><br><span class="line">&gt; ls </span><br><span class="line">zh-CN</span><br><span class="line">&gt; cd zh-CN/RPMS</span><br><span class="line">&gt; ls</span><br><span class="line">openoffice-core01<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm             openoffice-impress<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm        openoffice-zh-CN<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm</span><br><span class="line">openoffice<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm                openoffice-core02<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm             openoffice-javafilter<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm     openoffice-zh-CN-base<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm</span><br><span class="line">openoffice-base<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm           openoffice-core03<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm             openoffice-math<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm           openoffice-zh-CN-calc<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm</span><br><span class="line">openoffice-brand-base<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm     openoffice-core04<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm             openoffice-ogltrans<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm       openoffice-zh-CN-draw<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm</span><br><span class="line">openoffice-brand-calc<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm     openoffice-core05<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm             openoffice-onlineupdate<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm   openoffice-zh-CN-help<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm</span><br><span class="line">openoffice-brand-draw<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm     openoffice-core06<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm             openoffice-ooofonts<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm       openoffice-zh-CN-impress<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm</span><br><span class="line">openoffice-brand-impress<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm  openoffice-core07<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm             openoffice-ooolinguistic<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm  openoffice-zh-CN-math<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm</span><br><span class="line">openoffice-brand-math<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm     openoffice-draw<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm               openoffice-pyuno<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm          openoffice-zh-CN-res<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm</span><br><span class="line">openoffice-brand-writer<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm   openoffice-gnome-integration<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm  openoffice-ure<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm            openoffice-zh-CN-writer<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm</span><br><span class="line">openoffice-brand-zh-CN<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm    openoffice-graphicfilter<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm      openoffice-writer<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm</span><br><span class="line">openoffice-calc<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm           openoffice-images<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm             openoffice-xsltfilter<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>x86_64.rpm</span><br><span class="line"></span><br><span class="line">[注释：运行下面命令， 生成  desktop-integration包]</span><br><span class="line">&gt;  yum localinstall *.rpm</span><br><span class="line">&gt; （略...）</span><br><span class="line">&gt; cd desktop-integration/</span><br><span class="line">&gt; ls</span><br><span class="line">&gt;  openoffice4<span class="number">.1</span><span class="number">.3</span>-freedesktop-menus<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>noarch.rpm  </span><br><span class="line">   openoffice4<span class="number">.1</span><span class="number">.3</span>-mandriva-menus<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>noarch.rpm </span><br><span class="line">   openoffice4<span class="number">.1</span><span class="number">.3</span>-redhat-menus<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>noarch.rpm  </span><br><span class="line">   openoffice4<span class="number">.1</span><span class="number">.3</span>-suse-menus<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>noarch.rpm</span><br><span class="line"></span><br><span class="line">&gt;  yum localinstall  openoffice4<span class="number">.1</span><span class="number">.3</span>-redhat-menus<span class="number">-4.1</span><span class="number">.3</span><span class="number">-9783.</span>noarch.rpm</span><br></pre></td></tr></table></figure>
<p>ok， 安装完毕了！ 启动服务<br>进入到默认安装目录下<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">cd</span> /opt/openoffice4/program/</span></span><br><span class="line">[注释：临时启动]</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> /opt/openoffice4/program/soffice -headless -accept=<span class="string">"socket,host=127.0.0.1,port=8100;urp;"</span> -nofirststartwizard</span></span><br><span class="line">[注释：或后台启动]</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> /opt/openoffice4/program/soffice -headless -accept=<span class="string">"socket,host=127.0.0.1,port=8100;urp;"</span> -nofirststartwizard &amp;</span></span><br><span class="line"></span><br><span class="line">[注释：永久启动]</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> nohup /opt/openoffice4/program/soffice -headless -accept=<span class="string">"socket,host=127.0.0.1,port=8100;urp;"</span> -nofirststartwizard &amp;</span></span><br><span class="line"></span><br><span class="line">[注释：查看是否启动成功]</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> ps -ef|grep openoffice</span></span><br><span class="line">root      7541  7527  0 10:19 pts/0    00:00:12 /opt/openoffice4/program/soffice.bin -headless -accept=socket,host=127.0.0.1,port=8100;urp; -nofirststartwizard</span><br><span class="line">root      8964  7066  0 18:18 pts/3    00:00:00 grep --color=auto openoffice</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> netstat -tunlp |grep </span></span><br><span class="line">tcp        0      0 127.0.0.1:8100          0.0.0.0:*               LISTEN      7541/soffice.bin</span><br></pre></td></tr></table></figure></p>
<p>Linux下安装成功！</p>
<p>开始撸码：</p>
<ul>
<li>pom.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- openoffice 相关依赖 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openoffice<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>juh<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openoffice<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ridl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openoffice<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>unoil<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- pdf2img --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pdfbox<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pdfbox-tools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>OpenOfficeUtils</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="built_in">File</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.ConnectException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.artofsolving.jodconverter.DefaultDocumentFormatRegistry;</span><br><span class="line"><span class="keyword">import</span> com.artofsolving.jodconverter.DocumentConverter;</span><br><span class="line"><span class="keyword">import</span> com.artofsolving.jodconverter.DocumentFormatRegistry;</span><br><span class="line"><span class="keyword">import</span> com.artofsolving.jodconverter.openoffice.connection.OpenOfficeConnection;</span><br><span class="line"><span class="keyword">import</span> com.artofsolving.jodconverter.openoffice.connection.SocketOpenOfficeConnection;</span><br><span class="line"><span class="keyword">import</span> com.artofsolving.jodconverter.openoffice.converter.OpenOfficeDocumentConverter;</span><br><span class="line"><span class="keyword">import</span> com.artofsolving.jodconverter.openoffice.converter.StreamOpenOfficeDocumentConverter;</span><br><span class="line"><span class="keyword">import</span> org.apache.pdfbox.pdmodel.PDDocument;</span><br><span class="line"><span class="keyword">import</span> org.apache.pdfbox.pdmodel.PDPage;</span><br><span class="line"><span class="keyword">import</span> org.apache.pdfbox.pdmodel.PDPageTree;</span><br><span class="line"><span class="keyword">import</span> org.apache.pdfbox.rendering.ImageType;</span><br><span class="line"><span class="keyword">import</span> org.apache.pdfbox.rendering.PDFRenderer;</span><br><span class="line"><span class="keyword">import</span> org.apache.pdfbox.tools.imageio.ImageIOUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.<span class="built_in">image</span>.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.awt.<span class="built_in">image</span>.RenderedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.<span class="built_in">File</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * @author josnow</span></span><br><span class="line"><span class="comment"> * @date 2017年5月9日 下午12:38:39</span></span><br><span class="line"><span class="comment"> * @version 1.0.0</span></span><br><span class="line"><span class="comment"> * @desc openoffice转换工具</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> class OpenOfficeUtils &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> final <span class="keyword">String</span> LOCAL_HOST = <span class="string">"localhost"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> final <span class="keyword">int</span> LOCAL_PORT = <span class="number">8100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Format</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> DocumentFormatRegistry formatFactory = <span class="keyword">new</span> DefaultDocumentFormatRegistry();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @desc</span></span><br><span class="line"><span class="comment">     * @auth josnow</span></span><br><span class="line"><span class="comment">     * @date 2017年6月9日 下午4:11:04</span></span><br><span class="line"><span class="comment">     * @param inputFilePath</span></span><br><span class="line"><span class="comment">     *            待转换的文件路径</span></span><br><span class="line"><span class="comment">     * @param outputFilePath</span></span><br><span class="line"><span class="comment">     *            输出文件路径</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> convert(<span class="keyword">String</span> inputFilePath, <span class="keyword">String</span> outputFilePath) throws ConnectException &#123;</span><br><span class="line">        convert(inputFilePath, outputFilePath, LOCAL_HOST, LOCAL_PORT);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @desc</span></span><br><span class="line"><span class="comment">     * @auth josnow</span></span><br><span class="line"><span class="comment">     * @date 2017年6月9日 下午4:12:29</span></span><br><span class="line"><span class="comment">     * @param inputFilePath</span></span><br><span class="line"><span class="comment">     *            待转换的文件路径</span></span><br><span class="line"><span class="comment">     * @param outputFilePath</span></span><br><span class="line"><span class="comment">     *            输出文件路径</span></span><br><span class="line"><span class="comment">     * @param connectIp</span></span><br><span class="line"><span class="comment">     *            远程调用ip</span></span><br><span class="line"><span class="comment">     * @param connectPort</span></span><br><span class="line"><span class="comment">     *            远程调用端口</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> convert(<span class="keyword">String</span> inputFilePath, <span class="keyword">String</span> outputFilePath, <span class="keyword">String</span> connectIp, <span class="keyword">int</span> connectPort)</span><br><span class="line">            throws ConnectException &#123;</span><br><span class="line">        <span class="built_in">if</span> (StringUtils.isEmpty(inputFilePath) || StringUtils.isEmpty(outputFilePath)</span><br><span class="line">                || StringUtils.isEmpty(connectIp)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"参数异常！！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        OpenOfficeConnection connection = <span class="keyword">new</span> SocketOpenOfficeConnection(connectIp, connectPort);</span><br><span class="line">        connection.<span class="built_in">connect</span>();</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 		  TODO Excel转成PDF默认是A4纸</span></span><br><span class="line"><span class="comment">//        DocumentConverter converter = getConverter(connectIp, connection);</span></span><br><span class="line"><span class="comment">//        converter.convert(new File(inputFilePath), new File(outputFilePath));</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 		  TODO Excel转成PDF默认是A4纸， 如果现实折行，则自定义ConverterDocument，改变纸张大小</span></span><br><span class="line">        ConverterDocument converterDocument = <span class="keyword">new</span> ConverterDocument(connection);</span><br><span class="line">        converterDocument.convert(<span class="keyword">new</span> <span class="built_in">File</span>(inputFilePath), <span class="keyword">new</span> <span class="built_in">File</span>(outputFilePath));</span><br><span class="line"></span><br><span class="line">        connection.<span class="built_in">disconnect</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @desc</span></span><br><span class="line"><span class="comment">     * @auth josnow</span></span><br><span class="line"><span class="comment">     * @date 2017年6月9日 下午4:08:26</span></span><br><span class="line"><span class="comment">     * @param inputStream</span></span><br><span class="line"><span class="comment">     * @param inputFileExtension</span></span><br><span class="line"><span class="comment">     *            待转换文件的扩展名，例如: xls，doc</span></span><br><span class="line"><span class="comment">     * @param outputStream</span></span><br><span class="line"><span class="comment">     * @param outputFileExtension</span></span><br><span class="line"><span class="comment">     *            输出文件扩展名，例如：pdf</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> convert(InputStream inputStream, <span class="keyword">String</span> inputFileExtension, OutputStream outputStream,</span><br><span class="line">            <span class="keyword">String</span> outputFileExtension) throws ConnectException &#123;</span><br><span class="line">        convert(inputStream, inputFileExtension, outputStream, outputFileExtension, LOCAL_HOST, LOCAL_PORT);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @desc</span></span><br><span class="line"><span class="comment">     * @auth josnow</span></span><br><span class="line"><span class="comment">     * @date 2017年6月9日 下午4:10:21</span></span><br><span class="line"><span class="comment">     * @param inputStream</span></span><br><span class="line"><span class="comment">     * @param inputFileExtension</span></span><br><span class="line"><span class="comment">     *            待转换文件的扩展名，例如: xls，doc</span></span><br><span class="line"><span class="comment">     * @param outputStream</span></span><br><span class="line"><span class="comment">     * @param outputFileExtension</span></span><br><span class="line"><span class="comment">     *            输出文件扩展名，例如：pdf</span></span><br><span class="line"><span class="comment">     * @param connectIp</span></span><br><span class="line"><span class="comment">     *            远程调用ip</span></span><br><span class="line"><span class="comment">     * @param connectPort</span></span><br><span class="line"><span class="comment">     *            远程调用端口</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> convert(InputStream inputStream, <span class="keyword">String</span> inputFileExtension, OutputStream outputStream,</span><br><span class="line">            <span class="keyword">String</span> outputFileExtension, <span class="keyword">String</span> connectIp, <span class="keyword">int</span> connectPort) throws ConnectException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">if</span> (inputStream == null || StringUtils.isEmpty(inputFileExtension) || outputStream == null</span><br><span class="line">                || StringUtils.isEmpty(outputFileExtension) || StringUtils.isEmpty(connectIp)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"参数异常！！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        OpenOfficeConnection connection = <span class="keyword">new</span> SocketOpenOfficeConnection(connectIp, connectPort);</span><br><span class="line">        connection.<span class="built_in">connect</span>();</span><br><span class="line">        DocumentConverter converter = getConverter(connectIp, connection);</span><br><span class="line"></span><br><span class="line">        converter.convert(inputStream, formatFactory.getFormatByFileExtension(inputFileExtension), outputStream,</span><br><span class="line">                formatFactory.getFormatByFileExtension(outputFileExtension));</span><br><span class="line">        connection.<span class="built_in">disconnect</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DocumentConverter getConverter(<span class="keyword">String</span> connectIp, OpenOfficeConnection connection) &#123;</span><br><span class="line">        DocumentConverter converter = <span class="string">"localhost"</span>.equals(connectIp) || <span class="string">"127.0.0.1"</span>.equals(connectIp)</span><br><span class="line">                || <span class="string">"0:0:0:0:0:0:0:1"</span>.equals(connectIp) ? <span class="keyword">new</span> OpenOfficeDocumentConverter(connection)</span><br><span class="line">                        : <span class="keyword">new</span> StreamOpenOfficeDocumentConverter(connection);</span><br><span class="line">        <span class="built_in">return</span> converter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args) throws Exception &#123;</span><br><span class="line">        OpenOfficeUtils.convert(<span class="string">"D:\\test.xls"</span>, <span class="string">"D:\\test.pdf"</span>);</span><br><span class="line">        pdf2image(<span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"D:\\test.pdf"</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * pdf to big image</span></span><br><span class="line"><span class="comment">     * github: https://github.com/mmtou/pdf2img</span></span><br><span class="line"><span class="comment">     * @param pdfFile pdf文件路径</span></span><br><span class="line"><span class="comment">     * @return big image file</span></span><br><span class="line"><span class="comment">     * @throws Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">File</span> pdf2image(<span class="built_in">File</span> pdfFile) throws Exception &#123;</span><br><span class="line">        <span class="comment">// 拼成图片后的宽度和高度</span></span><br><span class="line">        <span class="keyword">int</span> w = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> h = <span class="number">0</span>;</span><br><span class="line">        List&lt;BufferedImage&gt; images = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        <span class="comment">// 生成图片后的路径</span></span><br><span class="line">        <span class="keyword">String</span> path = pdfFile.getParent() + <span class="built_in">File</span>.separator;</span><br><span class="line">        <span class="keyword">String</span> fileName = pdfFile.getName().replace(<span class="string">".pdf"</span>, <span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">File</span> destinationFile = <span class="keyword">new</span> <span class="built_in">File</span>(path);</span><br><span class="line">        <span class="built_in">if</span> (!destinationFile.<span class="built_in">exists</span>()) &#123;</span><br><span class="line">            destinationFile.<span class="built_in">mkdir</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        PDDocument document = PDDocument.load(pdfFile);</span><br><span class="line">        PDPageTree list = document.getDocumentCatalog().getPages();</span><br><span class="line">        <span class="keyword">int</span> pageCounter = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">for</span> (PDPage page : list) &#123;</span><br><span class="line">            PDFRenderer pdfRenderer = <span class="keyword">new</span> PDFRenderer(document);</span><br><span class="line">            BufferedImage <span class="built_in">image</span> = pdfRenderer.renderImageWithDPI(pageCounter, <span class="number">100</span>, ImageType.RGB);</span><br><span class="line">            <span class="keyword">String</span> target = path + fileName + <span class="string">"-"</span> + (pageCounter++) + <span class="string">".png"</span>;</span><br><span class="line">            ImageIOUtil.writeImage(<span class="built_in">image</span>, target, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">            w = <span class="built_in">image</span>.getWidth();</span><br><span class="line">            h += <span class="built_in">image</span>.getHeight();</span><br><span class="line">            images.add(<span class="built_in">image</span>);</span><br><span class="line">            <span class="keyword">new</span> <span class="built_in">File</span>(target).<span class="keyword">delete</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        document.<span class="built_in">close</span>();</span><br><span class="line"></span><br><span class="line">        BufferedImage combined = <span class="keyword">new</span> BufferedImage(w, h, BufferedImage.TYPE_INT_ARGB);</span><br><span class="line">        Graphics g = combined.getGraphics();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> y = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">for</span> (BufferedImage <span class="built_in">image</span> : images) &#123;</span><br><span class="line">            g.drawImage(<span class="built_in">image</span>, <span class="number">0</span>, y, null);</span><br><span class="line">            y += <span class="built_in">image</span>.getHeight();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Save as new image</span></span><br><span class="line">        <span class="built_in">File</span> <span class="built_in">image</span> = <span class="keyword">new</span> <span class="built_in">File</span>(path, fileName + <span class="string">".png"</span>);</span><br><span class="line">        ImageIO.<span class="built_in">write</span>(combined, <span class="string">"PNG"</span>, <span class="built_in">image</span>);</span><br><span class="line">        <span class="built_in">return</span> <span class="built_in">image</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>自定义 ConverterDocument</p>
</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.artofsolving.jodconverter.openoffice.connection.OpenOfficeConnection;</span><br><span class="line"><span class="keyword">import</span> com.artofsolving.jodconverter.openoffice.converter.OpenOfficeDocumentConverter;</span><br><span class="line"><span class="keyword">import</span> com.artofsolving.jodconverter.openoffice.converter.StreamOpenOfficeDocumentConverter;</span><br><span class="line"><span class="keyword">import</span> com.sun.star.awt.<span class="keyword">Size</span>;</span><br><span class="line"><span class="keyword">import</span> com.sun.star.beans.PropertyValue;</span><br><span class="line"><span class="keyword">import</span> com.sun.star.lang.XComponent;</span><br><span class="line"><span class="keyword">import</span> com.sun.star.uno.UnoRuntime;</span><br><span class="line"><span class="keyword">import</span> com.sun.star.view.PaperFormat;</span><br><span class="line"><span class="keyword">import</span> com.sun.star.view.XPrintable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> ConverterDocument <span class="keyword">extends</span> StreamOpenOfficeDocumentConverter &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ConverterDocument(OpenOfficeConnection connection) &#123;</span><br><span class="line">        <span class="keyword">super</span>(connection);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">Size</span> A5, A4, A3;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">Size</span> B4, B5, B6;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">Size</span> KaoqinReport;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        A5 = <span class="keyword">new</span> <span class="keyword">Size</span>(<span class="number">14800</span>, <span class="number">21000</span>);</span><br><span class="line">        A4 = <span class="keyword">new</span> <span class="keyword">Size</span>(<span class="number">21000</span>, <span class="number">29700</span>);</span><br><span class="line">        A3 = <span class="keyword">new</span> <span class="keyword">Size</span>(<span class="number">29700</span>, <span class="number">42000</span>);</span><br><span class="line"></span><br><span class="line">        B4 = <span class="keyword">new</span> <span class="keyword">Size</span>(<span class="number">25000</span>, <span class="number">35300</span>);</span><br><span class="line">        B5 = <span class="keyword">new</span> <span class="keyword">Size</span>(<span class="number">17600</span>, <span class="number">25000</span>);</span><br><span class="line">        B6 = <span class="keyword">new</span> <span class="keyword">Size</span>(<span class="number">12500</span>, <span class="number">17600</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        KaoqinReport = new Size(29700, 27940);  //最大限度  宽 1600000</span></span><br><span class="line">        KaoqinReport = <span class="keyword">new</span> <span class="keyword">Size</span>(<span class="number">25000</span>, <span class="number">21000</span>);;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> refreshDocument(XComponent document) &#123;</span><br><span class="line">        <span class="keyword">super</span>.refreshDocument(document);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// The default paper format and orientation is A4 and portrait. To</span></span><br><span class="line">        <span class="comment">// change paper orientation</span></span><br><span class="line">        <span class="comment">// re set page size</span></span><br><span class="line">        XPrintable xPrintable = (XPrintable) UnoRuntime.queryInterface(XPrintable.<span class="keyword">class</span>, document);</span><br><span class="line">        PropertyValue[] printerDesc = <span class="keyword">new</span> PropertyValue[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Paper Orientation</span></span><br><span class="line"><span class="comment">//  printerDesc[0] = new PropertyValue();</span></span><br><span class="line"><span class="comment">//  printerDesc[0].Name = "PaperOrientation";</span></span><br><span class="line"><span class="comment">//  printerDesc[0].Value = PaperOrientation.PORTRAIT;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Paper Format</span></span><br><span class="line">        printerDesc[<span class="number">0</span>] = <span class="keyword">new</span> PropertyValue();</span><br><span class="line">        printerDesc[<span class="number">0</span>].Name = <span class="string">"PaperFormat"</span>;</span><br><span class="line">        printerDesc[<span class="number">0</span>].Value = PaperFormat.USER;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Paper Size</span></span><br><span class="line">        printerDesc[<span class="number">1</span>] = <span class="keyword">new</span> PropertyValue();</span><br><span class="line">        printerDesc[<span class="number">1</span>].Name = <span class="string">"PaperSize"</span>;</span><br><span class="line">        printerDesc[<span class="number">1</span>].Value = KaoqinReport;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            xPrintable.setPrinter(printerDesc);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用：</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args) throws Exception &#123;</span><br><span class="line">       OpenOfficeUtils.convert(<span class="string">"D:\\test.xls"</span>, <span class="string">"D:\\test.pdf"</span>);</span><br><span class="line">       pdf2image(<span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"D:\\test.pdf"</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>参考： <a href="https://blog.csdn.net/liuhualiang/article/details/14094019?utm_source=blogxgwz6" target="_blank" rel="noopener">https://blog.csdn.net/liuhualiang/article/details/14094019?utm_source=blogxgwz6</a></p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Java/2019/04/17/JAVA8新特性学习.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Java/2019/04/17/JAVA8新特性学习.html" itemprop="url">
                  JAVA8新特性学习
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:45:30" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Lambda表达式"><a href="#Lambda表达式" class="headerlink" title="Lambda表达式"></a>Lambda表达式</h3><blockquote>
<p>lambda简称闭包，类似Groovy，Scala等的函数式编程，即将函数作为方法的参数。<br>一个简单的Lambda表达式由逗号分隔开的参数列表、-&gt; 及函数体组成</p>
</blockquote>
<p>例如：<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;<span class="keyword">String</span>&gt; strList = Arrays.asList(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>);</span><br><span class="line">strList.forEach(<span class="built_in">str</span> -&gt; System.out.<span class="built_in">println</span>(<span class="built_in">str</span>));</span><br></pre></td></tr></table></figure></p>
<p>同：（其中str的类型是由编译器推断出来的。可省略）<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strList.forEach<span class="function"><span class="params">((String str)-&gt; System.out.println(str))</span>;</span></span><br></pre></td></tr></table></figure></p>
<p>如果 <strong>-&gt;</strong> 后有多条语句，则需要将代码块放在 <strong>{}</strong> 中，即函数体中的代码块。</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">strList.forEach(<span class="built_in">str</span> -&gt; &#123;</span><br><span class="line">	System.out.<span class="built_in">println</span>(<span class="string">"输出"</span>);</span><br><span class="line">	System.out.<span class="built_in">println</span>(<span class="built_in">str</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="Lambda可以引用成员变量和局部变量，但是他们会隐含的被-final-修饰。"><a href="#Lambda可以引用成员变量和局部变量，但是他们会隐含的被-final-修饰。" class="headerlink" title="Lambda可以引用成员变量和局部变量，但是他们会隐含的被 final 修饰。"></a>Lambda可以引用成员变量和局部变量，但是他们会隐含的被 <strong>final</strong> 修饰。</h4><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">String </span>separator = <span class="string">","</span><span class="comment">;</span></span><br><span class="line"><span class="symbol">List</span>&lt;<span class="keyword">String&gt; </span><span class="keyword">strList </span>= Arrays.asList(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>)<span class="comment">;</span></span><br><span class="line"><span class="keyword">strList.forEach(str </span>-&gt; &#123;</span><br><span class="line">	System.out.println(<span class="keyword">str </span>+ separator)<span class="comment">;</span></span><br><span class="line">&#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>同：<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">String</span> separator = <span class="string">","</span>;</span><br><span class="line">List&lt;<span class="keyword">String</span>&gt; strList = Arrays.asList(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>);</span><br><span class="line">strList.forEach(<span class="built_in">str</span> -&gt; &#123;</span><br><span class="line">	System.out.<span class="built_in">println</span>(<span class="built_in">str</span> + separator);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="Lambda返回值"><a href="#Lambda返回值" class="headerlink" title="Lambda返回值"></a>Lambda返回值</h4><p>如果函数体中只有一条语句，则无需写<strong>return</strong>语句，例如：</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list2 = Arrays.asList(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>);</span><br><span class="line">list2.sort<span class="function"><span class="params">((e1, e2) -&gt; e1.compareTo(e2))</span>;</span></span><br></pre></td></tr></table></figure>
<p>同：</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> list2.sort<span class="function"><span class="params">((e1, e2) -&gt; &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">	int compare = e1.compareTo(e2);</span></span></span><br><span class="line"><span class="function"><span class="params">	<span class="keyword">return</span> compare;</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;)</span>;</span></span><br></pre></td></tr></table></figure>
<h3 id="函数式接口（Functional-Interface）"><a href="#函数式接口（Functional-Interface）" class="headerlink" title="函数式接口（Functional Interface）"></a>函数式接口（<strong>Functional Interface</strong>）</h3><ul>
<li>什么样的才算是函数式接口呢？ <blockquote>
<p>首先定义<strong>一个接口</strong><br>接口中定义 <strong>有且仅有一个</strong> 抽象方法</p>
</blockquote>
</li>
</ul>
<p>例如：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">FunctionalDemo</span> &#123;</span><br><span class="line">	<span class="comment">// 抽象方法</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">add</span>(<span class="params"><span class="keyword">int</span> a, <span class="keyword">int</span> b</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>) </span>&#123;</span><br><span class="line">	<span class="comment">// Java8之前是用匿名函数来实现的。</span></span><br><span class="line">       FunctionalDemo methods = (a, b) -&gt; &#123;</span><br><span class="line">            <span class="keyword">return</span> a + b;</span><br><span class="line">       &#125;;</span><br><span class="line">       <span class="keyword">int</span> sum = methods.<span class="keyword">add</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">       System.<span class="keyword">out</span>.println(sum);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>函数式接口在实际应用中容易出错，当其他开发人员在你的函数式接口中添加了其他抽象方法，此时这个接口就不再是函数式接口了。如何避免这种事情的发生呢？在声明的函数式接口上添加注解 <strong><em>@FunctionalInterface</em></strong>。添加注解后如果添加其他抽象方法则编译器报错。<br><img src="https://img-blog.csdnimg.cn/2018120413311650.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5,size_16,color_FFFFFF,t_70" alt="!在这里插入图片描述\](https://img-blog.csdnimg.cn/20181204132900553.png)">在上述描述中多次提到抽象方法，主要是因为函数式接口中允许添加 </p>
<ol>
<li>默认方法，默认方法不是抽象方法。</li>
<li>静态方法，静态方法也不是抽象方法，它已经是一个实现了的方法。静态方法，静态方法也不是抽象方法，它已经是一个实现了的方法。</li>
<li>重写Object中的Public方法重写Object中的Public方法。</li>
</ol>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">@FunctionalInterface</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">FunctionalDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">add</span>(<span class="params"><span class="keyword">int</span> a, <span class="keyword">int</span> b</span>)</span>;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">/** 默认方法 */</span></span><br><span class="line">	<span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">defaultMethod</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		System.<span class="keyword">out</span>.println(<span class="string">"default method 1"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">defaultMethod2</span>(<span class="params">String message</span>) </span>&#123;</span><br><span class="line">		System.<span class="keyword">out</span>.println(message + <span class="string">"：default method 2 "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 静态方法	</span></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printMessage</span>(<span class="params">String message</span>) </span>&#123;</span><br><span class="line">		System.<span class="keyword">out</span>.println(message);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 重写Object中的方法。</span></span><br><span class="line">	@Override</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span>(<span class="params"></span>)</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> boolean <span class="title">equals</span>(<span class="params">Object obj</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>) </span>&#123;</span><br><span class="line">        FunctionalDemo methods = (a, b) -&gt; &#123;</span><br><span class="line">            <span class="keyword">return</span> a + b;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> sum = methods.<span class="keyword">add</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">        System.<span class="keyword">out</span>.println(sum);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 调用默认方法</span></span><br><span class="line">        methods.defaultMethod();</span><br><span class="line">        methods.defaultMethod2(<span class="string">"默认方法加参数"</span>);</span><br><span class="line">        <span class="comment">// 静态方法</span></span><br><span class="line">        FunctionalDemo.printMessage(<span class="string">"静态方法"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span></span><br><span class="line"><span class="keyword">default</span> <span class="function"><span class="keyword">method</span> 1</span></span><br><span class="line"><span class="function">默认方法加参数：<span class="title">default</span> <span class="title">method</span> 2 </span></span><br><span class="line"><span class="function">静态方法**</span></span><br></pre></td></tr></table></figure>
<p>JDK中的栗子：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java<span class="selector-class">.lang</span><span class="selector-class">.Runnable</span>,</span><br><span class="line"></span><br><span class="line">java<span class="selector-class">.util</span><span class="selector-class">.Comparator</span>,</span><br><span class="line"></span><br><span class="line">java<span class="selector-class">.util</span><span class="selector-class">.concurrent</span><span class="selector-class">.Callable</span></span><br></pre></td></tr></table></figure>
<h4 id="接口的默认方法"><a href="#接口的默认方法" class="headerlink" title="接口的默认方法"></a>接口的默认方法</h4><p>Java8之后允许在接口中添加默认方法，默认方法不需要实现，如果有需要则可以覆盖默认方法，而抽象方法必须要实现。</p>
<p>接口<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">Function</span> &#123;</span><br><span class="line">    <span class="comment">// 抽象方法</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">required</span>(<span class="params"></span>)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 默认方法</span></span><br><span class="line">    <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">notRequired</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 函数体</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>实现类<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FunctionalImpl</span> <span class="keyword">implements</span> <span class="title">Function</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">required</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"interface abstract method must override"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notRequired</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"interface default method not required"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>使用：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">void</span> main(<span class="built_in">String</span>[] args) &#123;</span><br><span class="line">	 <span class="built_in">Function</span> <span class="function"><span class="keyword">function</span> = <span class="title">FunctionalFactory</span>.<span class="title">crate</span>(<span class="params">FunctionalImpl::<span class="keyword">new</span></span>)</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span>.<span class="title">required</span>(<span class="params"></span>)</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span>.<span class="title">notRequired</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">method</span> <span class="title">must</span> <span class="title">override</span></span></span><br><span class="line"><span class="function"><span class="title">interface</span> <span class="title">default</span> <span class="title">method</span> <span class="title">not</span> <span class="title">required</span></span></span><br></pre></td></tr></table></figure>
<p>思考：怎么优雅的使用默认方法呢？</p>
<blockquote>
<p>尽管默认方法非常强大，但是在使用默认方法时我们需要小心注意一个地方：在声明一个默认方法前，请仔细思考是不是真的有必要使用默认方法，因为默认方法会带给程序歧义，并且在复杂的继承体系中容易产生编译错误</p>
</blockquote>
<h4 id="方法引用"><a href="#方法引用" class="headerlink" title="方法引用"></a>方法引用</h4><blockquote>
<p>方法引用提供了非常有用的语法，可以直接引用已有Java类或对象（实例）的方法或构造器。与lambda联合使用，方法引用可以使语言的构造更紧凑简洁，减少冗余代码。</p>
</blockquote>
<p>例如：<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造器引用</span></span><br><span class="line"><span class="comment">     * @param supplier 该引用接收一个空构造参数</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Person <span class="title">constructMethod</span>(<span class="params">final Supplier&lt;Person&gt; supplier</span>) </span>&#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"构造器引用, 语法是：Class::new， 构造器无参"</span>);</span><br><span class="line">        <span class="keyword">return</span> supplier.<span class="keyword">get</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 静态方法引用</span></span><br><span class="line"><span class="comment">     * @param person 该引用接收一个Person参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">staticMethod</span>(<span class="params">Person person</span>) </span>&#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"构造器引用，语法是Class::static_method, 接收到的person："</span> + person.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 特定方法的引用</span></span><br><span class="line"><span class="comment">     * @param person 该引用接收一个Person参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">instanceMethod</span>(<span class="params">Person person</span>) </span>&#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"特定对象的方法引用，语法是：Class::method, 接收到的person: "</span> + person.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 任意方法的引用</span></span><br><span class="line"><span class="comment">     * 注意：无参</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">otherMethod</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"任意对象的方法引用，语法是：Class::method， 无参"</span> + <span class="keyword">this</span>.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>使用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LambdaTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> void main(String[] args) &#123;</span><br><span class="line">        <span class="comment">// 构造器引入</span></span><br><span class="line">        Person person = Person.constructMethod(Person::new);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">List</span>&lt;Person&gt; <span class="keyword">list</span> = <span class="keyword">new</span> ArrayList&lt;&gt;(Arrays.asList(person));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 静态方法引入</span></span><br><span class="line">        <span class="keyword">list</span>.<span class="keyword">forEach</span>(Person::staticMethod);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">list</span>.<span class="keyword">forEach</span>(person::instanceMethod);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">list</span>.<span class="keyword">forEach</span>(Person::otherMethod);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">构造器引用, 语法是：<span class="attribute">Class</span>::new， 构造器无参</span><br><span class="line">构造器引用，语法是<span class="attribute">Class</span>::static_method, 接收到的person：domain.Person<span class="variable">@d70c109</span></span><br><span class="line">特定对象的方法引用，语法是：<span class="attribute">Class</span>::method, 接收到的<span class="attribute">person</span>: domain.Person<span class="variable">@d70c109</span></span><br><span class="line">任意对象的方法引用，语法是：<span class="attribute">Class</span>::method， 无参domain.Person<span class="variable">@d70c109</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Optional-官方文档"><a href="#Optional-官方文档" class="headerlink" title="Optional 官方文档"></a>Optional <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html" target="_blank" rel="noopener">官方文档</a></h3><blockquote>
<p>优雅的判断 <strong><em>null</em></strong>， 不再进行 <strong><em>if（obj == null） {……}</em></strong></p>
</blockquote>
<h4 id="慎重使用以下方式："><a href="#慎重使用以下方式：" class="headerlink" title="慎重使用以下方式："></a>慎重使用以下方式：</h4><blockquote>
<p>   调用 isPresent() 方法时<br>   调用 get() 方法时<br>   Optional 类型作为类/实例属性时<br>   Optional 类型作为方法参数时</p>
</blockquote>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User<span class="built_in"> user </span>= new User();</span><br><span class="line">Optional&lt;User&gt; optional = Optional.ofNullable(user); </span><br><span class="line"><span class="keyword">if</span> (optional.isPresent()) &#123;</span><br><span class="line"><span class="built_in">	User </span>u = optional.<span class="builtin-name">get</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码跟以前写的null判断有什么区别呢？</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">User<span class="built_in"> user </span>= new User();</span><br><span class="line"><span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">	System.out.println(user.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如何优雅的使用Optional呢？</p>
<p>Optional中的方法</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span>&lt;U&gt; <span class="keyword">Optional</span>&lt;U&gt; map(<span class="function"><span class="keyword">Function</span></span>&lt;? super T, ? <span class="keyword">extends</span> U&gt; mapper)</span><br><span class="line"><span class="keyword">public</span> T orElse(T other)</span><br><span class="line"><span class="keyword">public</span> T orElseGet(Supplier&lt;? <span class="keyword">extends</span> T&gt; other)</span><br><span class="line"><span class="keyword">public</span> void ifPresent(Consumer&lt;? super T&gt; consumer)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">Optional</span>&lt;T&gt; filter(Predicate&lt;? super T&gt; predicate)</span><br><span class="line"><span class="keyword">public</span>&lt;U&gt; <span class="keyword">Optional</span>&lt;U&gt; flatMap(<span class="function"><span class="keyword">Function</span></span>&lt;? super T, <span class="keyword">Optional</span>&lt;U&gt;&gt; mapper)</span><br><span class="line"><span class="keyword">public</span> &lt;X <span class="keyword">extends</span> Throwable&gt; T orElseThrow(Supplier&lt;? <span class="keyword">extends</span> X&gt; exceptionSupplier) throws X</span><br></pre></td></tr></table></figure>
<p>例如：<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">User</span> <span class="title">zs</span> = new User(<span class="string">"zs"</span>, <span class="number">23</span>, new ArrayList<span class="tag">&lt;&gt;</span>(<span class="string">"篮球"</span>, <span class="string">"旅行"</span>));   </span><br><span class="line">Optional.of(zs).map(<span class="keyword">user</span> <span class="title">-&gt; user</span>.getName()).map(name -&gt; name.toUpperCase()).orElse(null);</span><br></pre></td></tr></table></figure></p>
<h3 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class Streams &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">enum</span> Status&#123;</span><br><span class="line">        OPEN, CLOSED</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> final <span class="keyword">static</span> class <span class="built_in">Task</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Status status;</span><br><span class="line">        <span class="keyword">private</span> Integer points;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">Task</span>(final Status status, final Integer points) &#123;</span><br><span class="line">            <span class="keyword">this</span>.status  =status;</span><br><span class="line">            <span class="keyword">this</span>.points = points;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Status getStatus() &#123;</span><br><span class="line">            <span class="built_in">return</span> status;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Integer getPoints() &#123;</span><br><span class="line">            <span class="built_in">return</span> points;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args) &#123;</span><br><span class="line">        Collection&lt;<span class="built_in">Task</span>&gt; tasks = Arrays.asList(</span><br><span class="line">            <span class="keyword">new</span> <span class="built_in">Task</span>(Status.OPEN, <span class="number">5</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="built_in">Task</span>(Status.OPEN, <span class="number">13</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="built_in">Task</span>(Status.CLOSED, <span class="number">8</span>)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 所有OPEN的总points</span></span><br><span class="line">        Integer openSum =</span><br><span class="line">                tasks.stream()          <span class="comment">// 将集合转化为stream</span></span><br><span class="line">                .filter(task -&gt; task.getStatus() == Status.OPEN)   <span class="comment">// 过滤掉CLOSED的选项</span></span><br><span class="line">                .mapToInt(<span class="built_in">Task</span>::getPoints)      <span class="comment">// mapToInt操作通过Task::getPoints这种方式调用每个task实例的getPoints方法把Task的stream转化为Integer的stream</span></span><br><span class="line">                .sum();         <span class="comment">// 用sum函数把所有的分数加起来</span></span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">" OPEN points "</span> + openSum);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Integer totalPoints = tasks.stream()</span><br><span class="line">                .parallel()                 <span class="comment">// 并行操作</span></span><br><span class="line">                .<span class="built_in">map</span>(<span class="built_in">Task</span>::getPoints)</span><br><span class="line">                .reduce(<span class="number">0</span>, Integer::sum);</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"total points "</span> + totalPoints);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 按某属性分组</span></span><br><span class="line">        Map&lt;Status, List&lt;<span class="built_in">Task</span>&gt;&gt; group =</span><br><span class="line">                tasks.stream().collect(Collectors.groupingBy(<span class="built_in">Task</span>::getStatus));</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"group by status: "</span> + group);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 计算元素的权重</span></span><br><span class="line">        final Collection&lt; <span class="keyword">String</span> &gt; result = tasks</span><br><span class="line">                .stream()                                        <span class="comment">// Stream&lt; String &gt;</span></span><br><span class="line">                .mapToInt( <span class="built_in">Task</span>::getPoints )                     <span class="comment">// IntStream</span></span><br><span class="line">                .asLongStream()                                  <span class="comment">// LongStream</span></span><br><span class="line">                .mapToDouble( points -&gt; points / totalPoints )   <span class="comment">// DoubleStream</span></span><br><span class="line">                .boxed()                                         <span class="comment">// Stream&lt; Double &gt;</span></span><br><span class="line">                .mapToLong( weigth -&gt; ( <span class="keyword">long</span> )( weigth * <span class="number">100</span> ) ) <span class="comment">// LongStream</span></span><br><span class="line">                .mapToObj( percentage -&gt; percentage + <span class="string">"%"</span> )      <span class="comment">// Stream&lt; String&gt;</span></span><br><span class="line">                .collect( Collectors.toList() );                 <span class="comment">// List&lt; String &gt;</span></span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"权重为："</span> + result);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Time"><a href="#Time" class="headerlink" title="Time"></a>Time</h4><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class DateUtil &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> DATE_FORMAT_FULL = <span class="string">"yyyy-MM-dd HH:mm:ss"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> DATE_FORMAT_SHORT = <span class="string">"yyyy-MM-dd"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> DATE_FORMAT_COMPACT = <span class="string">"yyyyMMdd"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> DATE_FORMAT_COMPACTFULL = <span class="string">"yyyyMMddHHmmss"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> DATE_FORMAT_FULL_MSEL = <span class="string">"yyyyMMddHHmmssSSSS"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> DATE_YEAR_MONTH = <span class="string">"yyyyMM"</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> DATE_FORMAT_FULL_MSE = <span class="string">"yyyyMMddHHmmssSSS"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取系统当前日期</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Date getCurrentDate() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Date();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取系统当前日期</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LocalDateTime getCurrentLocalDateTime() &#123;</span><br><span class="line">        <span class="keyword">return</span> LocalDateTime.now();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据时间格式返回对应的String类型的时间</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param format</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getCurDateTime(<span class="keyword">String</span> format) &#123;</span><br><span class="line">        LocalDateTime now = LocalDateTime.now();</span><br><span class="line">        DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(format);</span><br><span class="line">        <span class="keyword">String</span> dataTime = now.format(dateTimeFormatter);</span><br><span class="line">        <span class="keyword">return</span> dataTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到当前日期</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return String 当前日期 yyyy-MM-dd HH:mm:ss格式</span></span><br><span class="line"><span class="comment">     * @author kevin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getCurDateTimeFull() &#123;</span><br><span class="line">        <span class="keyword">return</span> getCurDateTime(DATE_FORMAT_FULL);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到当前日期</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return String 当前日期 yyyyMMddHHmmss格式</span></span><br><span class="line"><span class="comment">     * @author kevin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getCurDateTime1() &#123;</span><br><span class="line">        <span class="keyword">return</span> getCurDateTime(DATE_FORMAT_FULL);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到当前日期YYYYMM格式</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return String 当前日期 yyyyMM格式</span></span><br><span class="line"><span class="comment">     * @author kevin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getCurDateYYYYMM() &#123;</span><br><span class="line">        <span class="keyword">return</span> getCurDateTime(DATE_YEAR_MONTH);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到当前日期</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return String 当前日期 yyyyMMdd格式</span></span><br><span class="line"><span class="comment">     * @author kevin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getCurDateYYYYMMDD() &#123;</span><br><span class="line">        <span class="keyword">return</span> getCurDateTime(DATE_FORMAT_COMPACT);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断是否是今天</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param strDate</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">boolean</span> isCurrentDay(<span class="keyword">String</span> strDate) &#123;</span><br><span class="line">        <span class="built_in">boolean</span> bRet = <span class="keyword">false</span>;</span><br><span class="line">        LocalDate strLocalDate = LocalDate.parse(strDate);</span><br><span class="line">        <span class="keyword">if</span> (LocalDate.now().getYear() == strLocalDate.getYear()) &#123;</span><br><span class="line">            MonthDay monthDay = MonthDay.from(strLocalDate);</span><br><span class="line">            MonthDay today = MonthDay.from(LocalDate.now());</span><br><span class="line">            <span class="keyword">return</span> monthDay.equals(today);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bRet;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取几小时后的时间</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param hour</span></span><br><span class="line"><span class="comment">     * @param format</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getAfterDateTime(<span class="built_in">int</span> <span class="built_in">hour</span>, <span class="keyword">String</span> format) &#123;</span><br><span class="line">        LocalTime localTime = LocalTime.now().plusHours(<span class="built_in">hour</span>);</span><br><span class="line">        DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(format);</span><br><span class="line">        <span class="keyword">String</span> dataTime = localTime.format(dateTimeFormatter);</span><br><span class="line">        <span class="keyword">return</span> dataTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当前日期时间戳(yyyyMMddHHmmssSSSS)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     * @author liangxuekai</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getTimeStamp() &#123;</span><br><span class="line">        LocalDateTime now = LocalDateTime.now();</span><br><span class="line">        DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(DATE_FORMAT_FULL_MSEL);</span><br><span class="line">        <span class="keyword">return</span> now.format(dateTimeFormatter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 日期转字符串</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return String</span></span><br><span class="line"><span class="comment">     * @author kevin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> parseDateToString(Date thedate, <span class="keyword">String</span> format) &#123;</span><br><span class="line">        <span class="keyword">if</span> (thedate != <span class="keyword">null</span>) &#123;</span><br><span class="line">            Instant instant = thedate.toInstant();</span><br><span class="line">            ZoneId zone = ZoneId.systemDefault();</span><br><span class="line">            LocalDateTime localDateTime = LocalDateTime.ofInstant(instant, zone);</span><br><span class="line">            DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(format);</span><br><span class="line">            <span class="keyword">return</span> localDateTime.format(dateTimeFormatter);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * parseDateToString(Date thedate, String format)的重载方法</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param thedate</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> parseDateToString(Date thedate) &#123;</span><br><span class="line">        <span class="comment">// String format = "yyyy-MM-dd";</span></span><br><span class="line">        <span class="keyword">return</span> parseDateToString(thedate, DATE_FORMAT_FULL);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 字符串转日期</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @return Date</span></span><br><span class="line"><span class="comment">     * @author kevin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Date parseStringToDate(<span class="keyword">String</span> thedate, <span class="keyword">String</span> format) &#123;</span><br><span class="line">        DateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(format);</span><br><span class="line">        Date dd1 = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            dd1 = sdf.parse(thedate);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dd1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 由String型日期转成format形式String</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param format1 原先格式</span></span><br><span class="line"><span class="comment">     * @param format2 转化格式</span></span><br><span class="line"><span class="comment">     * @return String</span></span><br><span class="line"><span class="comment">     * @author kevin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> changeFormatDateString(<span class="keyword">String</span> format1, <span class="keyword">String</span> format2, <span class="keyword">String</span> strDate) &#123;</span><br><span class="line">        <span class="keyword">if</span> (strDate == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">if</span> (strDate.length() &gt;= format1.length() &amp;&amp; format1.length() &gt;= format2.length()) &#123;</span><br><span class="line">            <span class="keyword">return</span> parseDateToString(parseStringToDate(strDate, format1), format2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> strDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到当前日期的前N天时间 yyyymmdd</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param format</span></span><br><span class="line"><span class="comment">     * @param day</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> beforeNDaysDate(<span class="keyword">String</span> format, <span class="built_in">int</span> <span class="built_in">day</span>) &#123;</span><br><span class="line">        DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(format);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">day</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> LocalDateTime.now().minusDays(<span class="built_in">day</span>).format(dateTimeFormatter);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获得N个月后的日期</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * theDate 日期</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * int month 月数</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * format 格式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> afterNMonthDate(<span class="keyword">String</span> theDate, <span class="built_in">int</span> <span class="built_in">month</span>, <span class="keyword">String</span> format) &#123;</span><br><span class="line"></span><br><span class="line">        DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(format);</span><br><span class="line">        <span class="keyword">return</span> LocalDateTime.parse(theDate,dateTimeFormatter)</span><br><span class="line">                .plusMonths(<span class="built_in">month</span>)</span><br><span class="line">                .format(dateTimeFormatter);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到N天后的日期</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param theDate 某日期</span></span><br><span class="line"><span class="comment">     *                格式 yyyy-MM-dd</span></span><br><span class="line"><span class="comment">     * @param nDayNum N天</span></span><br><span class="line"><span class="comment">     * @return String N天后的日期</span></span><br><span class="line"><span class="comment">     * @author kevin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> afterNDaysDate(<span class="keyword">String</span> theDate, Integer nDayNum, <span class="keyword">String</span> format) &#123;</span><br><span class="line">        DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(format);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> LocalDateTime.parse(theDate,dateTimeFormatter)</span><br><span class="line">                .plusDays(nDayNum)</span><br><span class="line">                .format(dateTimeFormatter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到N小时后的日期</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param theDate  时间</span></span><br><span class="line"><span class="comment">     * @param nHourNum N小时数</span></span><br><span class="line"><span class="comment">     * @param format   时间格式</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> afterNHoursDate(<span class="keyword">String</span> theDate, Integer nHourNum, <span class="keyword">String</span> format) &#123;</span><br><span class="line">        DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(format);</span><br><span class="line">        <span class="keyword">return</span> LocalDateTime.parse(theDate,dateTimeFormatter)</span><br><span class="line">                .plusHours(nHourNum)</span><br><span class="line">                .format(dateTimeFormatter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到N分钟后的日期</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param theDate</span></span><br><span class="line"><span class="comment">     * @param nMinNum</span></span><br><span class="line"><span class="comment">     * @param format</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> afterNMinsDate(<span class="keyword">String</span> theDate, Integer nMinNum, <span class="keyword">String</span> format) &#123;</span><br><span class="line">        DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(format);</span><br><span class="line">        <span class="keyword">return</span> LocalDateTime.parse(theDate,dateTimeFormatter)</span><br><span class="line">                .plusMinutes(nMinNum)</span><br><span class="line">                .format(dateTimeFormatter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 得到N秒后的日期</span></span><br><span class="line"><span class="comment">     * @param theDate</span></span><br><span class="line"><span class="comment">     * @param nSecNum</span></span><br><span class="line"><span class="comment">     * @param format</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> afterNSecondsDate(<span class="keyword">String</span> theDate, Integer nSecNum, <span class="keyword">String</span> format) &#123;</span><br><span class="line">        DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(format);</span><br><span class="line">        <span class="keyword">return</span> LocalDateTime.parse(theDate,dateTimeFormatter)</span><br><span class="line">                .plusSeconds(nSecNum)</span><br><span class="line">                .format(dateTimeFormatter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 比较两个字符串格式日期大小,带格式的日期</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">boolean</span> isBefore(<span class="keyword">String</span> strdat1, <span class="keyword">String</span> strdat2, <span class="keyword">String</span> format) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Date dat1 = parseStringToDate(strdat1, format);</span><br><span class="line">            Date dat2 = parseStringToDate(strdat2, format);</span><br><span class="line">            <span class="keyword">return</span> dat1.before(dat2);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 比较两个字符串格式日期大小,带格式的日期,返回int</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> isBefore_int(<span class="keyword">String</span> strdat1, <span class="keyword">String</span> strdat2, <span class="keyword">String</span> format) &#123;</span><br><span class="line">        <span class="keyword">long</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Date dat1 = parseStringToDate(strdat1, format);</span><br><span class="line">            Date dat2 = parseStringToDate(strdat2, format);</span><br><span class="line">            <span class="keyword">return</span> dat2.getTime() - dat1.getTime();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 得到上一个月或者下一个月的日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getDayafterMonth(<span class="keyword">String</span> theDate, <span class="built_in">int</span> <span class="built_in">month</span>, <span class="keyword">String</span> formatStr) &#123;</span><br><span class="line">        DateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(formatStr);</span><br><span class="line">        <span class="keyword">return</span> LocalDateTime.parse(theDate).plusMonths(<span class="built_in">month</span>).format(dateTimeFormatter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将秒转换为小时分秒等</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param sec</span></span><br><span class="line"><span class="comment">     * @return</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">String</span> changeTime(<span class="built_in">int</span> sec) &#123;</span><br><span class="line">        <span class="keyword">String</span> temp = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">if</span> (sec &lt; <span class="number">60</span>) &#123;</span><br><span class="line">            temp = <span class="string">""</span> + sec + <span class="string">"秒"</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sec &lt; <span class="number">3600</span>) &#123;</span><br><span class="line">            temp = <span class="string">""</span> + sec / <span class="number">60</span> + <span class="string">"分"</span> + sec % <span class="number">60</span> + <span class="string">"秒"</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            temp = <span class="string">""</span> + sec / <span class="number">3600</span> + <span class="string">"小时"</span> + (sec % <span class="number">3600</span>) / <span class="number">60</span> + <span class="string">"分"</span> + sec % <span class="number">60</span> + <span class="string">"秒"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 方法描述:</span></span><br><span class="line"><span class="comment">     * 计算两个日期相差天数</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param end   结束日期</span></span><br><span class="line"><span class="comment">     * @param start 开始日期</span></span><br><span class="line"><span class="comment">     * @return 作者：liangxuekai</span></span><br><span class="line"><span class="comment">     * 日期：2018 2018年1月31日</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> getSubDays(<span class="keyword">String</span> end, <span class="keyword">String</span> start) &#123;</span><br><span class="line">        LocalDate startDate = LocalDate.parse(start);</span><br><span class="line">        LocalDate endDate = LocalDate.parse(end);</span><br><span class="line">        Long between = ChronoUnit.DAYS.between(startDate, endDate);</span><br><span class="line">        <span class="keyword">return</span> between.intValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">String</span> getTimeDiff(Date time1, Date time2) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">long</span> l = time1.getTime() - time2.getTime();</span><br><span class="line">        <span class="keyword">String</span> returnStr = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">long</span> <span class="built_in">day</span> = l / (<span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">day</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            returnStr += (<span class="built_in">day</span> + <span class="string">"天"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> <span class="built_in">hour</span> = (l / (<span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>) - <span class="built_in">day</span> * <span class="number">24</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">hour</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            returnStr += (<span class="built_in">hour</span> + <span class="string">"小时"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> <span class="built_in">min</span> = ((l / (<span class="number">60</span> * <span class="number">1000</span>)) - <span class="built_in">day</span> * <span class="number">24</span> * <span class="number">60</span> - <span class="built_in">hour</span> * <span class="number">60</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">min</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            returnStr += (<span class="built_in">min</span> + <span class="string">"分"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> s = (l / <span class="number">1000</span> - <span class="built_in">day</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> - <span class="built_in">hour</span> * <span class="number">60</span> * <span class="number">60</span> - <span class="built_in">min</span> * <span class="number">60</span>);</span><br><span class="line">        <span class="keyword">if</span> (s &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            returnStr += (s + <span class="string">"秒"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> returnStr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="参考文章："><a href="#参考文章：" class="headerlink" title="参考文章："></a>参考文章：</h3><h4 id="Java-8新特性终极指南-http-www-importnew-com-11908-html"><a href="#Java-8新特性终极指南-http-www-importnew-com-11908-html" class="headerlink" title="Java 8新特性终极指南  http://www.importnew.com/11908.html"></a>Java 8新特性终极指南  <a href="http://www.importnew.com/11908.html" target="_blank" rel="noopener">http://www.importnew.com/11908.html</a></h4><h4 id="优雅的使用Optional-https-blog-csdn-net-zhang89xiao-article-details-76596046"><a href="#优雅的使用Optional-https-blog-csdn-net-zhang89xiao-article-details-76596046" class="headerlink" title="优雅的使用Optional  https://blog.csdn.net/zhang89xiao/article/details/76596046"></a>优雅的使用Optional  <a href="https://blog.csdn.net/zhang89xiao/article/details/76596046" target="_blank" rel="noopener">https://blog.csdn.net/zhang89xiao/article/details/76596046</a></h4><h4 id="深入浅出Stream和parallelStreamhttps-blog-csdn-net-darrensty-article-details-79283146"><a href="#深入浅出Stream和parallelStreamhttps-blog-csdn-net-darrensty-article-details-79283146" class="headerlink" title="深入浅出Stream和parallelStreamhttps://blog.csdn.net/darrensty/article/details/79283146"></a>深入浅出Stream和parallelStream<a href="https://blog.csdn.net/darrensty/article/details/79283146" target="_blank" rel="noopener">https://blog.csdn.net/darrensty/article/details/79283146</a></h4><h4 id="java8时间工具类https-www-jianshu-com-p-6261f4162cfe"><a href="#java8时间工具类https-www-jianshu-com-p-6261f4162cfe" class="headerlink" title="java8时间工具类https://www.jianshu.com/p/6261f4162cfe"></a>java8时间工具类<a href="https://www.jianshu.com/p/6261f4162cfe" target="_blank" rel="noopener">https://www.jianshu.com/p/6261f4162cfe</a></h4>
          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Java/2019/04/17/从Java内存模型讲双重检查锁原理.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Java/2019/04/17/从Java内存模型讲双重检查锁原理.html" itemprop="url">
                  从Java内存模型讲双重检查锁原理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:33:38" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>转载： 超赞的两篇文章<br><a href="https://www.jianshu.com/p/4586cb11c62d" target="_blank" rel="noopener">https://www.jianshu.com/p/4586cb11c62d</a></p>
<p><a href="https://www.cnblogs.com/xz816111/p/8470048.html" target="_blank" rel="noopener">https://www.cnblogs.com/xz816111/p/8470048.html</a></p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/MySQL/2019/04/17/MySQL性能优化.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/MySQL/2019/04/17/MySQL性能优化.html" itemprop="url">
                  MySQL性能优化
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:46:25" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>【很实用】mysql慢查询 <a href="https://www.cnblogs.com/sunke/p/5779230.html" target="_blank" rel="noopener">https://www.cnblogs.com/sunke/p/5779230.html</a></li>
</ul>
<blockquote>
<p>SHOW VARIABLES LIKE ‘%slow%’<br><img src="https://img-blog.csdnimg.cn/20181116173750352.png" alt="在这里插入图片描述"><br>SET  @@global.slow_query_log = ON;<br><img src="https://img-blog.csdnimg.cn/20181116173822632.png" alt="在这里插入图片描述"><br>SET @@global.log_output=’TABLE’;<br>可以查看慢查询的语句，包含慢查询的SQL、执行时间、频率等<br><img src="https://img-blog.csdnimg.cn/20181116173915569.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>SET GLOBAL long_query_time = 2<br>设置大于long_query_time秒的查询<br>模拟一下<br>SELECT SLEEP(10);</p>
</blockquote>
<p>*【很实用】MySQL优化技巧：<a href="https://blog.csdn.net/u013087513/article/details/77899412" target="_blank" rel="noopener">https://blog.csdn.net/u013087513/article/details/77899412</a></p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Vue/2019/04/17/Vue学习中踩的坑.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Vue/2019/04/17/Vue学习中踩的坑.html" itemprop="url">
                  Vue学习中踩的坑
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:47:21" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>ERROR in Cannot find module ‘node-sass’<br>参考： <a href="https://blog.csdn.net/Nalaluky/article/details/82598300" target="_blank" rel="noopener">https://blog.csdn.net/Nalaluky/article/details/82598300</a></li>
</ul>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Android/2019/04/17/Android中ViewPager.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Android/2019/04/17/Android中ViewPager.html" itemprop="url">
                  Android中ViewPager
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:44:29" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考：ViewPager 详解（一）—基本入门<a href="https://blog.csdn.net/suyimin2010/article/details/80659993" target="_blank" rel="noopener">传送门</a><br>参考：ViewPager 全面剖析及使用详解<a href="https://www.jianshu.com/p/e5abbda4a71c" target="_blank" rel="noopener">传送门</a></p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Java/2019/04/17/Java工具类.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Java/2019/04/17/Java工具类.html" itemprop="url">
                  Java工具类
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:45:34" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="IOUtils"><a href="#IOUtils" class="headerlink" title="IOUtils"></a>IOUtils</h3><ul>
<li>org.apache.commons.io.IOUtils</li>
</ul>
<p>方法：</p>
<blockquote>
<p>readLines 从输入流中读取多行数据<br>write 把字节. 字符等写入输出流<br>toInputStream 将字符串转化为输入流<br>toString 转化IO流、byte[]、Url为String<br>toByteArray<br>copy 拷贝文件，支持2G以上的数据<br>lineIterator 从输入流返回一个迭代器，根据参数要求读取的数据量，全部读取，如果数据不够，则失败<br>closeQuietly 关闭流</p>
</blockquote>
<p><strong><em>pom.xml</em></strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>示例：<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.io.IOUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.LineIterator;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="built_in">List</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/**</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> * @author Angus</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> * @version 1.0</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> * @Title: TestIOUtils</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> * @Description: TODO</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> * @date 2018/11/20 13:13</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> */</span></span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">TestIOUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="built_in">String</span>[] args) &#123;</span><br><span class="line">        testIOUtils();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private <span class="keyword">static</span> <span class="keyword">void</span> testIOUtils() &#123;</span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"test.json"</span>);</span><br><span class="line">        FileInputStream <span class="keyword">in</span> = <span class="keyword">null</span>;</span><br><span class="line">        FileOutputStream out = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">in</span> = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">            out = <span class="keyword">new</span> FileOutputStream(<span class="string">"testCopy.json"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 从输入流中读取多行数据</span></span><br><span class="line">            <span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; list = IOUtils.readLines(<span class="keyword">in</span>, <span class="string">"UTF-8"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="built_in">StringBuffer</span> str = <span class="keyword">new</span> <span class="built_in">StringBuffer</span>();</span><br><span class="line">            list.forEach(value -&gt; &#123;</span><br><span class="line">                str.append(value);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// 把字节. 字符等写入输出流</span></span><br><span class="line">            IOUtils.write(str, out, <span class="string">"UTF-8"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将字符串转化为输入流</span></span><br><span class="line">            <span class="built_in">String</span> testWord = <span class="string">"Hello IoUtils!"</span>;</span><br><span class="line">            InputStream in2 = IOUtils.toInputStream(testWord);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// toString转化IO流、byte[]、Url为String</span></span><br><span class="line">            <span class="built_in">String</span> inStr = IOUtils.toString(in2, <span class="string">"UTF-8"</span>);</span><br><span class="line">            byte[] bytes = IOUtils.toByteArray(in2);</span><br><span class="line">            <span class="built_in">String</span> byteStr = IOUtils.toString(bytes);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 拷贝文件，支持2G以上的数据</span></span><br><span class="line">            <span class="built_in">int</span> count = IOUtils.copy(<span class="keyword">in</span>, out);</span><br><span class="line">            <span class="built_in">String</span> response = count &gt; <span class="number">0</span> ? <span class="string">"拷贝成功"</span> : <span class="string">"拷贝失败，count &gt; 2147483647L"</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 从输入流返回一个迭代器，根据参数要求读取的数据量，全部读取，如果数据不够，则失败</span></span><br><span class="line">            LineIterator lineIterator = IOUtils.lineIterator(<span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(<span class="string">"test.json"</span>)), <span class="string">"UTF-8"</span>);</span><br><span class="line">            <span class="keyword">while</span> (lineIterator.hasNext()) &#123;</span><br><span class="line">                <span class="built_in">String</span> line = lineIterator.nextLine();</span><br><span class="line">            &#125;</span><br><span class="line">            lineIterator.close();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            IOUtils.closeQuietly(<span class="keyword">in</span>);</span><br><span class="line">            IOUtils.closeQuietly(out);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="FileUtils"><a href="#FileUtils" class="headerlink" title="FileUtils"></a>FileUtils</h3><ul>
<li>org.apache.commons.io.FileUtils</li>
</ul>
<p>方法：</p>
<blockquote>
<p>forceMkdir 强制创建文件夹，如果父级目录不存在则先创建父级目录<br>deleteDirectory 删除文件夹<br>writeStringToFile 将String写入文件中，如果文件目录不存在则都创建<br>copyFile 拷贝文件<br>forceDelete 强制删除<br>forceMkdir 强制创建目录，如果父级目录不存在则创建父级目录<br>copyDirectory 拷贝文件夹！ 【警告】如下操作（创建子文件夹），会造成死循环！<br>listFiles 列举目录下的文件（不是目录！）</p>
</blockquote>
<ul>
<li>示例：<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.io.FileUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.filefilter.DirectoryFileFilter;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.filefilter.FileFileFilter;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.filefilter.IOFileFilter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="built_in">File</span>;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @author Angus</span></span><br><span class="line"><span class="comment"> * @version 1.0</span></span><br><span class="line"><span class="comment"> * @Title: TestFileUtils</span></span><br><span class="line"><span class="comment"> * @Description: TODO</span></span><br><span class="line"><span class="comment"> * @date 2018/11/20 15:44</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> class TestFileUtils &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args) &#123;</span><br><span class="line">        testFileUtils();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> testFileUtils() &#123;</span><br><span class="line">        <span class="built_in">try</span> &#123;</span><br><span class="line">            <span class="comment">// 强制创建文件夹，如果父级目录不存在则先创建父级目录</span></span><br><span class="line">            FileUtils.forceMkdir(<span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"dir/testDir"</span>));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 删除文件夹</span></span><br><span class="line">            FileUtils.deleteDirectory(<span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"dir"</span>));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将String写入文件中，如果文件目录不存在则都创建</span></span><br><span class="line">            FileUtils.writeStringToFile(<span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"dir/testDir/test.json"</span>), <span class="string">"&#123;\"name\": \"zs\"&#125;"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 拷贝文件</span></span><br><span class="line">            FileUtils.copyFile(<span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"dir/testDir/test.json"</span>), <span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"dir/testDir/testCopy.json"</span>));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 强制删除</span></span><br><span class="line">            FileUtils.forceDelete(<span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"dir/testDir/test.json"</span>));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 强制创建目录，如果父级目录不存在则创建父级目录</span></span><br><span class="line">            FileUtils.forceMkdir(<span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"dir/testDir2/test"</span>));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 拷贝文件夹！ 【警告】如下操作（创建子文件夹），会造成死循环！</span></span><br><span class="line">            <span class="comment">// FileUtils.copyDirectory(new File("dir"), new File("dir/dirCopy"));</span></span><br><span class="line">            FileUtils.copyDirectory(<span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"dir"</span>), <span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"dirCopy"</span>));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 列举目录下的文件（不是目录！）</span></span><br><span class="line">            List&lt;<span class="keyword">String</span>&gt; coll = (List&lt;<span class="keyword">String</span>&gt;) FileUtils.listFiles(<span class="keyword">new</span> <span class="built_in">File</span>(<span class="string">"dir"</span>), FileFileFilter.FILE, DirectoryFileFilter.DIRECTORY);</span><br><span class="line">        &#125; <span class="built_in">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="StringUtils"><a href="#StringUtils" class="headerlink" title="StringUtils"></a>StringUtils</h3><ul>
<li>org.apache.commons.lang3.StringUtils</li>
</ul>
<p>方法</p>
<blockquote>
<p>isBlank<br>isEmpty<br>equals<br>split 字符串分割<br>EMPTY 返回空字符串<br>replace 替换字符串<br>capitalize 首字母大写</p>
</blockquote>
<p><strong><em>pom.xml</em></strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-lang3<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>示例：<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @author Angus</span></span><br><span class="line"><span class="comment"> * @version 1.0</span></span><br><span class="line"><span class="comment"> * @Title: TestStringUtils</span></span><br><span class="line"><span class="comment"> * @Description: TODO</span></span><br><span class="line"><span class="comment"> * @date 2018/11/20 16:20</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> class TestStringUtils &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args) &#123;</span><br><span class="line">        testStringUtils();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> testStringUtils() &#123;</span><br><span class="line">        <span class="keyword">String</span> <span class="built_in">str</span> = <span class="string">"Hello-StringUtils!"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">String</span> str2 = <span class="string">"Hello"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">boolean</span> blank = StringUtils.isBlank(<span class="built_in">str</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">boolean</span> empty = StringUtils.isEmpty(<span class="built_in">str</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">boolean</span> equals = StringUtils.equals(<span class="built_in">str</span>, str2);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">String</span> <span class="built_in">join</span> = StringUtils.<span class="built_in">join</span>(Arrays.asList(<span class="string">"hello"</span>, <span class="string">"StringUtils"</span>, <span class="string">"!"</span>));</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"输出结果为： [hello, StringUtils, !] "</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 字符串分割：默认是按空格分割</span></span><br><span class="line">        <span class="keyword">String</span>[] splitStrBlank = StringUtils.<span class="built_in">split</span>(<span class="built_in">str</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">String</span> s : splitStrBlank) &#123;</span><br><span class="line">            System.out.<span class="built_in">println</span>(s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 自定义风格符</span></span><br><span class="line">        <span class="keyword">String</span>[] splitStrKey = StringUtils.<span class="built_in">split</span>(<span class="built_in">str</span>, <span class="string">"-"</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">String</span> s : splitStrKey) &#123;</span><br><span class="line">            System.out.<span class="built_in">println</span>(s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 返回空字符串</span></span><br><span class="line">        <span class="keyword">String</span> emptyStr = StringUtils.EMPTY;</span><br><span class="line">        System.out.<span class="built_in">println</span>(emptyStr);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 替换字符串</span></span><br><span class="line">        <span class="keyword">String</span> replaceStr2 = StringUtils.replace(str2, <span class="string">"Hello"</span>, <span class="string">"你好！"</span>);</span><br><span class="line">        System.out.<span class="built_in">println</span>(replaceStr2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 首字母大写</span></span><br><span class="line">        <span class="keyword">String</span> capitalizeStr2 = StringUtils.capitalize(str2.toLowerCase());</span><br><span class="line">        System.out.<span class="built_in">println</span>(capitalizeStr2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Linux/2019/04/17/Linux有趣（无用）的命令.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/2019/04/17/Linux有趣（无用）的命令.html" itemprop="url">
                  Linux有趣（无用）的命令
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:46:05" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><p>更新yum<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> yum update</span></span><br></pre></td></tr></table></figure></p>
<p>安装wget</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> yum install wget</span></span><br></pre></td></tr></table></figure>
<p>下载EPEL<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; wget http：<span class="regexp">//</span>dl.fedoraproject.org<span class="regexp">/pub/</span>epel<span class="regexp">/6/</span>x86_64<span class="regexp">/epel-release-6-8.noarch.rpm</span></span><br></pre></td></tr></table></figure></p>
<p>安装EPEL</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; rpm -ivh epel-release-<span class="number">6</span>-<span class="number">8</span><span class="selector-class">.noarch</span><span class="selector-class">.rpm</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>知识点： 什么是EPEL？<br><a href="http://www.cnblogs.com/gaoyuechen/p/7683471.html" target="_blank" rel="noopener">什么是EPEL 及 Centos上安装EPEL</a></p>
</blockquote>
<h3 id="sl-命令"><a href="#sl-命令" class="headerlink" title="sl 命令"></a>sl 命令</h3><p>一列火车呼啸而过</p>
<p>安装sl</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> wget install sl</span></span><br></pre></td></tr></table></figure>
<p>运行sl</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> sl</span></span><br></pre></td></tr></table></figure>
<p>结果：<br><img src="https://img-blog.csdnimg.cn/20181122101424177.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="fortune-命令"><a href="#fortune-命令" class="headerlink" title="fortune 命令"></a>fortune 命令</h3><p>给你一句名言警句</p>
<p>下载 fortune<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; wget http:<span class="regexp">//</span>springdale.math.ias.edu<span class="regexp">/data/</span>puias<span class="regexp">/7/</span>x86_64<span class="regexp">/os/</span>Addons<span class="regexp">/Packages/</span>fortune-mod-<span class="number">1.99</span>.<span class="number">1</span>-<span class="number">17</span>.sdl7.x86_64.rpm</span><br></pre></td></tr></table></figure></p>
<p>安装 fortune</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;  rpm -ivh fortune-mod<span class="string">-1</span>.99.1<span class="string">-17</span>.sdl7.x86_64.rpm</span><br><span class="line"></span><br><span class="line">warning: fortune-mod<span class="string">-1</span>.99.1<span class="string">-17</span>.sdl7.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 41a40948: NOKEY</span><br><span class="line"><span class="keyword">error: </span>Failed dependencies:</span><br><span class="line">	librecode.so.0()(64bit) is needed by fortune-mod<span class="string">-1</span>.99.1<span class="string">-17</span>.sdl7.x86_64</span><br></pre></td></tr></table></figure>
<p>如果出现error， 则需要安装依赖</p>
<p>下载librecode(<a href="https://altlinux.pkgs.org/sisyphus/classic-x86_64/librecode-3.6-alt11.1.1.x86_64.rpm.html" target="_blank" rel="noopener">网站传送门</a>)</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; wget http:<span class="regexp">//</span>ftp.altlinux.org<span class="regexp">/pub/</span>distributions<span class="regexp">/ALTLinux/</span>Sisyphus<span class="regexp">/x86_64/</span>RPMS.classic<span class="regexp">//</span>librecode-<span class="number">3.6</span>-alt11.<span class="number">1.1</span>.x86_64.rpm</span><br></pre></td></tr></table></figure>
<p>安装 librecode<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; rpm -ivh librecode<span class="number">-3.6</span>-alt11<span class="number">.1</span><span class="number">.1</span>.x86_64.rpm</span><br><span class="line">Preparing...                          ################################# [<span class="number">100</span>%]</span><br><span class="line">Updating / installing...</span><br><span class="line">   <span class="number">1</span>:librecode<span class="number">-3.6</span>-alt11<span class="number">.1</span><span class="number">.1</span>          ################################# [<span class="number">100</span>%]</span><br></pre></td></tr></table></figure></p>
<p>重新安装 fortune</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;  rpm -ivh fortune-mod<span class="number">-1.99</span><span class="number">.1</span><span class="number">-17.</span>sdl7.x86_64.rpm</span><br><span class="line">Preparing...                          ################################# [<span class="number">100</span>%]</span><br><span class="line">Updating / installing...</span><br><span class="line">   <span class="number">1</span>:fortune-mod<span class="number">-1.99</span><span class="number">.1</span><span class="number">-17.</span>sdl7       ################################# [<span class="number">100</span>%]</span><br></pre></td></tr></table></figure>
<p>效果：<br><img src="https://img-blog.csdnimg.cn/20181122104258532.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="cowsay-命令"><a href="#cowsay-命令" class="headerlink" title="cowsay 命令"></a>cowsay 命令</h3><p>一头很好玩的牛<br>安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> yum installl cowsay -y</span></span><br></pre></td></tr></table></figure>
<p>运行：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; cowsay <span class="string">"牛逼浑浑"</span></span><br><span class="line"> ______</span><br><span class="line"><span class="variable">&lt; 牛逼浑浑 &gt;</span></span><br><span class="line"> ------</span><br><span class="line">        \   ^__^</span><br><span class="line">         \  (oo)\_______</span><br><span class="line">            (__)\       )\/\</span><br><span class="line">                ||<span class="string">----w </span>|</span><br><span class="line">                ||<span class="string">     </span>||</span><br></pre></td></tr></table></figure>
<p>查看其它支持的动物<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; cowsay -l</span><br><span class="line">Cow files <span class="keyword">in</span> /usr/share/cowsay:</span><br><span class="line">beavis.zen blowfish bong bud-frogs bunny cheese cower<span class="built_in"> default </span>dragon</span><br><span class="line">dragon-and-cow elephant elephant-in-snake eyes flaming-sheep ghostbusters</span><br><span class="line">head-in hellokitty kiss kitty koala kosh luke-koala mech-and-cow meow milk</span><br><span class="line">moofasa moose mutilated ren satanic sheep skeleton small sodomized</span><br><span class="line">stegosaurus stimpy supermilker surgery telebears three-eyes turkey turtle</span><br><span class="line">tux udder vader vader-koala www</span><br></pre></td></tr></table></figure></p>
<p>切换其它图案（如下：kiss）</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&gt; cowsay -f kiss  <span class="string">"I LOVE YOU"</span></span><br><span class="line"> ____________</span><br><span class="line"><span class="variable">&lt; I LOVE YOU &gt;</span></span><br><span class="line"> ------------</span><br><span class="line">     \</span><br><span class="line">      \</span><br><span class="line">             ,;;;;;;;,</span><br><span class="line">            ;;;;;;;;;;;,</span><br><span class="line">           ;;;;;'_____;'</span><br><span class="line">           ;;;(/))))|<span class="string">((\</span></span><br><span class="line"><span class="string">           _;;((((((</span>|<span class="string">))))</span></span><br><span class="line"><span class="string">          / </span>|<span class="string">_\\\\\\\\\\\\</span></span><br><span class="line"><span class="string">     .--~(  \ ~))))))))))))</span></span><br><span class="line"><span class="string">    /     \  `\-(((((((((((\\</span></span><br><span class="line"><span class="string">    </span>|<span class="string">    </span>|<span class="string"> `\   ) </span>|<span class="string">\       /</span>|<span class="string">)</span></span><br><span class="line"><span class="string">     </span>|<span class="string">    </span>|<span class="string">  `. _/  \_____/ </span>|</span><br><span class="line">      |<span class="string">    , `\~            /</span></span><br><span class="line"><span class="string">       </span>|<span class="string">    \  \           /</span></span><br><span class="line"><span class="string">      </span>|<span class="string"> `.   `\</span>|<span class="string">          /</span></span><br><span class="line"><span class="string">      </span>|<span class="string">   ~-   `\        /</span></span><br><span class="line"><span class="string">       \____~._/~ -_,   (\</span></span><br><span class="line"><span class="string">        </span>|<span class="string">-----</span>|<span class="string">\   \    ';;</span></span><br><span class="line"><span class="string">       </span>|<span class="string">      </span>|<span class="string"> :;;;'     \</span></span><br><span class="line"><span class="string">      </span>|<span class="string">  /    </span>|<span class="string">            </span>|</span><br><span class="line">      |<span class="string">       </span>|<span class="string">            </span>|</span><br></pre></td></tr></table></figure>
<p>让cowsay说出fortune的内容</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&gt; fortune |<span class="string"> cowsay -f kiss</span></span><br><span class="line"><span class="string"> _____________________________________</span></span><br><span class="line"><span class="string">/ NEWS FLASH!! Today the East German  \</span></span><br><span class="line">|<span class="string"> pole-vault champion became the West </span>|</span><br><span class="line">\ German pole-vault champion.         /</span><br><span class="line"> -------------------------------------</span><br><span class="line">     \</span><br><span class="line">      \</span><br><span class="line">             ,;;;;;;;,</span><br><span class="line">            ;;;;;;;;;;;,</span><br><span class="line">           ;;;;;'_____;'</span><br><span class="line">           ;;;(/))))|<span class="string">((\</span></span><br><span class="line"><span class="string">           _;;((((((</span>|<span class="string">))))</span></span><br><span class="line"><span class="string">          / </span>|<span class="string">_\\\\\\\\\\\\</span></span><br><span class="line"><span class="string">     .--~(  \ ~))))))))))))</span></span><br><span class="line"><span class="string">    /     \  `\-(((((((((((\\</span></span><br><span class="line"><span class="string">    </span>|<span class="string">    </span>|<span class="string"> `\   ) </span>|<span class="string">\       /</span>|<span class="string">)</span></span><br><span class="line"><span class="string">     </span>|<span class="string">    </span>|<span class="string">  `. _/  \_____/ </span>|</span><br><span class="line">      |<span class="string">    , `\~            /</span></span><br><span class="line"><span class="string">       </span>|<span class="string">    \  \           /</span></span><br><span class="line"><span class="string">      </span>|<span class="string"> `.   `\</span>|<span class="string">          /</span></span><br><span class="line"><span class="string">      </span>|<span class="string">   ~-   `\        /</span></span><br><span class="line"><span class="string">       \____~._/~ -_,   (\</span></span><br><span class="line"><span class="string">        </span>|<span class="string">-----</span>|<span class="string">\   \    ';;</span></span><br><span class="line"><span class="string">       </span>|<span class="string">      </span>|<span class="string"> :;;;'     \</span></span><br><span class="line"><span class="string">      </span>|<span class="string">  /    </span>|<span class="string">            </span>|</span><br><span class="line">      |<span class="string">       </span>|<span class="string">            </span>|</span><br></pre></td></tr></table></figure>
<h3 id="cmatrix-命令"><a href="#cmatrix-命令" class="headerlink" title="cmatrix 命令"></a>cmatrix 命令</h3><p>可以做酷炫的屏保</p>
<p>下载cmatrix<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; wget https:<span class="regexp">//</span>jaist.dl.sourceforge.net<span class="regexp">/project/</span>cmatrix<span class="regexp">/cmatrix/</span><span class="number">1.2</span>a<span class="regexp">/cmatrix-1.2a.tar.gz</span></span><br></pre></td></tr></table></figure></p>
<p>解压并进入cmatrix<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> tar -zxvf cmatrix-1.2a.tar.gz</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">cd</span> cmatrix-1.2a</span></span><br></pre></td></tr></table></figure></p>
<p>安装依赖</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> yum install ncurses-devel</span></span><br></pre></td></tr></table></figure>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;./configure &amp;&amp; make &amp;&amp; make install   </span><br><span class="line">如果出现以下提示，则说明未安装gcc</span><br><span class="line">loading cache ./config.cache</span><br><span class="line">checking for a BSD compatible install... /usr/bin/install -c</span><br><span class="line">checking whether <span class="keyword">build</span> environment <span class="keyword">is</span> sane... yes</span><br><span class="line">checking whether make sets $&#123;MAKE&#125;... yes</span><br><span class="line">checking <span class="keyword">for</span> working aclocal... <span class="literal">missing</span></span><br><span class="line">checking <span class="keyword">for</span> working autoconf... <span class="literal">missing</span></span><br><span class="line">checking <span class="keyword">for</span> working automake... <span class="literal">missing</span></span><br><span class="line">checking <span class="keyword">for</span> working autoheader... <span class="literal">missing</span></span><br><span class="line">checking <span class="keyword">for</span> working makeinfo... <span class="literal">missing</span></span><br><span class="line">checking <span class="keyword">for</span> gcc... no</span><br><span class="line">checking <span class="keyword">for</span> cc... no</span><br><span class="line">configure: error: no acceptable cc found <span class="keyword">in</span> $<span class="keyword">PATH</span></span><br></pre></td></tr></table></figure>
<p>安装gcc<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> yum -y install gcc</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> yum -y install gcc-c++</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">  yum install make</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&gt;./configure &amp;&amp; make &amp;&amp; make install   </span><br><span class="line">loading cache ./config.cache</span><br><span class="line">checking <span class="keyword">for</span> a BSD compatible install<span class="built_in">..</span>. (cached) /usr/bin/install -c</span><br><span class="line">checking whether build environment is sane<span class="built_in">..</span>. <span class="literal">yes</span></span><br><span class="line">checking whether make sets <span class="variable">$&#123;MAKE&#125;</span><span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> working aclocal<span class="built_in">..</span>. missing</span><br><span class="line">checking <span class="keyword">for</span> working autoconf<span class="built_in">..</span>. missing</span><br><span class="line">checking <span class="keyword">for</span> working automake<span class="built_in">..</span>. missing</span><br><span class="line">checking <span class="keyword">for</span> working autoheader<span class="built_in">..</span>. missing</span><br><span class="line">checking <span class="keyword">for</span> working makeinfo<span class="built_in">..</span>. missing</span><br><span class="line">checking <span class="keyword">for</span> gcc<span class="built_in">..</span>. (cached) gcc</span><br><span class="line">checking whether the C compiler (gcc  ) works<span class="built_in">..</span>. <span class="literal">yes</span></span><br><span class="line">checking whether the C compiler (gcc  ) is a cross-compiler<span class="built_in">..</span>. <span class="literal">no</span></span><br><span class="line">checking whether we are using GNU C<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking whether gcc accepts -g<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> a BSD compatible install<span class="built_in">..</span>. /usr/bin/install -c</span><br><span class="line">checking whether make sets <span class="variable">$&#123;MAKE&#125;</span><span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> main <span class="keyword">in</span> -lncurses<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking how <span class="keyword">to</span> <span class="builtin-name">run</span> the C preprocessor<span class="built_in">..</span>. (cached) gcc -E</span><br><span class="line">checking <span class="keyword">for</span> ANSI C header files<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> fcntl.h<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> sys/ioctl.h<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> unistd.h<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> termios.h<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> termio.h<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking return<span class="built_in"> type </span>of signal handlers<span class="built_in">..</span>. (cached) void</span><br><span class="line">checking <span class="keyword">for</span> putenv<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> curses.h<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> ncurses.h<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> tgetent <span class="keyword">in</span> -lncurses<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">Using ncurses as the termcap library</span><br><span class="line">checking <span class="keyword">for</span> use_default_colors <span class="keyword">in</span> -lncurses<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> resizeterm <span class="keyword">in</span> -lncurses<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> wresize <span class="keyword">in</span> -lncurses<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> consolechars<span class="built_in">..</span>. (cached) <span class="literal">no</span></span><br><span class="line">checking <span class="keyword">for</span> setfont<span class="built_in">..</span>. (cached) /usr/bin/setfont</span><br><span class="line">checking <span class="keyword">for</span> /usr/lib/kbd/consolefonts<span class="built_in">..</span>. (cached) <span class="literal">yes</span></span><br><span class="line">checking <span class="keyword">for</span> /usr/share/consolefonts<span class="built_in">..</span>. (cached) <span class="literal">no</span></span><br><span class="line">checking <span class="keyword">for</span> mkfontdir<span class="built_in">..</span>. (cached) /usr/bin/mkfontdir</span><br><span class="line">checking <span class="keyword">for</span> /usr/lib/X11/fonts/misc<span class="built_in">..</span>. (cached) <span class="literal">no</span></span><br><span class="line">checking <span class="keyword">for</span> /usr/X11R6/lib/X11/fonts/misc<span class="built_in">..</span>. (cached) <span class="literal">no</span></span><br><span class="line">configure: warning:  </span><br><span class="line"></span><br><span class="line">*** You <span class="keyword">do</span> <span class="keyword">not</span> appear <span class="keyword">to</span> have an X window fonts directory <span class="keyword">in</span> the standard</span><br><span class="line">*** locations (/usr/lib/X11/fonts/misc <span class="keyword">or</span> /usr/X11R6/lib/X11/fonts/misc). The</span><br><span class="line">*** mtx.pcf font will <span class="keyword">not</span> be installed.  This means you will probably <span class="keyword">not</span></span><br><span class="line">*** be able <span class="keyword">to</span> use the mtx fonts <span class="keyword">in</span> your x terminals, <span class="keyword">and</span> hence be unable</span><br><span class="line">*** <span class="keyword">to</span> use the -x command line switch.  Sorry about that<span class="built_in">..</span>.</span><br><span class="line"></span><br><span class="line">creating ./config.status</span><br><span class="line">creating Makefile</span><br><span class="line">creating cmatrix.spec</span><br><span class="line">creating config.h</span><br><span class="line">config.h is unchanged</span><br><span class="line">make[1]: Entering directory `/root/cmatrix-1.2a'</span><br><span class="line">/bin/sh ./mkinstalldirs /usr/local/bin</span><br><span class="line">  /usr/bin/install -c  cmatrix /usr/local/bin/cmatrix</span><br><span class="line">make  install-man1</span><br><span class="line">make[2]: Entering directory `/root/cmatrix-1.2a'</span><br><span class="line">/bin/sh ./mkinstalldirs /usr/local/man/man1</span><br><span class="line"> /usr/bin/install -c -m 644 ./cmatrix.1 /usr/local/man/man1/cmatrix.1</span><br><span class="line">make[2]: Leaving directory `/root/cmatrix-1.2a'</span><br><span class="line"> Installing matrix fonts <span class="keyword">in</span> /usr/lib/kbd/consolefonts<span class="built_in">..</span>.</span><br><span class="line">make[1]: Leaving directory `/root/cmatrix-1.2a'</span><br></pre></td></tr></table></figure>
<p>运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> cmatrix -b</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/2018112211354044.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>常用命令</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">cmatrix-<span class="string">a :</span>异步滚动（默认）</span><br><span class="line"></span><br><span class="line">cmatrix-<span class="string">b :</span>随机粗体</span><br><span class="line"></span><br><span class="line">cmatrix-<span class="string">B :</span>全部粗体</span><br><span class="line"></span><br><span class="line">cmatrix-<span class="string">o :</span>使用旧风格滚动</span><br><span class="line"></span><br><span class="line">cmatrix-<span class="string">x :</span>X window 模式</span><br><span class="line"></span><br><span class="line">cmatrix-<span class="string">V :</span>显示版本信息</span><br><span class="line"></span><br><span class="line">cmatrix-<span class="string">u :</span>刷新频率，<span class="number">0</span><span class="number">-9</span>，也就是滚动的快慢</span><br><span class="line"></span><br><span class="line">cmatrix-<span class="string">C :</span>显示的颜色，支持green(默认),red,blue,white,yellow,cyan,</span><br><span class="line">        magenta and black</span><br><span class="line"></span><br><span class="line">例如:使用红色</span><br><span class="line"></span><br><span class="line">cmatrix -b -C red</span><br><span class="line"></span><br><span class="line">使用蓝色</span><br><span class="line"></span><br><span class="line">cmatrix -b -C blue</span><br></pre></td></tr></table></figure>
<p>参考：<a href="http://blog.51cto.com/5232821/2146115" target="_blank" rel="noopener">http://blog.51cto.com/5232821/2146115</a></p>
<h3 id="figlet命令"><a href="#figlet命令" class="headerlink" title="figlet命令"></a>figlet命令</h3><p>生成艺术字<br>安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> yum install figlet</span></span><br></pre></td></tr></table></figure>
<p>运行</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; figlet I MISS YOU</span><br><span class="line"> ___   __  __ ___ ____ ____   __   _____  _   _ </span><br><span class="line">|<span class="string">_ _</span>|<span class="string"> </span>|<span class="string">  \/  </span>|<span class="string">_ _/ ___/ ___</span>|<span class="string">  \ \ / / _ \</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|</span><br><span class="line"> |<span class="string"> </span>|<span class="string">  </span>|<span class="string"> </span>|<span class="string">\/</span>|<span class="string"> </span>||<span class="string"> </span>|<span class="string">\___ \___ \   \ V / </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|</span><br><span class="line"> |<span class="string"> </span>|<span class="string">  </span>|<span class="string"> </span>|<span class="string">  </span>|<span class="string"> </span>||<span class="string"> </span>|<span class="string"> ___) </span>|<span class="string">__) </span>|<span class="string">   </span>|<span class="string"> </span>||<span class="string"> </span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string"> </span>|</span><br><span class="line">|<span class="string">___</span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string">  </span>|<span class="string">_</span>|<span class="string">___</span>|<span class="string">____/____/    </span>|<span class="string">_</span>|<span class="string"> \___/ \___/</span></span><br></pre></td></tr></table></figure>
<p>参考：<a href="https://mp.weixin.qq.com/s/HXJ25E1b3J-zcVeI_Q2E7Q" target="_blank" rel="noopener">微信公众号：Java技术栈</a></p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Java/2019/04/17/Java正确获取客户端真实IP方法整理.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Java/2019/04/17/Java正确获取客户端真实IP方法整理.html" itemprop="url">
                  Java正确获取客户端真实IP方法整理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:45:38" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://img-blog.csdnimg.cn/20181122131357280.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1OTc0NzU5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>参考：<a href="https://mp.weixin.qq.com/s/Affy4l9TUj7rv9A86gRC4A" target="_blank" rel="noopener">Java技术栈</a></p>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://qijianguo.com/Linux/2019/04/17/Modbus协议服务端（Netty）.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Angus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Angusの博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/Linux/2019/04/17/Modbus协议服务端（Netty）.html" itemprop="url">
                  Modbus协议服务端（Netty）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              

              
                
              

              <time title="Post created: 2019-04-17 14:18:44 / Updated at: 15:46:17" itemprop="dateCreated datePublished" datetime="2019-04-17T14:18:44+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.netty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>netty-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.21.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Listener"><a href="#Listener" class="headerlink" title="Listener"></a>Listener</h2><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.netty.bootstrap.ServerBootstrap;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.*;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.nio.NioEventLoopGroup;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.socket.nio.NioServerSocketChannel;</span><br><span class="line"><span class="keyword">import</span> io.netty.<span class="keyword">handler</span>.codec.FixedLengthFrameDecoder;</span><br><span class="line"><span class="keyword">import</span> io.netty.<span class="keyword">handler</span>.timeout.ReadTimeoutHandler;</span><br><span class="line"><span class="keyword">import</span> io.netty.util.concurrent.DefaultEventExecutorGroup;</span><br><span class="line"><span class="keyword">import</span> io.netty.util.concurrent.EventExecutorGroup;</span><br><span class="line"><span class="keyword">import</span> util.Consts;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PortalSomCommunicationListener</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> port;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PortalSomCommunicationListener</span><span class="params">(<span class="keyword">int</span> port)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.port = port;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        startNettyServer(port);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">void</span> <span class="title">startNettyServer</span><span class="params">(<span class="keyword">int</span> port)</span> </span>&#123;</span><br><span class="line">        EventLoopGroup bossGroup = <span class="keyword">new</span> NioEventLoopGroup();</span><br><span class="line">        EventLoopGroup workerGroup = <span class="keyword">new</span> NioEventLoopGroup();</span><br><span class="line">        <span class="keyword">final</span> EventExecutorGroup businessGroup = <span class="keyword">new</span> DefaultEventExecutorGroup(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 配置服务器的NIO线程租</span></span><br><span class="line">            ServerBootstrap b = <span class="keyword">new</span> ServerBootstrap();</span><br><span class="line">            b.group(bossGroup, workerGroup)</span><br><span class="line">                    .channel(NioServerSocketChannel.class)</span><br><span class="line">                    .option(ChannelOption.SO_BACKLOG, <span class="number">1024</span>)</span><br><span class="line">                    .childOption(ChannelOption.SO_KEEPALIVE, <span class="keyword">true</span>)</span><br><span class="line">                    .childHandler(<span class="keyword">new</span> ChannelInitializer() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">initChannel</span><span class="params">(Channel channel)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                            channel.pipeline().addLast(<span class="keyword">new</span> FixedLengthFrameDecoder(<span class="number">12</span>));</span><br><span class="line">                            <span class="comment">// 设置超时时间，防止连接过多。</span></span><br><span class="line">                            channel.pipeline().addLast(<span class="string">"readtime"</span>,<span class="keyword">new</span> ReadTimeoutHandler(<span class="number">5</span>));</span><br><span class="line">                            channel.pipeline().addLast(businessGroup, <span class="string">"executer"</span>, <span class="keyword">new</span> SomCommunicationHandler());</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">            <span class="comment">// 绑定端口，同步等待成功</span></span><br><span class="line">            ChannelFuture f = b.bind(port).sync();</span><br><span class="line">            <span class="comment">// 等待服务端监听端口关闭</span></span><br><span class="line">            f.channel().closeFuture().sync();</span><br><span class="line">        &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 优雅退出，释放线程池资源</span></span><br><span class="line">            bossGroup.shutdownGracefully();</span><br><span class="line">            workerGroup.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 异味MODBUS协议</span></span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> PortalSomCommunicationListener(Consts.YIWEI_PORT)).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Handler"><a href="#Handler" class="headerlink" title="Handler"></a>Handler</h2><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> domain.YiWeiSample;</span><br><span class="line"><span class="keyword">import</span> io.netty.buffer.ByteBuf;</span><br><span class="line"><span class="keyword">import</span> io.netty.buffer.ByteBufUtil;</span><br><span class="line"><span class="keyword">import</span> io.netty.buffer.Unpooled;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelFutureListener;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelHandlerContext;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelInboundHandlerAdapter;</span><br><span class="line"><span class="keyword">import</span> net.Client;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.<span class="built_in">binary</span>.Hex;</span><br><span class="line"><span class="keyword">import</span> util.Consts;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.nio.ByteBuffer;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.Charset;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求：</span></span><br><span class="line"><span class="comment"> *  00 00   00 00   00 06      FF          03      00 01       00 00</span></span><br><span class="line"><span class="comment"> * | 事务 |协议标识| 长度 | 单元标识 |功能码|起始地址|寄存器地址|</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 响应：</span></span><br><span class="line"><span class="comment"> *  00 00   00 00   00 06       FF           03     00 01      00 00</span></span><br><span class="line"><span class="comment"> * | 事务 |协议标识| 长度 | 单元标识 |功能码|字节个数|请求的数据|</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> class SomCommunicationHandler extends ChannelInboundHandlerAdapter &#123;</span><br><span class="line">    <span class="comment">// 请求指令的长度，此协议指定12个字节长度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> commandSize = <span class="number">12</span>;</span><br><span class="line">    <span class="keyword">private</span> ByteBuf readBuf;</span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> channelRead(ChannelHandlerContext ctx, <span class="keyword">Object</span> msg) &#123;</span><br><span class="line"></span><br><span class="line">        ByteBuf m = (ByteBuf) msg;</span><br><span class="line">        Consts.logger.info(<span class="string">"SomCommunicationHandler收到SOM的二进制形式指令： "</span> + ByteBufUtil.hexDump(m));</span><br><span class="line">        Consts.logger.info(<span class="string">"SomCommunicationHandler收到SOM的ASCII形式指令： "</span> + m.toString(Charset.forName(<span class="string">"US-ASCII"</span>)));</span><br><span class="line">        readBuf.writeBytes(m);</span><br><span class="line">        m.release();</span><br><span class="line">        <span class="built_in">byte</span>[] bytes = handleData();</span><br><span class="line">        <span class="keyword">if</span> (bytes == <span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line">        ctx.channel().writeAndFlush(Unpooled.wrappedBuffer(bytes))</span><br><span class="line">                .addListener(ChannelFutureListener.FIRE_EXCEPTION_ON_FAILURE)</span><br><span class="line">                .addListener((ChannelFutureListener) channelFuture -&gt; Consts.logger.info(</span><br><span class="line">                        <span class="string">"SomCommunicationHandler "</span></span><br><span class="line">                                + <span class="keyword">this</span>.getClass().getName()</span><br><span class="line">                                + <span class="string">"成功发送指令:"</span></span><br><span class="line">                                + Hex.encodeHexString(bytes)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">byte</span>[] handleData() &#123;</span><br><span class="line">        <span class="keyword">while</span> (readBuf.readableBytes() &gt;= commandSize) &#123;</span><br><span class="line">            List&lt;Byte&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="built_in">byte</span>[] bytes = <span class="keyword">new</span> <span class="built_in">byte</span>[commandSize];</span><br><span class="line">            readBuf.readBytes(bytes);</span><br><span class="line">            <span class="comment">// 事务</span></span><br><span class="line">            result.<span class="built_in">add</span>(bytes[<span class="number">0</span>]);</span><br><span class="line">            result.<span class="built_in">add</span>(bytes[<span class="number">1</span>]);</span><br><span class="line">            <span class="comment">// 协议标识</span></span><br><span class="line">            result.<span class="built_in">add</span>(bytes[<span class="number">2</span>]);</span><br><span class="line">            result.<span class="built_in">add</span>(bytes[<span class="number">3</span>]);</span><br><span class="line">            <span class="comment">// 起始地址</span></span><br><span class="line">            <span class="built_in">float</span> startIndex = ByteBuffer.wrap(bytes, <span class="number">8</span>, <span class="number">2</span>).getShort();</span><br><span class="line">            <span class="comment">// 寄存器个数</span></span><br><span class="line">            <span class="built_in">float</span> numberRegister = ByteBuffer.wrap(bytes, <span class="number">10</span>, <span class="number">2</span>).getShort();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 发送指令</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 数据包 AI + DI</span></span><br><span class="line">                <span class="built_in">byte</span>[] dataBytes = getData((<span class="built_in">int</span>) startIndex, (<span class="built_in">int</span>) numberRegister);</span><br><span class="line">                <span class="comment">// Length 长度:长度字段以字节计数，包括单元标识和数据字段。</span></span><br><span class="line">                <span class="built_in">int</span> length = <span class="number">3</span> + (dataBytes != <span class="keyword">null</span> ? dataBytes.length : <span class="number">0</span>);</span><br><span class="line">                <span class="built_in">byte</span>[] len = numToBytes(length);</span><br><span class="line">                addBytes(result, len);</span><br><span class="line">                <span class="comment">//Unit Identifier 单元标识</span></span><br><span class="line">                result.<span class="built_in">add</span>((<span class="built_in">byte</span>) <span class="number">0xFF</span>);</span><br><span class="line">                <span class="comment">// Function Code 功能码</span></span><br><span class="line">                result.<span class="built_in">add</span>((<span class="built_in">byte</span>) <span class="number">0x04</span>);</span><br><span class="line">                <span class="comment">//Byte Count 字节个数</span></span><br><span class="line"><span class="comment">//                result.add(numToBytes(dataBytes != null ? dataBytes.length : 0));</span></span><br><span class="line">                <span class="built_in">byte</span>[] len2 = numToHex8((dataBytes != <span class="keyword">null</span> ? dataBytes.length : <span class="number">0</span>));</span><br><span class="line">                addBytes(result, len2);</span><br><span class="line"></span><br><span class="line">                addBytes(result, dataBytes);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> list2byte(result);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">                Consts.logger.error(e.getMessage(), e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">byte</span>[] list2byte(List&lt;Byte&gt; list) &#123;</span><br><span class="line">        <span class="keyword">if</span> (list == <span class="keyword">null</span> || list.<span class="built_in">size</span>() &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="built_in">byte</span>[] bytes = <span class="keyword">new</span> <span class="built_in">byte</span>[list.<span class="built_in">size</span>()];</span><br><span class="line">        <span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Byte aList : list) &#123;</span><br><span class="line">            bytes[i] = aList;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bytes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @param startIndex 起始地址是指从数据的第几个字段开始, 1：系统报警， 2。。。12 数据</span></span><br><span class="line"><span class="comment">     * @param size 寄存器的个数 = DI + AI， DI有1个，AI有11个</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">byte</span>[] getData(<span class="built_in">int</span> startIndex, <span class="built_in">int</span> <span class="built_in">size</span>) <span class="keyword">throws</span> UnsupportedEncodingException &#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> demo数据。</span></span><br><span class="line">        YiWeiSample sample = <span class="keyword">new</span> YiWeiSample(</span><br><span class="line">                <span class="number">20</span>,</span><br><span class="line">                <span class="number">70</span>,</span><br><span class="line">                <span class="number">50</span>,</span><br><span class="line">                <span class="number">12</span>,</span><br><span class="line">                <span class="number">1</span>,</span><br><span class="line">                <span class="number">25</span>,</span><br><span class="line">                <span class="number">70</span>,</span><br><span class="line">                <span class="number">20</span>,</span><br><span class="line">                <span class="number">18</span>,</span><br><span class="line">                <span class="number">40</span>,</span><br><span class="line">                <span class="number">10</span></span><br><span class="line">        );</span><br><span class="line">        <span class="comment">//                                                  // 寄存器地址</span></span><br><span class="line">        <span class="comment">// DI：系统报警值，0,1,2,3,4， 1为正常</span></span><br><span class="line">        <span class="built_in">byte</span> [] di = numToBytes(<span class="number">1</span>);                         <span class="comment">// 1</span></span><br><span class="line">        <span class="comment">// AI 请求的数据data，</span></span><br><span class="line">        List&lt;Byte&gt; bytes = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        addBytes(bytes, numToBytes(sample.getAvgTemp()));   <span class="comment">// 2</span></span><br><span class="line">        addBytes(bytes, numToBytes(sample.getAvgHumid()));  <span class="comment">// 3</span></span><br><span class="line">        addBytes(bytes, numToBytes(sample.getAvgPm10()));   <span class="comment">// 4</span></span><br><span class="line">        addBytes(bytes, numToBytes(sample.getAvgCo2()));    <span class="comment">// 5</span></span><br><span class="line">        addBytes(bytes, numToBytes(sample.getInYiwei()));   <span class="comment">// 6</span></span><br><span class="line">        addBytes(bytes, numToBytes(sample.getInTemp()));    <span class="comment">// 7</span></span><br><span class="line">        addBytes(bytes, numToBytes(sample.getInPm10()));    <span class="comment">// 8</span></span><br><span class="line">        addBytes(bytes, numToBytes(sample.getInCo2()));     <span class="comment">// 9</span></span><br><span class="line">        addBytes(bytes, numToBytes(sample.getOutTemp()));   <span class="comment">// 10</span></span><br><span class="line">        addBytes(bytes, numToBytes(sample.getOutPm10()));   <span class="comment">// 11</span></span><br><span class="line">        addBytes(bytes, numToBytes(sample.getOutCo2()));    <span class="comment">// 12</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 处理一下startIndex, startIndex默认在区间[1,12]，1为DI，AI[2,12]</span></span><br><span class="line">        <span class="keyword">if</span> (startIndex == <span class="number">1</span>) &#123;</span><br><span class="line">            startIndex = <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (startIndex &gt;= <span class="number">2</span> &amp;&amp; startIndex &lt;= <span class="number">12</span>) &#123;</span><br><span class="line">            startIndex = (startIndex - <span class="number">2</span>) * <span class="number">2</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Consts.logger.error(<span class="string">"Data (as requested)获取请求数据失败， Starting Address 起始地址小于2或大于12，为："</span> + <span class="built_in">size</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 寄存器个数</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">size</span> &lt; <span class="number">0</span> || <span class="built_in">size</span> &gt; bytes.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            Consts.logger.error(<span class="string">"Data (as requested)获取请求数据失败， Number of Registers 寄存器个数错误，个数为："</span> + <span class="built_in">size</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        bytes = bytes.subList(startIndex, (<span class="built_in">size</span> - <span class="number">1</span>) * <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;Byte&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        addBytes(result, di);</span><br><span class="line">        result.addAll(bytes);</span><br><span class="line">        <span class="keyword">return</span> list2byte(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> exceptionCaught(ChannelHandlerContext ctx, Throwable cause)</span><br><span class="line">            <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Consts.logger.error(<span class="string">"DTUHandler exception: "</span> + cause.toString());</span><br><span class="line">        ctx.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> handlerAdded(ChannelHandlerContext ctx) &#123;</span><br><span class="line">        readBuf = ctx.alloc().buffer();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> handlerRemoved(ChannelHandlerContext ctx) &#123;</span><br><span class="line">        readBuf.release();</span><br><span class="line">        readBuf = <span class="keyword">null</span>;</span><br><span class="line">        Client.disconnect(ctx.channel());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> addBytes(List&lt;Byte&gt; list, <span class="built_in">byte</span>[] arr) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr == <span class="keyword">null</span> || arr.length == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">byte</span> b : arr) &#123;</span><br><span class="line">            list.<span class="built_in">add</span>(b);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] numToHex8(<span class="built_in">int</span> b) &#123;</span><br><span class="line">        <span class="keyword">return</span> hexStringToBytes(<span class="keyword">String</span>.format(<span class="string">"%02x"</span>, b));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] numToBytes(<span class="built_in">int</span> b) &#123;</span><br><span class="line">        <span class="keyword">String</span> <span class="built_in">hex</span> = <span class="keyword">String</span>.format(<span class="string">"%04x"</span>, b);</span><br><span class="line">        <span class="keyword">return</span> hexStringToBytes(<span class="built_in">hex</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] hexStringToBytes(<span class="keyword">String</span> hexString) &#123;</span><br><span class="line">        <span class="keyword">if</span> (hexString == <span class="keyword">null</span> || hexString.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        hexString = hexString.toUpperCase();</span><br><span class="line">        <span class="built_in">int</span> length = hexString.length() / <span class="number">2</span>;</span><br><span class="line">        <span class="built_in">char</span>[] hexChars = hexString.toCharArray();</span><br><span class="line">        <span class="built_in">byte</span>[] d = <span class="keyword">new</span> <span class="built_in">byte</span>[length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            <span class="built_in">int</span> pos = i * <span class="number">2</span>;</span><br><span class="line">            d[i] = (<span class="built_in">byte</span>) (charToByte(hexChars[pos]) &lt;&lt; <span class="number">4</span> | charToByte(hexChars[pos + <span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">byte</span> charToByte(<span class="built_in">char</span> c) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">byte</span>) <span class="string">"0123456789ABCDEF"</span>.indexOf(c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Consts-java"><a href="#Consts-java" class="headerlink" title="Consts.java"></a>Consts.java</h2><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"><span class="meta-keyword">import</span> org.apache.log4j.Logger;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consts</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> int YIWEI_PORT = <span class="number">10000</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> Logger logger = Logger.getRootLogger();</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Client-java"><a href="#Client-java" class="headerlink" title="Client.java"></a>Client.java</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.netty.channel.Channel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class <span class="built_in">Client</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> final Map&lt;<span class="keyword">String</span>, <span class="built_in">Client</span>&gt; devCode2Client;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        devCode2Client = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> final Map&lt;Channel, <span class="keyword">String</span>&gt; channel2DevCode = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="built_in">disconnect</span>(Channel channel) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">if</span> (channel2DevCode.containsKey(channel)) &#123;</span><br><span class="line">            <span class="keyword">String</span> devCode = channel2DevCode.<span class="built_in">get</span>(channel);</span><br><span class="line">            devCode2Client.<span class="built_in">remove</span>(devCode);</span><br><span class="line">            channel2DevCode.<span class="built_in">remove</span>(channel);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="YiWeiSample-java"><a href="#YiWeiSample-java" class="headerlink" title="YiWeiSample.java"></a>YiWeiSample.java</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YiWeiSample</span> &#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> avgTemp;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> avgHumid;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> avgPm10;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> avgCo2;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> inYiwei;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> inTemp;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> inPm10;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> inCo2;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> outTemp;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> outPm10;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> outCo2;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> warnData;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">YiWeiSample</span><span class="params">(<span class="keyword">int</span> avgTemp, <span class="keyword">int</span> avgHumid, <span class="keyword">int</span> avgPm10, <span class="keyword">int</span> avgCo2, <span class="keyword">int</span> inYiwei, <span class="keyword">int</span> inTemp, <span class="keyword">int</span> inPm10, <span class="keyword">int</span> inCo2, <span class="keyword">int</span> outTemp, <span class="keyword">int</span> outPm10, <span class="keyword">int</span> outCo2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.avgTemp = avgTemp;</span><br><span class="line">        <span class="keyword">this</span>.avgHumid = avgHumid;</span><br><span class="line">        <span class="keyword">this</span>.avgPm10 = avgPm10;</span><br><span class="line">        <span class="keyword">this</span>.avgCo2 = avgCo2;</span><br><span class="line">        <span class="keyword">this</span>.inYiwei = inYiwei;</span><br><span class="line">        <span class="keyword">this</span>.inTemp = inTemp;</span><br><span class="line">        <span class="keyword">this</span>.inPm10 = inPm10;</span><br><span class="line">        <span class="keyword">this</span>.inCo2 = inCo2;</span><br><span class="line">        <span class="keyword">this</span>.outTemp = outTemp;</span><br><span class="line">        <span class="keyword">this</span>.outPm10 = outPm10;</span><br><span class="line">        <span class="keyword">this</span>.outCo2 = outCo2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAvgTemp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> avgTemp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAvgTemp</span><span class="params">(<span class="keyword">int</span> avgTemp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.avgTemp = avgTemp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAvgHumid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> avgHumid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAvgHumid</span><span class="params">(<span class="keyword">int</span> avgHumid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.avgHumid = avgHumid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAvgPm10</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> avgPm10;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAvgPm10</span><span class="params">(<span class="keyword">int</span> avgPm10)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.avgPm10 = avgPm10;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAvgCo2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> avgCo2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAvgCo2</span><span class="params">(<span class="keyword">int</span> avgCo2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.avgCo2 = avgCo2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getInYiwei</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> inYiwei;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInYiwei</span><span class="params">(<span class="keyword">int</span> inYiwei)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.inYiwei = inYiwei;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getInTemp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> inTemp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInTemp</span><span class="params">(<span class="keyword">int</span> inTemp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.inTemp = inTemp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getInPm10</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> inPm10;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInPm10</span><span class="params">(<span class="keyword">int</span> inPm10)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.inPm10 = inPm10;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getInCo2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> inCo2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInCo2</span><span class="params">(<span class="keyword">int</span> inCo2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.inCo2 = inCo2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOutTemp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> outTemp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOutTemp</span><span class="params">(<span class="keyword">int</span> outTemp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.outTemp = outTemp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOutPm10</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> outPm10;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOutPm10</span><span class="params">(<span class="keyword">int</span> outPm10)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.outPm10 = outPm10;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOutCo2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> outCo2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOutCo2</span><span class="params">(<span class="keyword">int</span> outCo2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.outCo2 = outCo2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getWarnData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> warnData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWarnData</span><span class="params">(<span class="keyword">int</span> warnData)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.warnData = warnData;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    
	
	<div>
      
	</div>
	
	<div>
	  
	</div>

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.gif"
                alt="Angus" />
            
              <p class="site-author-name" itemprop="name">Angus</p>
              <p class="site-description motion-element" itemprop="description">有梦为马, 游历天涯!</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">50</span>
                    <span class="site-state-item-name">Artikel</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">Kategorien</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">22</span>
                    <span class="site-state-item-name">Tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/qijianguo" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-globe"></i>
                神奇的链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://music.163.com/#/user/home?id=86590096" title="网易云音乐" target="_blank">网易云音乐</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://coldplay.com/" title="Coldplay Official Website" target="_blank">Coldplay Official Website</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://elonmusknews.org/" title="获取 Elon Musk 的新闻" target="_blank">获取 Elon Musk 的新闻</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.bilibili.com/video/av6211226/" title="尼古拉·特斯拉：发明了现代世界的人" target="_blank">尼古拉·特斯拉：发明了现代世界的人</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://reuixiy.github.io/about/" title="关于此博客" target="_blank">关于此博客</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          <div id="days"></div>
</script>
<script language="javascript">
function show_date_time(){
window.setTimeout("show_date_time()", 1000);
BirthDay=new Date("04/10/2018 15:00:00");
today=new Date();
timeold=(today.getTime()-BirthDay.getTime());
sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);
msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);
e_hrsold=(e_daysold-daysold)*24;
hrsold=setzero(Math.floor(e_hrsold));
e_minsold=(e_hrsold-hrsold)*60;
minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
seconds=setzero(Math.floor((e_minsold-minsold)*60));
document.getElementById('days').innerHTML="已运行"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";
}
function setzero(i){
if (i<10)
{i="0" + i};
return i;
}
show_date_time();
</script>
        </div>
      </section>

      

      
	  <div id="days"></div>
</script>
<script language="javascript">
function show_date_time(){
window.setTimeout("show_date_time()", 1000);
BirthDay=new Date("04/10/2018 15:00:00");
today=new Date();
timeold=(today.getTime()-BirthDay.getTime());
sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);
msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);
e_hrsold=(e_daysold-daysold)*24;
hrsold=setzero(Math.floor(e_hrsold));
e_minsold=(e_hrsold-hrsold)*60;
minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
seconds=setzero(Math.floor((e_minsold-minsold)*60));
document.getElementById('days').innerHTML="已运行"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";
}
function setzero(i){
if (i<10)
{i="0" + i};
return i;
}
show_date_time();
</script>
    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Angus</span>

  

  
</div>








<!-- 

-->

  <div class="footer-custom">有梦为马, 游历天涯</div>



<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共45.0k字</span>
</div>
        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  













  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="true"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.2.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.2.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.2.0"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":"wanko","bottom":-30,"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/"});</script></body>
</html>

<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
